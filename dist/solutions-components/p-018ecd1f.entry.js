/*!
 * Copyright 2022 Esri
 * Licensed under the Apache License, Version 2.0
 * http://www.apache.org/licenses/LICENSE-2.0
 */
import{r as i,c as t,h as e,H as a,g as n}from"./p-c2f00d41.js";import{g as s}from"./p-a80b3880.js";import{l as o,f as l,i as c}from"./p-7a46ef97.js";import{c as r,d as h,g as d}from"./p-bd67334c.js";import{s as m,c as p,d as u,H as f}from"./p-a33d73bb.js";import{u as g}from"./p-7daea1df.js";import{n as b,u as v,c as y,d as k}from"./p-9eba5c66.js";import{n as D}from"./p-73e23995.js";import"./p-83166522.js";import"./p-729708a3.js";import"./p-9a9955db.js";const S=class{constructor(e){i(this,e),this.calciteInputTimePickerChange=t(this,"calciteInputTimePickerChange",7),this.active=!1,this.open=!1,this.disabled=!1,this.readOnly=!1,this.required=!1,this.scale="m",this.overlayPositioning="absolute",this.placement="auto",this.step=60,this.value=null,this.internalValueChange=!1,this.previousValidValue=null,this.referenceElementId=`input-time-picker-${s()}`,this.effectiveLocale="",this.calciteInternalInputBlurHandler=()=>{this.open=!1;const i=this.shouldIncludeSeconds(),{effectiveLocale:t,numberingSystem:e,value:a,calciteInputEl:n}=this;b.numberFormatOptions={locale:t,numberingSystem:e,useGrouping:!1};const s=b.delocalize(n.value),l=o({value:s,includeSeconds:i,locale:t,numberingSystem:e});this.setInputValue(l||o({value:a,locale:t,numberingSystem:e,includeSeconds:i}))},this.calciteInternalInputFocusHandler=i=>{this.readOnly||(this.open=!0,i.stopPropagation())},this.calciteInputInputHandler=i=>{const t=i.target;b.numberFormatOptions={locale:this.effectiveLocale,numberingSystem:this.numberingSystem,useGrouping:!1};const e=b.delocalize(t.value);this.setValue({value:e});const a=e.split("").map((i=>D.includes(i)?b.numberFormatter.format(Number(i)):i)).join("");this.setInputValue(a)},this.timePickerChangeHandler=i=>{i.stopPropagation(),this.setValue({value:i.target.value,origin:"time-picker"})},this.keyDownHandler=i=>{const{defaultPrevented:t,key:e}=i;t||("Enter"===e&&m(this)&&i.preventDefault(),"Escape"===e&&this.open&&(this.open=!1,i.preventDefault()))},this.setCalcitePopoverEl=i=>{this.popoverEl=i},this.setCalciteInputEl=i=>{this.calciteInputEl=i},this.setCalciteTimePickerEl=i=>{this.calciteTimePickerEl=i},this.setInputValue=i=>{this.calciteInputEl&&(this.calciteInputEl.value=i)},this.setValue=({value:i,origin:t="input"})=>{const e=this.value,a=l(i),n=o({value:a,locale:this.effectiveLocale,numberingSystem:this.numberingSystem,includeSeconds:this.shouldIncludeSeconds()});this.internalValueChange="external"!==t&&"loading"!==t;const s="loading"!==t&&"external"!==t&&(i!==this.previousValidValue&&!i||!(this.previousValidValue||!a)||a!==this.previousValidValue&&a);i?(s&&(this.previousValidValue=a),a&&a!==this.value&&(this.value=a),this.localizedValue=n):(this.value=i,this.localizedValue=null),"time-picker"!==t&&"external"!==t||this.setInputValue(n),s&&(this.calciteInputTimePickerChange.emit().defaultPrevented?(this.internalValueChange=!1,this.value=e,this.setInputValue(e),this.previousValidValue=e):this.previousValidValue=a)}}activeHandler(i){this.open=i}openHandler(i){this.active=i,this.disabled||this.readOnly?this.open=!1:i&&this.reposition(!0)}handleDisabledAndReadOnlyChange(i){i||(this.open=!1)}localeChanged(){v(this)}valueWatcher(i){this.internalValueChange||this.setValue({value:i,origin:"external"}),this.internalValueChange=!1}effectiveLocaleWatcher(){this.setInputValue(o({value:this.value,locale:this.effectiveLocale,numberingSystem:this.numberingSystem,includeSeconds:this.shouldIncludeSeconds()}))}clickHandler(i){i.composedPath().includes(this.calciteTimePickerEl)||this.setFocus()}timePickerBlurHandler(i){i.preventDefault(),i.stopPropagation(),this.open=!1}timePickerFocusHandler(i){i.preventDefault(),i.stopPropagation(),this.readOnly||(this.open=!0)}async setFocus(){var i;null===(i=this.calciteInputEl)||void 0===i||i.setFocus()}async reposition(i=!1){var t;null===(t=this.popoverEl)||void 0===t||t.reposition(i)}onLabelClick(){this.setFocus()}shouldIncludeSeconds(){return this.step<60}connectedCallback(){y(this);const{active:i,open:t}=this;this.value&&this.setValue({value:c(this.value)?this.value:void 0,origin:"loading"}),r(this),p(this),t?this.active=t:i&&(this.open=i)}componentDidLoad(){this.setInputValue(this.localizedValue)}disconnectedCallback(){h(this),u(this),k(this)}componentDidRender(){g(this)}render(){const i=`${this.referenceElementId}-popover`;return e(a,{onKeyDown:this.keyDownHandler},e("div",{"aria-controls":i,"aria-haspopup":"dialog","aria-label":this.name,"aria-owns":i,id:this.referenceElementId,role:"combobox"},e("calcite-input",{disabled:this.disabled,icon:"clock",label:d(this),onCalciteInputInput:this.calciteInputInputHandler,onCalciteInternalInputBlur:this.calciteInternalInputBlurHandler,onCalciteInternalInputFocus:this.calciteInternalInputFocusHandler,readOnly:this.readOnly,ref:this.setCalciteInputEl,scale:this.scale,step:this.step})),e("calcite-popover",{id:i,label:"Time Picker",open:this.open,overlayPositioning:this.overlayPositioning,placement:this.placement,ref:this.setCalcitePopoverEl,referenceElement:this.referenceElementId,triggerDisabled:!0},e("calcite-time-picker",{intlHour:this.intlHour,intlHourDown:this.intlHourDown,intlHourUp:this.intlHourUp,intlMeridiem:this.intlMeridiem,intlMeridiemDown:this.intlMeridiemDown,intlMeridiemUp:this.intlMeridiemUp,intlMinute:this.intlMinute,intlMinuteDown:this.intlMinuteDown,intlMinuteUp:this.intlMinuteUp,intlSecond:this.intlSecond,intlSecondDown:this.intlSecondDown,intlSecondUp:this.intlSecondUp,lang:this.effectiveLocale,numberingSystem:this.numberingSystem,onCalciteInternalTimePickerChange:this.timePickerChangeHandler,ref:this.setCalciteTimePickerEl,scale:this.scale,step:this.step,value:this.value})),e(f,{component:this}))}get el(){return n(this)}static get watchers(){return{active:["activeHandler"],open:["openHandler"],disabled:["handleDisabledAndReadOnlyChange"],readOnly:["handleDisabledAndReadOnlyChange"],locale:["localeChanged"],value:["valueWatcher"],effectiveLocale:["effectiveLocaleWatcher"]}}};S.style="@keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in-down{0%{opacity:0;transform:translate3D(0, -5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;transform:translate3D(0, 5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-scale{0%{opacity:0;transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;animation-fill-mode:both;animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{animation-name:in}.calcite-animate__in-down{animation-name:in-down}.calcite-animate__in-up{animation-name:in-up}.calcite-animate__in-scale{animation-name:in-scale}@media (prefers-reduced-motion: reduce){:root{--calcite-internal-duration-factor:0.01}}:root{--calcite-floating-ui-transition:var(--calcite-animation-timing)}:host([hidden]){display:none}:host([disabled]){pointer-events:none;cursor:default;-webkit-user-select:none;-moz-user-select:none;user-select:none;opacity:var(--calcite-ui-opacity-disabled)}:host{display:inline-block;-webkit-user-select:none;-moz-user-select:none;user-select:none}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}::slotted(input[slot=hidden-form-input]){margin:0 !important;opacity:0 !important;outline:none !important;padding:0 !important;position:absolute !important;inset:0 !important;transform:none !important;-webkit-appearance:none !important;z-index:-1 !important}";export{S as calcite_input_time_picker}