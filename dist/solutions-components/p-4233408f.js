/*!
 * Copyright 2022 Esri
 * Licensed under the Apache License, Version 2.0
 * http://www.apache.org/licenses/LICENSE-2.0
 */
import{x as t,r as e,y as i,a as n,C as r,w as s,h as o,s as a,d as u,b as c,c as l,j as h,N as f,f as d,o as p,g,t as v,i as m,A as y,k as w,l as b,Q as k,m as x,n as A,p as S,q as j,E as O,u as _,v as I,z as T,B as E,D as N,F as $,G as U,H as P,I as C,J as D,K as z,L as R,M,U as F,O as q,Z as L,P as B,R as G,S as J,T as H,V,W,X as Y,Y as X}from"./p-e12b0a84.js";import"./p-c2f00d41.js";import"./p-83166522.js";import"./p-729708a3.js";import"./p-a80b3880.js";import"./p-6fe17794.js";import"./p-1c247f54.js";import"./p-9a9955db.js";import"./p-7ab5ac59.js";import"./p-d6c9a34a.js";import"./p-e1a4994d.js";import"./p-3c449907.js";import"./p-be41429f.js";import"./p-4557d5a8.js";import"./p-00444009.js";import"./p-fc884dd6.js";function Z(t,e,i,n){var r,s=arguments.length,o=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,i,o):r(e,i))||o);return s>3&&o&&Object.defineProperty(e,i,o),o}function K(t){return null!=t&&"function"==typeof t[Symbol.iterator]}class Q{constructor(){this._groups=new Map}destroy(){this.removeAll()}get size(){let t=0;return this._groups.forEach((e=>{t+=e.length})),t}add(t,e){if(K(t)){const i=this._getOrCreateGroup(e);for(const e of t)this._isHandle(e)&&i.push(e)}else this._isHandle(t)&&this._getOrCreateGroup(e).push(t);return this}forEach(t,e){if("function"==typeof t)this._groups.forEach((e=>e.forEach(t)));else{const i=this._getGroup(t);i&&e&&i.forEach(e)}}has(t){return this._groups.has(this._ensureGroupKey(t))}remove(t){if("string"!=typeof t&&K(t)){for(const e of t)this.remove(e);return this}return this.has(t)?(this._removeAllFromGroup(this._getGroup(t)),this._groups.delete(this._ensureGroupKey(t)),this):this}removeAll(){return this._groups.forEach((t=>this._removeAllFromGroup(t))),this._groups.clear(),this}_isHandle(t){return t&&!!t.remove}_getOrCreateGroup(t){if(this.has(t))return this._getGroup(t);const e=[];return this._groups.set(this._ensureGroupKey(t),e),e}_getGroup(e){return t(this._groups.get(this._ensureGroupKey(e)))}_ensureGroupKey(t){return t||"_default_"}_removeAllFromGroup(t){t.forEach((t=>t.remove()))}}function tt(t){return et((()=>t.forEach((t=>e(t)&&t.remove()))))}function et(t){return{remove:()=>{t&&(t(),t=void 0)}}}function it(t){return t?t.__accessor__?t.__accessor__:t.propertyInvalidated?t:null:null}function nt(t,e,i){return rt(t,e,i?{policy:i,path:""}:null)}function rt(e,n,r){return n?Object.keys(n).reduce(((e,s)=>{let o=null,a="merge";if(r&&(o=r.path?`${r.path}.${s}`:s,a=r.policy(o)),"replace"===a)return e[s]=n[s],e;if(void 0===e[s])return e[s]=i(n[s]),e;let u=e[s],c=n[s];if(u===c)return e;if(Array.isArray(c)||Array.isArray(e))u=e[s]=u?Array.isArray(u)?u.concat():[u]:[],c&&(Array.isArray(c)||(c=[c]),c.forEach((t=>{u.includes(t)||u.push(t)})));else if(c&&"object"==typeof c)if(r){const i=r.path;r.path=t(o),e[s]=rt(u,c,r),r.path=i}else e[s]=rt(u,c,null);else e.hasOwnProperty(s)&&!n.hasOwnProperty(s)||(e[s]=c);return e}),e||{}):e}function st(t){return Array.isArray(t)?t:t.split(".")}function ot(t){return t.includes(",")?t.split(",").map((t=>t.trim())):[t.trim()]}function at(t,e,i,n){const r=function(t){if(Array.isArray(t)){const e=[];for(const i of t)e.push(...ot(i));return e}return ot(t)}(e);if(1!==r.length){const e=r.map((e=>n(t,e,i)));return tt(e)}return n(t,r[0],i)}function ut(t){let e=!1;return()=>{e||(e=!0,t())}}function ct(t,e){const i="?"===t[t.length-1]?t.slice(0,-1):t;if(null!=e.getItemAt||Array.isArray(e)){const t=parseInt(i,10);if(!isNaN(t))return Array.isArray(e)?e[t]:e.getItemAt(t)}const n=it(e);return function(t,e){return null!=t&&t.metadatas&&null!=t.metadatas[e]}(n,i)?n.get(i):e[i]}function lt(t,e,i){if(null==t)return t;const n=ct(e[i],t);return!n&&i<e.length-1?void 0:i===e.length-1?n:lt(n,e,i+1)}function ht(t,e,i=0){return"string"!=typeof e||e.includes(".")?lt(t,st(e),i):ct(e,t)}function ft(t,e){return ht(t,e)}function dt(t,e){return void 0!==ht(e,t)}class pt{constructor(t){this.autoDestroy=!1,this.properties=t}}function gt(e){let n=e.constructor.__accessorMetadata__;const r=Object.prototype.hasOwnProperty.call(e.constructor,"__accessorMetadata__");if(n){if(!r){const t=Object.create(n.properties),r=n.autoDestroy;for(const e in t)t[e]=i(t[e]);n=new pt(t),n.autoDestroy=r,Object.defineProperty(e.constructor,"__accessorMetadata__",{value:n,enumerable:!1,configurable:!0,writable:!0})}}else n=new pt({}),Object.defineProperty(e.constructor,"__accessorMetadata__",{value:n,enumerable:!1,configurable:!0,writable:!0});return t(e.constructor.__accessorMetadata__)}function vt(t,e){const i=function(t){return gt(t).properties}(t);let n=i[e];return n||(n=i[e]={}),n}const mt=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function yt(t){return mt.test(t)?"replace":"merge"}class wt{constructor(t,e,i,n=1,r=0){if(this._ctor=t,this._acquireFunction=e,this._releaseFunction=i,this.allocationSize=n,this._pool=new Array(r),this._initialSize=r,this._ctor)for(let t=0;t<r;t++)this._pool[t]=new this._ctor;this.allocationSize=Math.max(n,1)}destroy(){this.prune(0)}acquire(...t){let e;if(wt.test.disabled)e=new this._ctor;else{if(0===this._pool.length){const t=this.allocationSize;for(let e=0;e<t;e++)this._pool[e]=new this._ctor}e=this._pool.pop()}return this._acquireFunction?this._acquireFunction(e,...t):function(t){return t&&t.acquire&&"function"==typeof t.acquire}(e)&&e.acquire(...t),e}release(t){t&&!wt.test.disabled&&(this._releaseFunction?this._releaseFunction(t):function(t){return t&&t.release&&"function"==typeof t.release}(t)&&t.release(),this._pool.push(t))}prune(t=this._initialSize){if(!(t>=this._pool.length)){for(let e=t;e<this._pool.length;++e)this._dispose(this._pool[e]);this._pool.length=t}}_dispose(t){t.dispose&&"function"==typeof t.dispose&&t.dispose()}}var bt,kt,xt,At;function St(t){switch(t){case"defaults":return kt.DEFAULTS;case"service":return kt.SERVICE;case"portal-item":return kt.PORTAL_ITEM;case"web-scene":return kt.WEB_SCENE;case"web-map":return kt.WEB_MAP;case"user":return kt.USER;default:return null}}function jt(e){switch(e){case kt.DEFAULTS:return"defaults";case kt.SERVICE:return"service";case kt.PORTAL_ITEM:return"portal-item";case kt.WEB_SCENE:return"web-scene";case kt.WEB_MAP:return"web-map";case kt.USER:return"user"}return t(void 0)}function Ot(t){return jt(t)}wt.test={disabled:!1},function(t){t[t.INITIALIZING=0]="INITIALIZING",t[t.CONSTRUCTING=1]="CONSTRUCTING",t[t.CONSTRUCTED=2]="CONSTRUCTED"}(bt||(bt={})),(At=kt||(kt={}))[At.DEFAULTS=0]="DEFAULTS",At[At.COMPUTED=1]="COMPUTED",At[At.SERVICE=2]="SERVICE",At[At.PORTAL_ITEM=3]="PORTAL_ITEM",At[At.WEB_SCENE=4]="WEB_SCENE",At[At.WEB_MAP=5]="WEB_MAP",At[At.USER=6]="USER",function(t){t[t.Dirty=1]="Dirty",t[t.Overriden=2]="Overriden",t[t.Computing=4]="Computing",t[t.NonNullable=8]="NonNullable",t[t.HasDefaultValue=16]="HasDefaultValue",t[t.DepTrackingInitialized=32]="DepTrackingInitialized",t[t.AutoTracked=64]="AutoTracked",t[t.ExplicitlyTracking=128]="ExplicitlyTracking"}(xt||(xt={}));const _t={onObservableAccessed:()=>{},onTrackingEnd:()=>{}},It=[];let Tt=_t;function Et(t){Tt.onObservableAccessed(t)}let Nt=!1,$t=!1;function Ut(t,e,i){if(Nt)return Pt(t,e,i);Ct(t);const n=e.call(i);return Dt(),n}function Pt(t,e,i){const r=Nt;Nt=!0,Ct(t);let s=null;try{s=e.call(i)}catch(t){$t&&n.getLogger("esri.core.accessorSupport.tracking").error(t)}return Dt(),Nt=r,s}function Ct(t){Tt=t,It.push(t)}function Dt(){const t=It.length;if(t>1){const e=It.pop();Tt=It[t-2],e.onTrackingEnd()}else if(1===t){const t=It.pop();Tt=_t,t.onTrackingEnd()}else Tt=_t}function zt(t,e){if(e.flags&xt.DepTrackingInitialized)return;const i=$t;$t=!1,e.flags&xt.AutoTracked?Pt(e,e.metadata.get,t):Mt(t,e),$t=i}const Rt=[];function Mt(t,e){e.flags&xt.ExplicitlyTracking||(e.flags|=xt.ExplicitlyTracking,Pt(e,(()=>{const i=e.metadata.dependsOn||Rt;for(const e of i)if("string"!=typeof e||e.includes(".")){const i=st(e);for(let e=0,n=t;e<i.length&&null!=n&&"object"==typeof n;++e)n=Ft(n,i[e],e!==i.length-1)}else Ft(t,e,!1)})),e.flags&=~xt.ExplicitlyTracking)}function Ft(t,e,i){const n="?"===e[e.length-1]?e.slice(0,-1):e;if(null!=t.getItemAt||Array.isArray(t)){const e=parseInt(n,10);if(!isNaN(e))return Array.isArray(t)?t[e]:t.getItemAt(e)}const r=it(t)?.properties.get(n);return r&&(Et(r),zt(t,r)),i?t[n]:void 0}class qt{constructor(t,e){this._observers=t,this._observer=e}remove(){r(this._observers,this._observer)}}class Lt{constructor(t,e,i){this.properties=t,this.propertyName=e,this.metadata=i,this._observers=null,this._accessed=null,this._handles=null,this.flags=xt.Dirty|(i.nonNullable?xt.NonNullable:0)|(i.hasOwnProperty("value")?xt.HasDefaultValue:0)|(void 0===i.get?xt.DepTrackingInitialized:0)|(void 0===i.dependsOn?xt.AutoTracked:0)}destroy(){if(this.flags&xt.Dirty&&this._observers){const t=this._observers.slice();for(const e of t)e.onCommitted()}this._accessed=null,this._observers=null,this._clearObservationHandles()}getComputed(){Et(this);const t=this.properties.store,e=this.propertyName,i=this.flags,n=t.get(e);if(i&xt.Computing)return n;if(~i&xt.Dirty&&t.has(e))return n;this.flags|=xt.Computing;const r=this.properties.host;let s;i&xt.AutoTracked?s=Ut(this,this.metadata.get,r):(Mt(r,this),s=this.metadata.get.call(r)),t.set(e,s,kt.COMPUTED);const o=t.get(e);return o===n?this.flags&=~xt.Dirty:function(t,e){Ut(_t,t,e)}(this.commit,this),this.flags&=~xt.Computing,o}onObservableAccessed(t){t!==this&&(null===this._accessed&&(this._accessed=[]),this._accessed.includes(t)||this._accessed.push(t))}onTrackingEnd(){this._clearObservationHandles(),this.flags|=xt.DepTrackingInitialized;const t=this._accessed;if(null===t)return;let e=this._handles;null===e&&(e=this._handles=[]);for(let i=0;i<t.length;++i)e.push(t[i].observe(this));t.length=0}observe(t){return null===this._observers&&(this._observers=[]),this._observers.includes(t)||this._observers.push(t),new qt(this._observers,t)}notifyChange(){this.onInvalidated(),this.onCommitted()}invalidate(){this.onInvalidated()}onInvalidated(){~this.flags&xt.Overriden&&(this.flags|=xt.Dirty);const t=this._observers;if(null!==t)for(let e=0;e<t.length;++e)t[e].onInvalidated()}commit(){this.flags&=~xt.Dirty,this.onCommitted()}onCommitted(){if(null===this._observers)return;const t=this._observers.slice();for(let e=0;e<t.length;++e)t[e].onCommitted()}_clearObservationHandles(){const t=this._handles;if(null!==t){for(let e=0;e<t.length;++e)t[e].remove();t.length=0}}}class Bt{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(t){const e=new Bt;return this._values.forEach(((n,r)=>{t&&t.has(r)||e.set(r,i(n))})),e}get(t){return this._values.get(t)}originOf(){return kt.USER}keys(){return[...this._values.keys()]}set(t,e){this._values.set(t,e)}delete(t){this._values.delete(t)}has(t){return this._values.has(t)}forEach(t){this._values.forEach(t)}}function Gt(t){return void 0!==t}function Jt(t,e,i){return!(void 0===t||null==i&&t.flags&xt.NonNullable)}function Ht(t){return t&&"function"==typeof t.destroy}n.getLogger("esri.core.accessorSupport.Properties");class Vt{constructor(t){this.host=t,this.properties=new Map,this.ctorArgs=null,this.destroyed=!1,this.lifecycle=bt.INITIALIZING,this.store=new Bt,this._origin=kt.USER;const e=this.host.constructor.__accessorMetadata__,i=e.properties;for(const t in i){const e=new Lt(this,t,i[t]);this.properties.set(t,e)}this.metadatas=i,this._autoDestroy=e.autoDestroy}initialize(){this.lifecycle=bt.CONSTRUCTING}constructed(){this.lifecycle=bt.CONSTRUCTED}destroy(){if(this.destroyed=!0,this._autoDestroy)for(const[t,e]of this.properties){const i=this.internalGet(t);i&&Ht(i)&&(i.destroy(),~e.flags&xt.NonNullable&&this._internalSet(e,null)),e.destroy()}else for(const[t,e]of this.properties)e.destroy()}get initialized(){return this.lifecycle!==bt.INITIALIZING}get(t){const e=this.properties.get(t);if(e.metadata.get)return e.getComputed();Et(e);const i=this.store;return i.has(t)?i.get(t):e.metadata.value}originOf(t){const e=this.store.originOf(t);if(void 0===e){const e=this.properties.get(t);if(void 0!==e&&e.flags&xt.HasDefaultValue)return"defaults"}return jt(e)}has(t){return!!this.properties.has(t)&&this.store.has(t)}keys(){return[...this.properties.keys()]}internalGet(t){const e=this.properties.get(t);if(Gt(e))return this.store.has(t)?this.store.get(t):e.metadata.value}internalSet(t,e){const i=this.properties.get(t);Gt(i)&&this._internalSet(i,e)}getDependsInfo(t,e,i){const n=this.properties.get(e);if(!Gt(n))return"";const r=new Set,s=Ut({onObservableAccessed:t=>r.add(t),onTrackingEnd:()=>{}},(()=>n.metadata.get?.call(t)));let o=`${i}${t.declaredClass.split(".").pop()}.${e}: ${s}\n`;if(0===r.size)return o;i+="  ";for(const t of r){if(!(t instanceof Lt))continue;const e=t.properties.host,n=t.propertyName,r=it(e);o+=r?r.getDependsInfo(e,n,i):`${i}${n}: undefined\n`}return o}setAtOrigin(t,e,i){const n=this.properties.get(t);if(Gt(n))return this._setAtOrigin(n,e,i)}isOverridden(t){const e=this.properties.get(t);return void 0!==e&&!!(e.flags&xt.Overriden)}clearOverride(t){const e=this.properties.get(t);void 0!==e&&e.flags&xt.Overriden&&(e.flags&=~xt.Overriden,e.notifyChange())}override(t,e){const i=this.properties.get(t);if(!Jt(i,0,e))return;const n=i.metadata.cast;if(n){const t=this._cast(n,e),{valid:i,value:r}=t;if(Wt.release(t),!i)return;e=r}i.flags|=xt.Overriden,this._internalSet(i,e)}set(t,e){const i=this.properties.get(t);if(!Jt(i,0,e))return;const n=i.metadata.cast;if(n){const t=this._cast(n,e),{valid:i,value:r}=t;if(Wt.release(t),!i)return;e=r}const r=i.metadata.set;r?r.call(this.host,e):this._internalSet(i,e)}setDefaultOrigin(t){this._origin=St(t)}getDefaultOrigin(){return jt(this._origin)}notifyChange(t){const e=this.properties.get(t);void 0!==e&&e.notifyChange()}invalidate(t){const e=this.properties.get(t);void 0!==e&&e.invalidate()}commit(t){const e=this.properties.get(t);void 0!==e&&e.commit()}_internalSet(t,e){this._setAtOrigin(t,e,this.lifecycle!==bt.INITIALIZING?this._origin:kt.DEFAULTS)}_setAtOrigin(t,e,i){const n=this.store,r=t.propertyName;n.has(r,i)&&s(e,n.get(r))&&~t.flags&xt.Overriden&&i===n.originOf(r)||(t.invalidate(),n.set(r,e,i),t.commit(),zt(this.host,t))}_cast(t,e){const i=Wt.acquire();return i.valid=!0,i.value=e,t&&(i.value=t.call(this.host,e,i)),i}}const Wt=new wt(class{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}});function Yt(t,e,i){if(t&&e)if("object"==typeof e)for(const i of Object.getOwnPropertyNames(e))Yt(t,i,e[i]);else{if(e.includes(".")){const n=e.split("."),r=n.splice(n.length-1,1)[0];return void Yt(ft(t,n),r,i)}const n=t.__accessor__;null!=n&&function(t,e){if(o("esri-unknown-property-errors")&&!function(t,e){return null!=e.metadatas[t]}(t,e))throw new a("set:unknown-property",function(t,e){return"setting unknown property '"+t+"' on instance of "+e.host.declaredClass}(t,e))}(e,n),t[e]=i}}function Xt(t){t.length=0}class Zt{constructor(t=50,e=50){this._pool=new wt(Array,void 0,Xt,e,t)}acquire(){return this._pool.acquire()}release(t){this._pool.release(t)}prune(){this._pool.prune(0)}static acquire(){return Kt.acquire()}static release(t){return Kt.release(t)}static prune(){Kt.prune()}}const Kt=new Zt(100),Qt=[];class te{constructor(t,e=30){this.name=t,this._counter=0,this._samples=new Array(e)}record(t){e(t)&&(this._samples[++this._counter%this._samples.length]=t)}get median(){return this._samples.slice().sort(((t,e)=>t-e))[Math.floor(this._samples.length/2)]}get average(){return this._samples.reduce(((t,e)=>t+e),0)/this._samples.length}get last(){return this._samples[this._counter%this._samples.length]}}var ee;!function(t){const e=(t,e,i,n)=>{let r=e,s=e;const o=i>>>1,a=t[r-1];for(;s<=o;){s=r<<1,s<i&&n(t[s-1],t[s])<0&&++s;const e=t[s-1];if(n(e,a)<=0)break;t[r-1]=e,r=s}t[r-1]=a},i=(t,e)=>t<e?-1:t>e?1:0;t.sort=function(t,n,r,s){void 0===n&&(n=0),void 0===r&&(r=t.length),void 0===s&&(s=i);for(let i=r>>>1;i>n;i--)e(t,i,r,s);const o=n+1;for(let i=r-1;i>n;i--){const r=t[n];t[n]=t[i],t[i]=r,e(t,o,i,s)}},t.iterableSort=function*(t,n,r,s){void 0===n&&(n=0),void 0===r&&(r=t.length),void 0===s&&(s=i);for(let i=r>>>1;i>n;i--)e(t,i,r,s),yield;const o=n+1;for(let i=r-1;i>n;i--){const r=t[n];t[n]=t[i],t[i]=r,e(t,o,i,s),yield}}}(ee||(ee={}));const ie=ee;class ne{constructor(t){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new c,t&&(t.initialSize&&(this.data=new Array(t.initialSize)),t.allocator&&(this._allocator=t.allocator),void 0!==t.deallocator&&(this._deallocator=t.deallocator),t.shrink&&(this._shrink=()=>re(this)))}toArray(){return this.data.slice(0,this.length)}filter(t){const e=new Array;for(let i=0;i<this._length;i++){const n=this.data[i];t(n)&&e.push(n)}return e}getItemAt(t){if(!(t<0||t>=this._length))return this.data[t]}includes(t,e){const i=this.data.indexOf(t,e);return-1!==i&&i<this.length}get length(){return this._length}set length(t){if(t>this._length){if(this._allocator){for(;this._length<t;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=t}else{if(this._deallocator)for(let e=t;e<this._length;++e)this.data[e]=this._deallocator(this.data[e]);this._length=t,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(t){this.data[this._length++]=t}pushArray(t,e=t.length){for(let i=0;i<e;i++)this.data[this._length++]=t[i]}fill(t,e){for(let i=0;i<e;i++)this.data[this._length++]=t}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const t=this.data[this._length];return++this._length,t}unshift(t){this.data.unshift(t),this._length++,re(this)}pop(){if(0===this.length)return;const t=this.data[this.length-1];return this.length=this.length-1,this._shrink(),t}remove(t){const e=l(this.data,t,this.length,this._hint);if(-1!==e)return this.data.splice(e,1),this.length=this.length-1,t}removeUnordered(t){return this.removeUnorderedIndex(l(this.data,t,this.length,this._hint))}removeUnorderedIndex(t){if(!(t>=this.length||t<0))return this.swapElements(t,this.length-1),this.pop()}removeUnorderedMany(t,e=t.length,i){this.length=h(this.data,t,this.length,e,this._hint,i),this._shrink()}front(){if(0!==this.length)return this.data[0]}back(){if(0!==this.length)return this.data[this.length-1]}swapElements(t,e){if(t>=this.length||e>=this.length||t===e)return;const i=this.data[t];this.data[t]=this.data[e],this.data[e]=i}sort(t){ie.sort(this.data,0,this.length,t)}iterableSort(t){return ie.iterableSort(this.data,0,this.length,t)}some(t,e){for(let i=0;i<this.length;++i)if(t.call(e,this.data[i],i,this.data))return!0;return!1}filterInPlace(t,e){let i=0;for(let n=0;n<this._length;++n){const r=this.data[n];t.call(e,r,n,this.data)&&(this.data[n]=this.data[i],this.data[i]=r,i++)}if(this._deallocator)for(let t=i;t<this._length;t++)this.data[t]=this._deallocator(this.data[t]);return this._length=i,this._shrink(),this}forAll(t,e){const i=this.length,n=this.data;for(let r=0;r<i;++r)t.call(e,n[r],r,n)}forEach(t,e){for(let i=0;i<this.length;++i)t.call(e,this.data[i],i,this.data)}map(t,e){const i=new Array(this.length);for(let n=0;n<this.length;++n)i[n]=t.call(e,this.data[n],n,this.data);return i}reduce(t,e){let i=e;for(let e=0;e<this.length;++e)i=t(i,this.data[e],e,this.data);return i}has(t){const e=this.length,i=this.data;for(let n=0;n<e;++n)if(i[n]===t)return!0;return!1}}function re(t){t.data.length>1.5*t.length&&(t.data.length=Math.floor(1.1*t.length))}class se{constructor(t){this.callback=t,this.isActive=!0}remove(){this.isActive=!1}}let oe=0;const ae={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},ue=["prepare","preRender","render","postRender","update","finish"],ce=[],le=new ne,he={frameTasks:le,willDispatch:!1,clearFrameTasks:function(t=!1){le.forAll((t=>{t.removed=!0})),t&&de()},dispatch:pe,executeFrameTasks:function(t){const e=t-oe;oe=t;const i=1e3/60,n=Math.max(0,e-i);for(let r=0;r<ue.length;r++){const s=performance.now(),o=ue[r];le.forAll((s=>{s.paused||s.removed||(0===r&&s.ticks++,s.phases[o]&&(ae.time=t,ae.deltaTime=0===s.ticks?0:e,ae.elapsedFrameTime=performance.now()-t,ae.frameDuration=i-n,s.phases[o]?.call(s,ae)))})),ge[r].record(performance.now()-s)}de(),ve.record(performance.now()-t)}};const fe=new ne;function de(){le.forAll((t=>{t.removed&&fe.push(t)})),le.removeUnorderedMany(fe.data,fe.length),fe.clear()}function pe(){for(;ce.length;){const e=t(ce.shift());e.isActive&&e.callback()}he.willDispatch=!1}const ge=ue.map((t=>new te(t))),ve=new te("total");let me=0;function ye(){return++me}class we{constructor(t){this._notify=t,this._accessed=[],this._handles=[],this._invalidCount=0}destroy(){this._accessed.length=0,this.clear()}onInvalidated(){this._invalidCount++}onCommitted(){const t=this._invalidCount;if(1===t)return this._invalidCount=0,void this._notify();this._invalidCount=t>0?t-1:0}onObservableAccessed(t){this._accessed.includes(t)||this._accessed.push(t)}onTrackingEnd(){const t=this._handles,e=this._accessed;for(let i=0;i<e.length;++i)t.push(e[i].observe(this));e.length=0}clear(){const t=this._handles;for(let e=0;e<t.length;++e)t[e].remove();t.length=0}}let be=!1;const ke=[];function xe(t,e){let i=new we((function s(){if(!i||r)return;if(be)return void function(t){ke.includes(t)||ke.unshift(t)}(s);const o=n;i.clear(),be=!0,r=!0,n=Ut(i,t),r=!1,be=!1,e(n,o),function(){for(;ke.length;)ke.pop()()}()})),n=null,r=!1;return r=!0,n=Ut(i,t),r=!1,{remove:function(){i&&(i.destroy(),i=null,n=null)}}}function Ae(t,e){let i=new we((function(){e(n,r)})),n=null;function r(){return i?(i.clear(),n=Ut(i,t),n):null}return r(),{remove:function(){i&&(i.destroy(),i=null),n=null}}}var Se;!function(t){t[t.Untracked=0]="Untracked",t[t.Tracked=1]="Tracked"}(Se||(Se={}));class je{constructor(){this.uid=ye(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(t,e,i,n,r){return this.pool.acquire(Se.Untracked,t,e,i,n,r,s)}static acquireTracked(t,e,i,n){return this.pool.acquire(Se.Tracked,t,e,i,null,null,n)}notify(t,e){this.type===Se.Untracked?this.callback.call(this.target,t,e,this.path,this.target):this.callback.call(null,t,e)}acquire(t,e,i,n,r,s,o){this.uid=ye(),this.removed=!1,this.type=t,this.oldValue=e,this.callback=i,this.getValue=n,this.target=r,this.path=s,this.equals=o}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=ye(),this.removed=!0}}je.pool=new class extends wt{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=u()}acquire(...t){const e=super.acquire(...t);return this._set.delete(e),e}release(t){t&&!this._set.has(t)&&(super.release(t),this._set.add(t))}_dispose(t){this._set.delete(t),super._dispose(t)}}(je);const Oe=new Zt,_e=new Set;let Ie;function Te(t){_e.delete(t),_e.add(t),Ie||(Ie=function(t){const e=new se(t);return ce.push(e),he.willDispatch||(he.willDispatch=!0,Qt.push(pe),1===Qt.length&&queueMicrotask((()=>{const t=Qt.slice();Qt.length=0;for(const e of t)e()}))),e}(Ne))}function Ee(t){if(t.removed)return;const e=t.oldValue,i=t.getValue();t.equals(e,i)||(t.oldValue=i,t.notify(i,e))}function Ne(){let t=10;for(;Ie&&t--;){Ie=null;const t=$e(),e=Oe.acquire();for(const i of t){const t=i.uid;Ee(i),t===i.uid&&i.removed&&e.push(i)}for(const t of _e)t.removed&&(e.push(t),_e.delete(t));for(const t of e)je.pool.release(t);Oe.release(e),Oe.release(t),Ue.forEach((t=>t()))}}function $e(){const t=Oe.acquire();t.length=_e.size;let e=0;for(const i of _e)t[e]=i,++e;return _e.clear(),t}const Ue=new Set;const Pe=n.getLogger("esri.core.accessorSupport.ensureTypes");function Ce(t){return null==t?t:new Date(t)}function De(t){return null==t?t:!!t}function ze(t){return null==t?t:t.toString()}function Re(t){return null==t?t:(t=parseFloat(t),isNaN(t)?0:t)}function Me(t){return null==t?t:Math.round(parseFloat(t))}function Fe(t){return t&&t.constructor&&void 0!==t.constructor.__accessorMetadata__}function qe(t,e){return null!=e&&t&&!(e instanceof t)}function Le(t){return t&&"isCollection"in t}function Be(t){return t&&t.Type?"function"==typeof t.Type?t.Type:t.Type.base:null}function Ge(t,e){return!!Fe(e)&&(Pe.error("Accessor#set","Assigning an instance of '"+(e.declaredClass||"unknown")+"' which is not a subclass of '"+He(t)+"'"),!0)}function Je(t,e){return null==e?e:Le(t)?function(t,e){if(!e||!e.constructor||!Le(e.constructor))return Ge(t,e)?e:new t(e);const i=Be(t.prototype.itemType),n=Be(e.constructor.prototype.itemType);return i?n?i===n?e:i.prototype.isPrototypeOf(n.prototype)?new t(e):(Ge(t,e),e):new t(e):e}(t,e):qe(t,e)?Ge(t,e)?e:new t(e):e}function He(t){return t&&t.prototype&&t.prototype.declaredClass||"unknown"}const Ve=new WeakMap;function We(t){switch(t){case Number:return Re;case ii:return Me;case Boolean:return De;case String:return ze;case Date:return Ce;default:return function(e,i){const n=e.get(i);if(void 0!==n)return n;const r=Je.bind(null,t);return e.set(i,r),r}(Ve,t)}}function Ye(t,e){const i=We(t);return 1===arguments.length?i:i(e)}function Xe(t,e,i){return 1===arguments.length?Xe.bind(null,t):e?Array.isArray(e)?e.map((e=>t(e,i))):[t(e,i)]:e}function Ze(t,e,i){return 0!==e&&Array.isArray(i)?i.map((i=>Ze(t,e-1,i))):t(i)}function Ke(t,e,i){if(2===arguments.length)return Ke.bind(null,t,e);if(!i)return i;let n=e,r=i=Ze(t,e,i);for(;n>0&&Array.isArray(r);)n--,r=r[0];if(void 0!==r)for(let t=0;t<n;t++)i=[i];return i}function Qe(t){return!!Array.isArray(t)&&!t.some((e=>{const i=typeof e;return!("string"===i||"number"===i||"function"===i&&t.length>1)}))}function ti(t,e){if(2===arguments.length)return ti(t).call(null,e);const i=new Set,n=t.filter((t=>"function"!=typeof t)),r=t.filter((t=>"function"==typeof t));for(const e of t)"string"!=typeof e&&"number"!=typeof e||i.add(e);let s=null,o=null;return(t,e)=>{if(null==t)return t;const a=typeof t,u="string"===a||"number"===a;return u&&(i.has(t)||r.some((t=>"string"===a&&t===String||"number"===a&&t===Number)))||"object"===a&&r.some((e=>!qe(t,e)))?t:(u&&n.length?(s||(s=n.map((t=>"string"==typeof t?`'${t}'`:`${t}`)).join(", ")),Pe.error("Accessor#set",`'${t}' is not a valid value for this property, only the following values are valid: ${s}`)):"object"==typeof t&&r.length?(o||(o=r.map((t=>He(t))).join(", ")),Pe.error("Accessor#set",`'${t}' is not a valid value for this property, value must be one of ${o}`)):Pe.error("Accessor#set",`'${t}' is not a valid value for this property`),e&&(e.valid=!1),null)}}function ei(t,e){if(2===arguments.length)return ei(t).call(null,e);const i={},n=[],r=[];for(const e in t.typeMap){const s=t.typeMap[e];i[e]=Ye(s),n.push(He(s)),r.push(e)}const s=()=>`'${n.join("', '")}'`,o=()=>`'${r.join("', '")}'`,a="string"==typeof t.key?e=>e[t.key]:t.key;return e=>{if(t.base&&!qe(t.base,e))return e;if(null==e)return e;const n=a(e)||t.defaultKeyValue,r=i[n];if(!r)return Pe.error("Accessor#set",`Invalid property value, value needs to be one of ${s()}, or a plain object that can autocast (having .type = ${o()})`),null;if(!qe(t.typeMap[n],e))return e;if("string"==typeof t.key&&!Fe(e)){const i={};for(const n in e)n!==t.key&&(i[n]=e[n]);return r(i)}return r(e)}}class ii{}function ni(t){switch(t.type){case"native":return Ye(t.value);case"array":return Xe(ni(t.value));case"one-of":return function(t){let e=null;return(i,n)=>si(i,t)?i:(null==e&&(e=ri(t)),Pe.error("Accessor#set",`Invalid property value, value needs to be of type ${e}`),n&&(n.valid=!1),null)}(t);default:return null}}function ri(t){switch(t.type){case"native":switch(t.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case ii:return"integer";case Date:return"date";default:return He(t.value)}case"array":return`array of ${ri(t.value)}`;case"one-of":{const e=t.values.map((t=>ri(t)));return`one of ${e.slice(0,e.length-1)} or ${e[e.length-1]}`}}return"unknown"}function si(t,e){if(null==t)return!0;switch(e.type){case"native":switch(e.value){case Number:case ii:return"number"==typeof t;case Boolean:return"boolean"==typeof t;case String:return"string"==typeof t}return t instanceof e.value;case"array":return!!Array.isArray(t)&&!t.some((t=>!si(t,e.value)));case"one-of":return e.values.some((e=>si(t,e)))}}function oi(t={}){return(e,i)=>{if(e===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${e.name}.${i}. Accessor does not support static properties.`);const r=Object.getOwnPropertyDescriptor(e,i),s=vt(e,i);r&&(r.get||r.set?(s.get=r.get||s.get,s.set=r.set||s.set):"value"in r&&("value"in t&&n.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${i}" on "${e.constructor.name}" already defined in the metadata`,t),s.value=t.value=r.value)),null!=t.readOnly&&(s.readOnly=t.readOnly);const o=t.aliasOf;if(o){const t="string"==typeof o?o:o.source,e="string"==typeof o?null:!0===o.overridable;let n;s.dependsOn=[t],s.get=function(){let e=ft(this,t);if("function"==typeof e){n||(n=t.split(".").slice(0,-1).join("."));const i=ft(this,n);i&&(e=e.bind(i))}return e},s.readOnly||(s.set=e?function(t){this._override(i,t)}:function(e){Yt(this,t,e)})}const a=t.type,u=t.types;s.cast||(a?s.cast=function(t){let e=0,i=t;if(function(t){if(!t||!("type"in t))return!1;switch(t.type){case"native":case"array":case"one-of":return!0}return!1}(t))return ni(t);for(;Array.isArray(i)&&1===i.length&&"string"!=typeof i[0]&&"number"!=typeof i[0];)i=i[0],e++;const n=i;if(Qe(n))return 0===e?ti(n):Ke(ti(n),e);if(1===e)return function(t,e){return 1===arguments.length?Xe(Ye.bind(null,t)):Xe(Ye.bind(null,t),e)}(n);if(e>1)return function(t,e,i){return 2===arguments.length?Ke(Ye.bind(null,t),e):Ke(Ye.bind(null,t),e,i)}(n,e);return t.from?t.from:Ye(t)}(a):u&&(s.cast=Array.isArray(u)?Xe(ei(u[0])):ei(u))),function(t,e){nt(t,e,yt)}(s,t),t.range&&(s.cast=function(t,e){return i=>{let n=+t(i);return null!=e.step&&(n=Math.round(n/e.step)*e.step),null!=e.min&&(n=Math.max(e.min,n)),null!=e.max&&(n=Math.min(e.max,n)),n}}(s.cast,t.range))}}class ai extends d{constructor(t,e,i){if(super(t,e,i),!(this instanceof ai))return new ai(t,e,i)}}function ui(t){return!!t&&t.prototype&&t.prototype.declaredClass&&0===t.prototype.declaredClass.indexOf("esri.core.Collection")}ai.prototype.type="warning";const ci=n.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function li(t,e,i){t&&(!i&&!e.read||e.read?.reader||!1===e.read?.enabled||function(t){return"types"in t?vi(t.types):gi(t.type)}(t)&&p("read.reader",function(t){const e=t.ndimArray??0;if(e>1)return function(t){const e=hi(t),i=fi.bind(null,e),n=t.ndimArray??0;return(t,e,r)=>{if(null==t)return t;t=i(t,r,n);let s=n,o=t;for(;s>0&&Array.isArray(o);)s--,o=o[0];if(void 0!==o)for(let e=0;e<s;e++)t=[t];return t}}(t);if(1===e)return di(t);if("type"in t&&pi(t.type)){const e=t.type.prototype?.itemType?.Type,i=di("function"==typeof e?{type:e}:{types:e});return(e,n,r)=>{const s=i(e,n,r);return s?new t.type(s):s}}return hi(t)}(t),e))}function hi(t){return"type"in t?function(t){return t.prototype.read?(e,i,n)=>{if(null==e)return e;const r=typeof e;if("object"!==r)return void ci.error(`Expected JSON value of type 'object' to deserialize type '${t.prototype.declaredClass}', but got '${r}'`);const s=new t;return s.read(e,n),s}:t.fromJSON}(t.type):function(t){let e=null;const i=t.errorContext??"type";return(n,r,s)=>{if(null==n)return n;const o=typeof n;if("object"!==o)return void ci.error(`Expected JSON value of type 'object' to deserialize, but got '${o}'`);e||(e=function(t){const e={};for(const i in t.typeMap){const n=t.typeMap[i],r=gt(n.prototype);if("function"==typeof t.key)continue;const s=r.properties[t.key];if(!s)continue;s.json?.type&&Array.isArray(s.json.type)&&1===s.json.type.length&&"string"==typeof s.json.type[0]&&(e[s.json.type[0]]=n);const o=s.json?.write;if(!o||!o.writer){e[i]=n;continue}const a=o.target,u="string"==typeof a?a:t.key,c={};o.writer(i,c,u),c[u]&&(e[c[u]]=n)}return e}(t));const a=t.key;if("string"!=typeof a)return;const u=n[a],c=u?e[u]:t.defaultKeyValue?t.typeMap[t.defaultKeyValue]:void 0;if(!c){const t=`Type '${u||"unknown"}' is not supported`;return s&&s.messages&&n&&s.messages.push(new ai(`${i}:unsupported`,t,{definition:n,context:s})),void ci.error(t)}const l=new c;return l.read(n,s),l}}(t.types)}function fi(t,e,i,n){return 0!==n&&Array.isArray(e)?e.map((e=>fi(t,e,i,n-1))):t(e,void 0,i)}function di(t){const e=hi(t);return(t,i,n)=>{if(null==t)return t;if(Array.isArray(t)){const i=[];for(const r of t){const t=e(r,void 0,n);void 0!==t&&i.push(t)}return i}const r=e(t,void 0,n);return void 0!==r?[r]:void 0}}function pi(t){if(!ui(t))return!1;const e=t.prototype.itemType;return!(!e||!e.Type)&&("function"==typeof e.Type?gi(e.Type):vi(e.Type))}function gi(t){return!Array.isArray(t)&&!!t&&t.prototype&&("read"in t.prototype||"fromJSON"in t||pi(t))}function vi(t){for(const e in t.typeMap)if(!gi(t.typeMap[e]))return!1;return!0}function mi(t){t.name&&(t.read&&"object"==typeof t.read?void 0===t.read.source&&(t.read.source=t.name):t.read={source:t.name},t.write&&"object"==typeof t.write?void 0===t.write.target&&(t.write.target=t.name):t.write={target:t.name})}function yi(t){"boolean"==typeof t.read?t.read={enabled:t.read}:"function"==typeof t.read?t.read={enabled:!0,reader:t.read}:t.read&&"object"==typeof t.read&&void 0===t.read.enabled&&(t.read.enabled=!0)}function wi(t){"boolean"==typeof t.write?t.write={enabled:t.write}:"function"==typeof t.write?t.write={enabled:!0,writer:t.write}:t.write&&"object"==typeof t.write&&void 0===t.write.enabled&&(t.write.enabled=!0)}function bi(t,e){if(!e.write||e.write.writer||!1===e.write.enabled&&!e.write.overridePolicy)return;const i=t?.ndimArray??0;e.write.writer=t&&(1===i||"type"in t&&ui(t.type))?Si:i>1?function(t){return(e,i,n,r)=>{let s;if(null===e)s=null;else{s=ji(e,r,t);let i=t,n=s;for(;i>0&&Array.isArray(n);)i--,n=n[0];if(void 0!==n)for(let t=0;t<i;t++)s=[s]}p(n,s,i)}}(i):e.types?Array.isArray(e.types)?function(t){return(e,i,n,r)=>e&&Array.isArray(e)?xi(e.filter((e=>ki(e,t,r))),i,n,r):xi(e,i,n,r)}(e.types[0]):function(t){return(e,i,n,r)=>e?ki(e,t,r)?xi(e,i,n,r):void 0:xi(e,i,n,r)}(e.types):xi}function ki(t,e,i){for(const i in e.typeMap)if(t instanceof e.typeMap[i])return!0;if(i?.messages){const r=`Values of type '${("function"!=typeof e.key?t[e.key]:t.declaredClass)??"Unknown"}' cannot be written`;i&&i.messages&&t&&i.messages.push(new a(`${e.errorContext??"type"}:unsupported`,r,{definition:t,context:i})),n.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(r)}return!1}function xi(t,e,i,n){p(i,Ai(t,n),e)}function Ai(t,e){return t&&"function"==typeof t.write?t.write({},e):t&&"function"==typeof t.toJSON?t.toJSON():"number"==typeof t?function(t){return t===-1/0?-Number.MAX_VALUE:t===1/0?Number.MAX_VALUE:isNaN(t)?null:t}(t):t}function Si(t,e,i,n){let r;null===t?r=null:t&&"function"==typeof t.map?(r=t.map((t=>Ai(t,n))),"function"==typeof r.toArray&&(r=r.toArray())):r=[Ai(t,n)],p(i,r,e)}function ji(t,e,i){return 0!==i&&Array.isArray(t)?t.map((t=>ji(t,e,i-1))):Ai(t,e)}function Oi(t,e){return Ii(t,"read",e)}function _i(t,e){return Ii(t,"write",e)}function Ii(t,e,i){let n=t&&t.json;if(t&&t.json&&t.json.origins&&i){const r=i.origin&&t.json.origins[i.origin];r&&("any"===e||e in r)&&(n=r)}return n}function Ti(t){return t.type?Ei(t):Ni(t)}function Ei(t){if(!t.type)return;let e=0,i=t.type;for(;Array.isArray(i)&&!Qe(i);)i=i[0],e++;return{type:i,ndimArray:e}}function Ni(t){if(!t.types)return;let e=0,i=t.types;for(;Array.isArray(i);)i=i[0],e++;return{types:i,ndimArray:e}}function $i(t){(function(t){if(t.json||(t.json={}),yi(t.json),wi(t.json),mi(t.json),t.json.origins)for(const e in t.json.origins)yi(t.json.origins[e]),wi(t.json.origins[e]),mi(t.json.origins[e]);return!0})(t)&&(function(t){if(t.json&&t.json.origins){const e=t.json.origins,i={"web-document":["web-scene","web-map"]};for(const t in i)if(e[t]){const n=e[t];i[t].forEach((t=>{e[t]=n})),delete e[t]}}}(t),function(t){const e=function(t){return t.json.types?Ni(t.json):t.type?Ei(t):Ni(t)}(t);if(t.json.origins)for(const i in t.json.origins){const n=t.json.origins[i],r=n.types?Ti(n):e;li(r,n,!1),n.types&&!n.write&&t.json.write&&t.json.write.enabled&&(n.write={...t.json.write}),bi(r,n)}li(e,t.json,!0),bi(e,t.json)}(t))}const Ui=new Set,Pi=new Set;function Ci(t){return e=>{e.prototype.declaredClass=t,function(t){const e=gt(t.prototype).properties,i={};for(const t of Object.getOwnPropertyNames(e)){const n=e[t];$i(n),i[t]={enumerable:!0,configurable:!0,get:Di(t,n),set(e){const i=this.__accessor__;if(void 0!==i){if(!Object.isFrozen(this)){if(i.initialized&&n.readOnly)throw new TypeError(`[accessor] cannot assign to read-only property '${t}' of ${this.declaredClass}`);if(i.lifecycle===bt.CONSTRUCTED&&n.constructOnly)throw new TypeError(`[accessor] cannot assign to construct-only property '${t}' of ${this.declaredClass}`);i.set(t,e)}}else Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}}}Object.defineProperties(t.prototype,i)}(e);const i=[],n=[];let r=e.prototype;for(;r;)r.hasOwnProperty("initialize")&&!Ui.has(r.initialize)&&(Ui.add(r.initialize),i.push(r.initialize)),r.hasOwnProperty("destroy")&&!Pi.has(r.destroy)&&(Pi.add(r.destroy),n.push(r.destroy)),r=Object.getPrototypeOf(r);Ui.clear(),Pi.clear();class s extends e{constructor(...t){if(super(...t),this.constructor===s&&"function"==typeof this.postscript){if(i.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let t=i.length-1;t>=0;t--)i[t].call(this)}}),n.length){let t=!1;Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!t){t=!0;for(let t=0;t<n.length;t++)n[t].call(this)}}})}this.postscript(...t)}}}return s.__accessorMetadata__=gt(e.prototype),s.prototype.declaredClass=t,s}}function Di(t,e){return null==e.get?function(){const e=this.__accessor__.properties.get(t);if(void 0===e)return;Et(e);const i=this.__accessor__.store;return i.has(t)?i.get(t):e.metadata.value}:function(){const e=this.__accessor__.properties.get(t);if(void 0!==e)return e.getComputed()}}var zi,Ri;function Mi(t){if(null==t)return{value:t};if(Array.isArray(t))return{type:[t[0]],value:null};switch(typeof t){case"object":return t.constructor?.__accessorMetadata__||t instanceof Date?{type:t.constructor,value:t}:t;case"boolean":return{type:Boolean,value:t};case"string":return{type:String,value:t};case"number":return{type:Number,value:t};case"function":return{type:t,value:null};default:return}}const Fi=Symbol("Accessor-Handles"),qi=Symbol("Accessor-Initialized");class Li{constructor(...t){if(this[zi]=null,this[Ri]=!1,this.constructor===Li)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");Object.defineProperty(this,"__accessor__",{enumerable:!1,value:new Vt(this)}),t.length>0&&this.normalizeCtorArgs&&(this.__accessor__.ctorArgs=this.normalizeCtorArgs.apply(this,t))}static createSubclass(t={}){if(Array.isArray(t))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:e,declaredClass:i,constructor:n}=t;delete t.declaredClass,delete t.properties,delete t.constructor;const r=this;class s extends r{constructor(...t){super(...t),this.inherited=null,n&&n.apply(this,t)}}gt(s.prototype);for(const e in t){const i=t[e];s.prototype[e]="function"==typeof i?function(...t){const n=this.inherited;let s;this.inherited=function(...t){if(r.prototype[e])return r.prototype[e].apply(this,t)};try{s=i.apply(this,t)}catch(t){throw this.inherited=n,t}return this.inherited=n,s}:t[e]}for(const t in e)oi(Mi(e[t]))(s.prototype,t);return Ci(i)(s)}postscript(t){const e=this.__accessor__,i=e.ctorArgs||t;e.initialize(),i&&(this.set(i),e.ctorArgs=null),e.constructed(),this.initialize(),this[qi]=!0}initialize(){}destroy(){this.destroyed||(this[Fi]=g(this[Fi]),function(t){for(const e of _e.values())e.target===t&&(e.removed=!0)}(this),this.__accessor__.destroy())}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[qi]}get destroyed(){return this.__accessor__&&this.__accessor__.destroyed||!1}commitProperty(t){this.get(t)}get(t){return ft(this,t)}hasOwnProperty(t){return this.__accessor__?this.__accessor__.has(t):Object.prototype.hasOwnProperty.call(this,t)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(t,e){return Yt(this,t,e),this}watch(t,e,i){return function(t,e,i,n=!1){return!t.__accessor__||t.__accessor__.destroyed?{remove(){}}:n?function(t,e,i){const n=at(t,e,i,((t,e,i)=>{let r=!1;return xe((()=>ht(t,e)),((o,a)=>{t.__accessor__.destroyed?n.remove():r||(r=!0,s(a,o)||i.call(t,o,a,e,t),r=!1)}))}));return n}(t,e,i):function(t,e,i){let n=at(t,e,i,((t,e,i)=>{let r,s,o=Ae((()=>ht(t,e)),((o,a)=>{t.__accessor__.destroyed||r&&r.uid!==s?n.remove():(r||(r=je.acquireUntracked(o,i,a,t,e),s=r.uid),Te(r))}));return{remove:ut((()=>{o.remove(),r&&(r.uid!==s||r.removed||(r.removed=!0,Te(r)),r=null),n=o=null}))}}));return n}(t,e,i)}(this,t,e,i)}own(t){this.addHandles(t)}addHandles(t,e){let i=this[Fi];v(i)&&(i=this[Fi]=new Q),i.add(t,e)}removeHandles(t){const e=this[Fi];v(e)||e.remove(t)}hasHandles(t){const i=this[Fi];return!!e(i)&&i.has(t)}_override(t,e){void 0===e?this.__accessor__.clearOverride(t):this.__accessor__.override(t,e)}_clearOverride(t){return this.__accessor__.clearOverride(t)}_overrideIfSome(t,e){null==e?this.__accessor__.clearOverride(t):this.__accessor__.override(t,e)}_isOverridden(t){return this.__accessor__.isOverridden(t)}notifyChange(t){this.__accessor__.notifyChange(t)}_get(t){return this.__accessor__.internalGet(t)}_set(t,e){return this.__accessor__.internalSet(t,e),this}}zi=Fi,Ri=qi;class Bi{constructor(){this._emitter=new Bi.EventEmitter(this)}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}}!function(t){class e{constructor(t=null){this._target=t,this._listenersMap=null}clear(){this._listenersMap&&this._listenersMap.clear(),this._listenersMap=null}emit(t,e){const i=this._listenersMap&&this._listenersMap.get(t);if(!i)return!1;const n=this._target||this;return[...i].forEach((t=>{t.call(n,e)})),i.length>0}on(t,e){if(Array.isArray(t))return tt(t.map((t=>this.on(t,e))));if(t.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap||(this._listenersMap=new Map);const i=this._listenersMap.get(t)||[];return i.push(e),this._listenersMap.set(t,i),{remove:()=>{const i=this._listenersMap&&this._listenersMap.get(t)||[],n=i.indexOf(e);n>=0&&i.splice(n,1)}}}once(t,e){const i=this.on(t,(t=>{i.remove(),e.call(null,t)}));return i}hasEventListener(t){const e=this._listenersMap&&this._listenersMap.get(t);return null!=e&&e.length>0}}t.EventEmitter=e,t.EventedMixin=t=>{let i=class extends t{constructor(){super(...arguments),this._emitter=new e}destroy(){this._emitter.clear()}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}};return i=Z([Ci("esri.core.Evented")],i),i};let i=class extends Li{constructor(){super(...arguments),this._emitter=new Bi.EventEmitter(this)}destroy(){this._emitter.clear()}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}};i=Z([Ci("esri.core.Evented")],i),t.EventedAccessor=i}(Bi||(Bi={}));const Gi=Bi;function Ji(t,e,i={}){return Vi(t,e,i,Wi)}function Hi(t,e,i={}){return Vi(t,e,i,Yi)}function Vi(t,e,i={},n){let r=null;const s=i.once?(t,i)=>{n(t)&&(m(r),e(t,i))}:(t,i)=>{n(t)&&e(t,i)};if(r=function(t,e,i=!1,n=f){return i?function(t,e,i){let n=!1;return xe(t,((t,r)=>{n||(n=!0,i(r,t)||e(t,r),n=!1)}))}(t,e,n):function(t,e,i){let n,r,s=Ae(t,((t,o)=>{n&&n.uid!==r?s.remove():(n||(n=je.acquireTracked(t,e,o,i),r=n.uid),Te(n))}));return{remove:ut((()=>{s.remove(),n&&(n.uid!==r||n.removed||(n.removed=!0,Te(n)),n=null),s=null}))}}(t,e,n)}(t,s,i.sync,i.equals),i.initial){const e=t();s(e,e)}return r}function Wi(){return!0}function Yi(t){return!!t}const Xi={initial:!0};var Zi;!function(t){t[t.PENDING=0]="PENDING",t[t.RESOLVED=1]="RESOLVED",t[t.REJECTED=2]="REJECTED"}(Zi||(Zi={}));class Ki{constructor(t){this.instance=t,this._resolver=y(),this._status=Zi.PENDING,this._resolvingPromises=[],this._resolver.promise.then((()=>{this._status=Zi.RESOLVED,this._cleanUp()}),(()=>{this._status=Zi.REJECTED,this._cleanUp()}))}addResolvingPromise(t){this._resolvingPromises.push(t),this._tryResolve()}isResolved(){return this._status===Zi.RESOLVED}isRejected(){return this._status===Zi.REJECTED}isFulfilled(){return this._status!==Zi.PENDING}abort(){this._resolver.reject(w())}when(t,e){return this._resolver.promise.then(t,e)}_cleanUp(){this._allPromise=this._resolvingPromises=this._allPromise=null}_tryResolve(){if(this.isFulfilled())return;const e=y(),i=[...this._resolvingPromises,t(e.promise)],n=this._allPromise=Promise.all(i);n.then((()=>{this.isFulfilled()||this._allPromise!==n||this._resolver.resolve(this.instance)}),(t=>{this.isFulfilled()||this._allPromise!==n||b(t)||this._resolver.reject(t)})),e.resolve()}}const Qi=t=>{let e=class extends t{constructor(...t){super(...t),this._promiseProps=new Ki(this),this.addResolvingPromise(Promise.resolve())}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(t,e){return new Promise(((t,e)=>{this._promiseProps.when(t,e)})).then(t,e)}catch(t){return this.when(null,t)}addResolvingPromise(t){t&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in t?t.when():t)}};return e=Z([Ci("esri.core.Promise")],e),e};let tn=class extends(Qi(Li)){};tn=Z([Ci("esri.core.Promise")],tn);const en="randomUUID"in crypto,nn=Object.prototype.toString;function rn(t){const e="__accessorMetadata__"in t?Ye(t):t;return function(...t){if(t.push(e),"number"==typeof t[2])throw new Error("Using @cast has parameter decorator is not supported since 4.16");return sn.apply(this,t)}}function sn(t,e,i,n){vt(t,e).cast=n}
/*!
 * @esri/arcgis-html-sanitizer - v3.0.1 - Tue Nov 15 2022 09:46:54 GMT-0800 (Pacific Standard Time)
 * Copyright (c) 2022 - Environmental Systems Research Institute, Inc.
 * Apache-2.0
 * 
 * js-xss
 * Copyright (c) 2012-2018 Zongmin Lei(雷宗民) <leizongmin@gmail.com>
 * http://ucdok.com
 * MIT License, see https://github.com/leizongmin/js-xss/blob/master/LICENSE for details
 */
var on={exports:{}},an={},un={exports:{}},cn={};function ln(){return{"align-content":!1,"align-items":!1,"align-self":!1,"alignment-adjust":!1,"alignment-baseline":!1,all:!1,"anchor-point":!1,animation:!1,"animation-delay":!1,"animation-direction":!1,"animation-duration":!1,"animation-fill-mode":!1,"animation-iteration-count":!1,"animation-name":!1,"animation-play-state":!1,"animation-timing-function":!1,azimuth:!1,"backface-visibility":!1,background:!0,"background-attachment":!0,"background-clip":!0,"background-color":!0,"background-image":!0,"background-origin":!0,"background-position":!0,"background-repeat":!0,"background-size":!0,"baseline-shift":!1,binding:!1,bleed:!1,"bookmark-label":!1,"bookmark-level":!1,"bookmark-state":!1,border:!0,"border-bottom":!0,"border-bottom-color":!0,"border-bottom-left-radius":!0,"border-bottom-right-radius":!0,"border-bottom-style":!0,"border-bottom-width":!0,"border-collapse":!0,"border-color":!0,"border-image":!0,"border-image-outset":!0,"border-image-repeat":!0,"border-image-slice":!0,"border-image-source":!0,"border-image-width":!0,"border-left":!0,"border-left-color":!0,"border-left-style":!0,"border-left-width":!0,"border-radius":!0,"border-right":!0,"border-right-color":!0,"border-right-style":!0,"border-right-width":!0,"border-spacing":!0,"border-style":!0,"border-top":!0,"border-top-color":!0,"border-top-left-radius":!0,"border-top-right-radius":!0,"border-top-style":!0,"border-top-width":!0,"border-width":!0,bottom:!1,"box-decoration-break":!0,"box-shadow":!0,"box-sizing":!0,"box-snap":!0,"box-suppress":!0,"break-after":!0,"break-before":!0,"break-inside":!0,"caption-side":!1,chains:!1,clear:!0,clip:!1,"clip-path":!1,"clip-rule":!1,color:!0,"color-interpolation-filters":!0,"column-count":!1,"column-fill":!1,"column-gap":!1,"column-rule":!1,"column-rule-color":!1,"column-rule-style":!1,"column-rule-width":!1,"column-span":!1,"column-width":!1,columns:!1,contain:!1,content:!1,"counter-increment":!1,"counter-reset":!1,"counter-set":!1,crop:!1,cue:!1,"cue-after":!1,"cue-before":!1,cursor:!1,direction:!1,display:!0,"display-inside":!0,"display-list":!0,"display-outside":!0,"dominant-baseline":!1,elevation:!1,"empty-cells":!1,filter:!1,flex:!1,"flex-basis":!1,"flex-direction":!1,"flex-flow":!1,"flex-grow":!1,"flex-shrink":!1,"flex-wrap":!1,float:!1,"float-offset":!1,"flood-color":!1,"flood-opacity":!1,"flow-from":!1,"flow-into":!1,font:!0,"font-family":!0,"font-feature-settings":!0,"font-kerning":!0,"font-language-override":!0,"font-size":!0,"font-size-adjust":!0,"font-stretch":!0,"font-style":!0,"font-synthesis":!0,"font-variant":!0,"font-variant-alternates":!0,"font-variant-caps":!0,"font-variant-east-asian":!0,"font-variant-ligatures":!0,"font-variant-numeric":!0,"font-variant-position":!0,"font-weight":!0,grid:!1,"grid-area":!1,"grid-auto-columns":!1,"grid-auto-flow":!1,"grid-auto-rows":!1,"grid-column":!1,"grid-column-end":!1,"grid-column-start":!1,"grid-row":!1,"grid-row-end":!1,"grid-row-start":!1,"grid-template":!1,"grid-template-areas":!1,"grid-template-columns":!1,"grid-template-rows":!1,"hanging-punctuation":!1,height:!0,hyphens:!1,icon:!1,"image-orientation":!1,"image-resolution":!1,"ime-mode":!1,"initial-letters":!1,"inline-box-align":!1,"justify-content":!1,"justify-items":!1,"justify-self":!1,left:!1,"letter-spacing":!0,"lighting-color":!0,"line-box-contain":!1,"line-break":!1,"line-grid":!1,"line-height":!1,"line-snap":!1,"line-stacking":!1,"line-stacking-ruby":!1,"line-stacking-shift":!1,"line-stacking-strategy":!1,"list-style":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,margin:!0,"margin-bottom":!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"marker-offset":!1,"marker-side":!1,marks:!1,mask:!1,"mask-box":!1,"mask-box-outset":!1,"mask-box-repeat":!1,"mask-box-slice":!1,"mask-box-source":!1,"mask-box-width":!1,"mask-clip":!1,"mask-image":!1,"mask-origin":!1,"mask-position":!1,"mask-repeat":!1,"mask-size":!1,"mask-source-type":!1,"mask-type":!1,"max-height":!0,"max-lines":!1,"max-width":!0,"min-height":!0,"min-width":!0,"move-to":!1,"nav-down":!1,"nav-index":!1,"nav-left":!1,"nav-right":!1,"nav-up":!1,"object-fit":!1,"object-position":!1,opacity:!1,order:!1,orphans:!1,outline:!1,"outline-color":!1,"outline-offset":!1,"outline-style":!1,"outline-width":!1,overflow:!1,"overflow-wrap":!1,"overflow-x":!1,"overflow-y":!1,padding:!0,"padding-bottom":!0,"padding-left":!0,"padding-right":!0,"padding-top":!0,page:!1,"page-break-after":!1,"page-break-before":!1,"page-break-inside":!1,"page-policy":!1,pause:!1,"pause-after":!1,"pause-before":!1,perspective:!1,"perspective-origin":!1,pitch:!1,"pitch-range":!1,"play-during":!1,position:!1,"presentation-level":!1,quotes:!1,"region-fragment":!1,resize:!1,rest:!1,"rest-after":!1,"rest-before":!1,richness:!1,right:!1,rotation:!1,"rotation-point":!1,"ruby-align":!1,"ruby-merge":!1,"ruby-position":!1,"shape-image-threshold":!1,"shape-outside":!1,"shape-margin":!1,size:!1,speak:!1,"speak-as":!1,"speak-header":!1,"speak-numeral":!1,"speak-punctuation":!1,"speech-rate":!1,stress:!1,"string-set":!1,"tab-size":!1,"table-layout":!1,"text-align":!0,"text-align-last":!0,"text-combine-upright":!0,"text-decoration":!0,"text-decoration-color":!0,"text-decoration-line":!0,"text-decoration-skip":!0,"text-decoration-style":!0,"text-emphasis":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-height":!0,"text-indent":!0,"text-justify":!0,"text-orientation":!0,"text-overflow":!0,"text-shadow":!0,"text-space-collapse":!0,"text-transform":!0,"text-underline-position":!0,"text-wrap":!0,top:!1,transform:!1,"transform-origin":!1,"transform-style":!1,transition:!1,"transition-delay":!1,"transition-duration":!1,"transition-property":!1,"transition-timing-function":!1,"unicode-bidi":!1,"vertical-align":!1,visibility:!1,"voice-balance":!1,"voice-duration":!1,"voice-family":!1,"voice-pitch":!1,"voice-range":!1,"voice-rate":!1,"voice-stress":!1,"voice-volume":!1,volume:!1,"white-space":!1,widows:!1,width:!0,"will-change":!1,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"wrap-flow":!1,"wrap-through":!1,"writing-mode":!1,"z-index":!1}}var hn=/javascript\s*\:/gim;cn.whiteList={"align-content":!1,"align-items":!1,"align-self":!1,"alignment-adjust":!1,"alignment-baseline":!1,all:!1,"anchor-point":!1,animation:!1,"animation-delay":!1,"animation-direction":!1,"animation-duration":!1,"animation-fill-mode":!1,"animation-iteration-count":!1,"animation-name":!1,"animation-play-state":!1,"animation-timing-function":!1,azimuth:!1,"backface-visibility":!1,background:!0,"background-attachment":!0,"background-clip":!0,"background-color":!0,"background-image":!0,"background-origin":!0,"background-position":!0,"background-repeat":!0,"background-size":!0,"baseline-shift":!1,binding:!1,bleed:!1,"bookmark-label":!1,"bookmark-level":!1,"bookmark-state":!1,border:!0,"border-bottom":!0,"border-bottom-color":!0,"border-bottom-left-radius":!0,"border-bottom-right-radius":!0,"border-bottom-style":!0,"border-bottom-width":!0,"border-collapse":!0,"border-color":!0,"border-image":!0,"border-image-outset":!0,"border-image-repeat":!0,"border-image-slice":!0,"border-image-source":!0,"border-image-width":!0,"border-left":!0,"border-left-color":!0,"border-left-style":!0,"border-left-width":!0,"border-radius":!0,"border-right":!0,"border-right-color":!0,"border-right-style":!0,"border-right-width":!0,"border-spacing":!0,"border-style":!0,"border-top":!0,"border-top-color":!0,"border-top-left-radius":!0,"border-top-right-radius":!0,"border-top-style":!0,"border-top-width":!0,"border-width":!0,bottom:!1,"box-decoration-break":!0,"box-shadow":!0,"box-sizing":!0,"box-snap":!0,"box-suppress":!0,"break-after":!0,"break-before":!0,"break-inside":!0,"caption-side":!1,chains:!1,clear:!0,clip:!1,"clip-path":!1,"clip-rule":!1,color:!0,"color-interpolation-filters":!0,"column-count":!1,"column-fill":!1,"column-gap":!1,"column-rule":!1,"column-rule-color":!1,"column-rule-style":!1,"column-rule-width":!1,"column-span":!1,"column-width":!1,columns:!1,contain:!1,content:!1,"counter-increment":!1,"counter-reset":!1,"counter-set":!1,crop:!1,cue:!1,"cue-after":!1,"cue-before":!1,cursor:!1,direction:!1,display:!0,"display-inside":!0,"display-list":!0,"display-outside":!0,"dominant-baseline":!1,elevation:!1,"empty-cells":!1,filter:!1,flex:!1,"flex-basis":!1,"flex-direction":!1,"flex-flow":!1,"flex-grow":!1,"flex-shrink":!1,"flex-wrap":!1,float:!1,"float-offset":!1,"flood-color":!1,"flood-opacity":!1,"flow-from":!1,"flow-into":!1,font:!0,"font-family":!0,"font-feature-settings":!0,"font-kerning":!0,"font-language-override":!0,"font-size":!0,"font-size-adjust":!0,"font-stretch":!0,"font-style":!0,"font-synthesis":!0,"font-variant":!0,"font-variant-alternates":!0,"font-variant-caps":!0,"font-variant-east-asian":!0,"font-variant-ligatures":!0,"font-variant-numeric":!0,"font-variant-position":!0,"font-weight":!0,grid:!1,"grid-area":!1,"grid-auto-columns":!1,"grid-auto-flow":!1,"grid-auto-rows":!1,"grid-column":!1,"grid-column-end":!1,"grid-column-start":!1,"grid-row":!1,"grid-row-end":!1,"grid-row-start":!1,"grid-template":!1,"grid-template-areas":!1,"grid-template-columns":!1,"grid-template-rows":!1,"hanging-punctuation":!1,height:!0,hyphens:!1,icon:!1,"image-orientation":!1,"image-resolution":!1,"ime-mode":!1,"initial-letters":!1,"inline-box-align":!1,"justify-content":!1,"justify-items":!1,"justify-self":!1,left:!1,"letter-spacing":!0,"lighting-color":!0,"line-box-contain":!1,"line-break":!1,"line-grid":!1,"line-height":!1,"line-snap":!1,"line-stacking":!1,"line-stacking-ruby":!1,"line-stacking-shift":!1,"line-stacking-strategy":!1,"list-style":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,margin:!0,"margin-bottom":!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"marker-offset":!1,"marker-side":!1,marks:!1,mask:!1,"mask-box":!1,"mask-box-outset":!1,"mask-box-repeat":!1,"mask-box-slice":!1,"mask-box-source":!1,"mask-box-width":!1,"mask-clip":!1,"mask-image":!1,"mask-origin":!1,"mask-position":!1,"mask-repeat":!1,"mask-size":!1,"mask-source-type":!1,"mask-type":!1,"max-height":!0,"max-lines":!1,"max-width":!0,"min-height":!0,"min-width":!0,"move-to":!1,"nav-down":!1,"nav-index":!1,"nav-left":!1,"nav-right":!1,"nav-up":!1,"object-fit":!1,"object-position":!1,opacity:!1,order:!1,orphans:!1,outline:!1,"outline-color":!1,"outline-offset":!1,"outline-style":!1,"outline-width":!1,overflow:!1,"overflow-wrap":!1,"overflow-x":!1,"overflow-y":!1,padding:!0,"padding-bottom":!0,"padding-left":!0,"padding-right":!0,"padding-top":!0,page:!1,"page-break-after":!1,"page-break-before":!1,"page-break-inside":!1,"page-policy":!1,pause:!1,"pause-after":!1,"pause-before":!1,perspective:!1,"perspective-origin":!1,pitch:!1,"pitch-range":!1,"play-during":!1,position:!1,"presentation-level":!1,quotes:!1,"region-fragment":!1,resize:!1,rest:!1,"rest-after":!1,"rest-before":!1,richness:!1,right:!1,rotation:!1,"rotation-point":!1,"ruby-align":!1,"ruby-merge":!1,"ruby-position":!1,"shape-image-threshold":!1,"shape-outside":!1,"shape-margin":!1,size:!1,speak:!1,"speak-as":!1,"speak-header":!1,"speak-numeral":!1,"speak-punctuation":!1,"speech-rate":!1,stress:!1,"string-set":!1,"tab-size":!1,"table-layout":!1,"text-align":!0,"text-align-last":!0,"text-combine-upright":!0,"text-decoration":!0,"text-decoration-color":!0,"text-decoration-line":!0,"text-decoration-skip":!0,"text-decoration-style":!0,"text-emphasis":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-height":!0,"text-indent":!0,"text-justify":!0,"text-orientation":!0,"text-overflow":!0,"text-shadow":!0,"text-space-collapse":!0,"text-transform":!0,"text-underline-position":!0,"text-wrap":!0,top:!1,transform:!1,"transform-origin":!1,"transform-style":!1,transition:!1,"transition-delay":!1,"transition-duration":!1,"transition-property":!1,"transition-timing-function":!1,"unicode-bidi":!1,"vertical-align":!1,visibility:!1,"voice-balance":!1,"voice-duration":!1,"voice-family":!1,"voice-pitch":!1,"voice-range":!1,"voice-rate":!1,"voice-stress":!1,"voice-volume":!1,volume:!1,"white-space":!1,widows:!1,width:!0,"will-change":!1,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"wrap-flow":!1,"wrap-through":!1,"writing-mode":!1,"z-index":!1},cn.getDefaultWhiteList=ln,cn.onAttr=function(){},cn.onIgnoreAttr=function(){},cn.safeAttrValue=function(t,e){return hn.test(e)?"":e};var fn={indexOf:function(t,e){var i,n;if(Array.prototype.indexOf)return t.indexOf(e);for(i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},forEach:function(t,e,i){var n,r;if(Array.prototype.forEach)return t.forEach(e,i);for(n=0,r=t.length;n<r;n++)e.call(i,t[n],n,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(t){return String.prototype.trimRight?t.trimRight():t.replace(/(\s*$)/g,"")}},dn=fn,pn=cn,gn=function(t,e){";"!==(t=dn.trimRight(t))[t.length-1]&&(t+=";");var i=t.length,n=!1,r=0,s=0,o="";function a(){if(!n){var i=dn.trim(t.slice(r,s)),a=i.indexOf(":");if(-1!==a){var u=dn.trim(i.slice(0,a)),c=dn.trim(i.slice(a+1));if(u){var l=e(r,o.length,u,c,i);l&&(o+=l+"; ")}}}r=s+1}for(;s<i;s++){var u=t[s];if("/"===u&&"*"===t[s+1]){var c=t.indexOf("*/",s+2);if(-1===c)break;r=(s=c+1)+1,n=!1}else"("===u?n=!0:")"===u?n=!1:";"===u?n||a():"\n"===u&&a()}return dn.trim(o)};function vn(t){return null==t}function mn(t){t=function(t){var e={};for(var i in t)e[i]=t[i];return e}(t||{}),t.whiteList=t.whiteList||pn.whiteList,t.onAttr=t.onAttr||pn.onAttr,t.onIgnoreAttr=t.onIgnoreAttr||pn.onIgnoreAttr,t.safeAttrValue=t.safeAttrValue||pn.safeAttrValue,this.options=t}mn.prototype.process=function(t){if(!(t=(t=t||"").toString()))return"";var e=this.options,i=e.whiteList,n=e.onAttr,r=e.onIgnoreAttr,s=e.safeAttrValue;return gn(t,(function(t,e,o,a,u){var c=i[o],l=!1;if(!0===c?l=c:"function"==typeof c?l=c(a):c instanceof RegExp&&(l=c.test(a)),!0!==l&&(l=!1),a=s(o,a)){var h,f={position:e,sourcePosition:t,source:u,isWhite:l};return l?vn(h=n(o,a,f))?o+":"+a:h:vn(h=r(o,a,f))?void 0:h}}))};var yn=mn;!function(t,e){var i=cn,n=yn;for(var r in(e=t.exports=function(t,e){return new n(e).process(t)}).FilterCSS=n,i)e[r]=i[r]}(un,un.exports);var wn={indexOf:function(t,e){var i,n;if(Array.prototype.indexOf)return t.indexOf(e);for(i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},forEach:function(t,e,i){var n,r;if(Array.prototype.forEach)return t.forEach(e,i);for(n=0,r=t.length;n<r;n++)e.call(i,t[n],n,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(t){var e=/\s|\n|\t/.exec(t);return e?e.index:-1}},bn=un.exports.getDefaultWhiteList,kn=wn;var xn=new(0,un.exports.FilterCSS);function An(t){return t.replace(Sn,"&lt;").replace(jn,"&gt;")}var Sn=/</g,jn=/>/g,On=/"/g,_n=/&quot;/g,In=/&#([a-zA-Z0-9]*);?/gim,Tn=/&colon;?/gim,En=/&newline;?/gim,Nn=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,$n=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,Un=/u\s*r\s*l\s*\(.*/gi;function Pn(t){return t.replace(On,"&quot;")}function Cn(t){return t.replace(_n,'"')}function Dn(t){return t.replace(In,(function(t,e){return String.fromCharCode("x"===e[0]||"X"===e[0]?parseInt(e.substr(1),16):parseInt(e,10))}))}function zn(t){return t.replace(Tn,":").replace(En," ")}function Rn(t){for(var e="",i=0,n=t.length;i<n;i++)e+=t.charCodeAt(i)<32?" ":t.charAt(i);return kn.trim(e)}function Mn(t){return Rn(t=zn(t=Dn(t=Cn(t))))}function Fn(t){return An(t=Pn(t))}an.whiteList={a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]},an.getDefaultWhiteList=function(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}},an.onTag=function(){},an.onIgnoreTag=function(){},an.onTagAttr=function(){},an.onIgnoreTagAttr=function(){},an.safeAttrValue=function(t,e,i,n){if(i=Mn(i),"href"===e||"src"===e){if("#"===(i=kn.trim(i)))return"#";if("http://"!==i.substr(0,7)&&"https://"!==i.substr(0,8)&&"mailto:"!==i.substr(0,7)&&"tel:"!==i.substr(0,4)&&"data:image/"!==i.substr(0,11)&&"ftp://"!==i.substr(0,6)&&"./"!==i.substr(0,2)&&"../"!==i.substr(0,3)&&"#"!==i[0]&&"/"!==i[0])return""}else if("background"===e){if(Nn.lastIndex=0,Nn.test(i))return""}else if("style"===e){if($n.lastIndex=0,$n.test(i))return"";if(Un.lastIndex=0,Un.test(i)&&(Nn.lastIndex=0,Nn.test(i)))return"";!1!==n&&(i=(n=n||xn).process(i))}return Fn(i)},an.escapeHtml=An,an.escapeQuote=Pn,an.unescapeQuote=Cn,an.escapeHtmlEntities=Dn,an.escapeDangerHtml5Entities=zn,an.clearNonPrintableCharacter=Rn,an.friendlyAttrValue=Mn,an.escapeAttrValue=Fn,an.onIgnoreTagStripAll=function(){return""},an.StripTagBody=function(t,e){"function"!=typeof e&&(e=function(){});var i=!Array.isArray(t),n=[],r=!1;return{onIgnoreTag:function(s,o,a){if(function(e){return!!i||-1!==kn.indexOf(t,e)}(s)){if(a.isClosing){var u="[/removed]";return n.push([!1!==r?r:a.position,a.position+u.length]),r=!1,u}return r||(r=a.position),"[removed]"}return e(s,o,a)},remove:function(t){var e="",i=0;return kn.forEach(n,(function(n){e+=t.slice(i,n[0]),i=n[1]})),e+=t.slice(i)}}},an.stripCommentTag=function(t){for(var e="",i=0;i<t.length;){var n=t.indexOf("\x3c!--",i);if(-1===n){e+=t.slice(i);break}e+=t.slice(i,n);var r=t.indexOf("--\x3e",n);if(-1===r)break;i=r+3}return e},an.stripBlankChar=function(t){var e=t.split("");return(e=e.filter((function(t){var e=t.charCodeAt(0);return!(127===e||e<=31&&10!==e&&13!==e)}))).join("")},an.cssFilter=xn,an.getDefaultCSSWhiteList=bn;var qn={},Ln=wn;function Bn(t){var e,i=Ln.spaceIndex(t);return e=t.slice(1,-1===i?-1:i+1),"/"===(e=Ln.trim(e).toLowerCase()).slice(0,1)&&(e=e.slice(1)),"/"===e.slice(-1)&&(e=e.slice(0,-1)),e}function Gn(t){return"</"===t.slice(0,2)}var Jn=/[^a-zA-Z0-9\\_:.-]/gim;function Hn(t,e){for(;e<t.length;e++){var i=t[e];if(" "!==i)return"="===i?e:-1}}function Vn(t,e){for(;e<t.length;e++){var i=t[e];if(" "!==i)return"'"===i||'"'===i?e:-1}}function Wn(t,e){for(;e>0;e--){var i=t[e];if(" "!==i)return"="===i?e:-1}}function Yn(t){return function(t){return'"'===t[0]&&'"'===t[t.length-1]||"'"===t[0]&&"'"===t[t.length-1]}(t)?t.substr(1,t.length-2):t}qn.parseTag=function(t,e,i){var n="",r=0,s=!1,o=!1,a=0,u=t.length,c="",l="";t:for(a=0;a<u;a++){var h=t.charAt(a);if(!1===s){if("<"===h){s=a;continue}}else if(!1===o){if("<"===h){n+=i(t.slice(r,a)),s=a,r=a;continue}if(">"===h){n+=i(t.slice(r,s)),c=Bn(l=t.slice(s,a+1)),n+=e(s,n.length,c,l,Gn(l)),r=a+1,s=!1;continue}if('"'===h||"'"===h)for(var f=1,d=t.charAt(a-f);""===d.trim()||"="===d;){if("="===d){o=h;continue t}d=t.charAt(a-++f)}}else if(h===o){o=!1;continue}}return r<t.length&&(n+=i(t.substr(r))),n},qn.parseAttr=function(t,e){var i=0,n=0,r=[],s=!1,o=t.length;function a(t,i){if(!((t=(t=Ln.trim(t)).replace(Jn,"").toLowerCase()).length<1)){var n=e(t,i||"");n&&r.push(n)}}for(var u=0;u<o;u++){var c,l=t.charAt(u);if(!1!==s||"="!==l)if(!1===s||u!==n){if(/\s|\n|\t/.test(l)){if(t=t.replace(/\s|\n|\t/g," "),!1===s){if(-1===(c=Hn(t,u))){a(Ln.trim(t.slice(i,u))),s=!1,i=u+1;continue}u=c-1;continue}if(-1===(c=Wn(t,u-1))){a(s,Yn(Ln.trim(t.slice(i,u)))),s=!1,i=u+1;continue}}}else{if(-1===(c=t.indexOf(l,u+1)))break;a(s,Ln.trim(t.slice(n+1,c))),s=!1,i=(u=c)+1}else s=t.slice(i,u),n='"'===t.charAt(i=u+1)||"'"===t.charAt(i)?i:Vn(t,u+1)}return i<t.length&&(!1===s?a(t.slice(i)):a(s,Yn(Ln.trim(t.slice(i))))),Ln.trim(r.join(" "))};var Xn=un.exports.FilterCSS,Zn=an,Kn=qn.parseTag,Qn=qn.parseAttr,tr=wn;function er(t){return null==t}function ir(t){t=function(t){var e={};for(var i in t)e[i]=t[i];return e}(t||{}),t.stripIgnoreTag&&(t.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),t.onIgnoreTag=Zn.onIgnoreTagStripAll),t.whiteList=t.whiteList||t.allowList?function(t){var e={};for(var i in t)Array.isArray(t[i])?e[i.toLowerCase()]=t[i].map((function(t){return t.toLowerCase()})):e[i.toLowerCase()]=t[i];return e}(t.whiteList||t.allowList):Zn.whiteList,t.onTag=t.onTag||Zn.onTag,t.onTagAttr=t.onTagAttr||Zn.onTagAttr,t.onIgnoreTag=t.onIgnoreTag||Zn.onIgnoreTag,t.onIgnoreTagAttr=t.onIgnoreTagAttr||Zn.onIgnoreTagAttr,t.safeAttrValue=t.safeAttrValue||Zn.safeAttrValue,t.escapeHtml=t.escapeHtml||Zn.escapeHtml,this.options=t,!1===t.css?this.cssFilter=!1:(t.css=t.css||{},this.cssFilter=new Xn(t.css))}ir.prototype.process=function(t){if(!(t=(t=t||"").toString()))return"";var e=this.options,i=e.whiteList,n=e.onTag,r=e.onIgnoreTag,s=e.onTagAttr,o=e.onIgnoreTagAttr,a=e.safeAttrValue,u=e.escapeHtml,c=this.cssFilter;e.stripBlankChar&&(t=Zn.stripBlankChar(t)),e.allowCommentTag||(t=Zn.stripCommentTag(t));var l=!1;e.stripIgnoreTagBody&&(l=Zn.StripTagBody(e.stripIgnoreTagBody,r),r=l.onIgnoreTag);var h=Kn(t,(function(t,e,l,h,f){var d={sourcePosition:t,position:e,isClosing:f,isWhite:Object.prototype.hasOwnProperty.call(i,l)},p=n(l,h,d);if(!er(p))return p;if(d.isWhite){if(d.isClosing)return"</"+l+">";var g=function(t){var e=tr.spaceIndex(t);if(-1===e)return{html:"",closing:"/"===t[t.length-2]};var i="/"===(t=tr.trim(t.slice(e+1,-1)))[t.length-1];return i&&(t=tr.trim(t.slice(0,-1))),{html:t,closing:i}}(h),v=i[l],m=Qn(g.html,(function(t,e){var i=-1!==tr.indexOf(v,t),n=s(l,t,e,i);return er(n)?i?(e=a(l,t,e,c))?t+'="'+e+'"':t:er(n=o(l,t,e,i))?void 0:n:n}));return h="<"+l,m&&(h+=" "+m),g.closing&&(h+=" /"),h+">"}return er(p=r(l,h,d))?u(h):p}),u);return l&&(h=l.remove(h)),h};var nr=ir;!function(t,e){var i=an,n=qn,r=nr;function s(t,e){return new r(e).process(t)}(e=t.exports=s).filterXSS=s,e.FilterXSS=r,function(){for(var t in i)e[t]=i[t];for(var r in n)e[r]=n[r]}(),"undefined"!=typeof self&&"undefined"!=typeof DedicatedWorkerGlobalScope&&self instanceof DedicatedWorkerGlobalScope&&(self.filterXSS=t.exports)}(on,on.exports);var rr=function(){function t(t,e){var i,n=this;this.arcgisWhiteList={a:["href","style","target"],abbr:["title"],audio:["autoplay","controls","loop","muted","preload"],b:[],br:[],dd:["style"],div:["align","style"],dl:["style"],dt:["style"],em:[],figcaption:["style"],figure:["style"],font:["color","face","size","style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],hr:[],i:[],img:["alt","border","height","src","style","width"],li:[],ol:[],p:["style"],source:["media","src","type"],span:["style"],strong:[],sub:["style"],sup:["style"],table:["border","cellpadding","cellspacing","height","style","width"],tbody:[],tr:["align","height","style","valign"],td:["align","colspan","height","nowrap","rowspan","style","valign","width"],th:["align","colspan","height","nowrap","rowspan","style","valign","width"],u:[],ul:[],video:["autoplay","controls","height","loop","muted","poster","preload","width"]},this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","arcgis-quickcapture","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"],this.arcgisFilterOptions={allowCommentTag:!0,safeAttrValue:function(t,e,i,r){return"a"===t&&"href"===e||("img"===t||"source"===t)&&"src"===e?n.sanitizeUrl(i):on.exports.safeAttrValue(t,e,i,r)}},this._entityMap={"&":"&#x38;","<":"&#x3C;",">":"&#x3E;",'"':"&#x22;","'":"&#x27;","/":"&#x2F;"},t&&!e?i=t:t&&e?(i=Object.create(this.arcgisFilterOptions),Object.keys(t).forEach((function(e){"whiteList"===e?i.whiteList=n._extendObjectOfArrays([n.arcgisWhiteList,t.whiteList||{}]):i[e]=t[e]}))):(i=Object.create(this.arcgisFilterOptions)).whiteList=this.arcgisWhiteList,this.xssFilterOptions=i,this._xssFilter=new on.exports.FilterXSS(i)}return t.prototype.sanitize=function(t,e){switch(void 0===e&&(e={}),typeof t){case"number":return isNaN(t)||!isFinite(t)?null:t;case"boolean":return t;case"string":return this._xssFilter.process(t);case"object":return this._iterateOverObject(t,e);default:if(e.allowUndefined&&void 0===t)return;return null}},t.prototype.sanitizeUrl=function(t,e){var i=(null!=e?e:{}).isProtocolRequired,n=void 0===i||i,r=this._trim(t.substring(0,t.indexOf(":"))),s="/"===t,o=/^#/.test(t),a=r&&this.allowedProtocols.indexOf(r.toLowerCase())>-1;return s||o||a?on.exports.escapeAttrValue(t):r||n?"":on.exports.escapeAttrValue("https://".concat(t))},t.prototype.sanitizeHTMLAttribute=function(t,e,i,n){return"function"==typeof this.xssFilterOptions.safeAttrValue?this.xssFilterOptions.safeAttrValue(t,e,i,n):on.exports.safeAttrValue(t,e,i,n)},t.prototype.validate=function(t,e){void 0===e&&(e={});var i=this.sanitize(t,e);return{isValid:t===i,sanitized:i}},t.prototype.encodeHTML=function(t){var e=this;return String(t).replace(/[&<>"'\/]/g,(function(t){return e._entityMap[t]}))},t.prototype.encodeAttrValue=function(t){var e=/^[a-zA-Z0-9]$/;return String(t).replace(/[\x00-\xFF]/g,(function(i,n){return e.test(i)?i:"&#x".concat(Number(t.charCodeAt(n)).toString(16),";")}))},t.prototype._extendObjectOfArrays=function(t){var e={};return t.forEach((function(t){Object.keys(t).forEach((function(i){e[i]=Array.isArray(t[i])&&Array.isArray(e[i])?e[i].concat(t[i]):t[i]}))})),e},t.prototype._iterateOverObject=function(t,e){var i=this;void 0===e&&(e={});try{var n=!1,r=void 0;if(Array.isArray(t))r=t.reduce((function(t,r){var s=i.validate(r,e);return s.isValid?t.concat([r]):(n=!0,t.concat([s.sanitized]))}),[]);else{if(!function(t){if("object"!=typeof t||null===t)return!1;if("[object Object]"!==Object.prototype.toString.call(t))return!1;var e=Object.getPrototypeOf(t);if(null===e)return!0;for(;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}(t)){if(e.allowUndefined&&void 0===t)return;return null}r=Object.keys(t).reduce((function(r,s){var o=t[s],a=i.validate(o,e);return a.isValid?r[s]=o:(n=!0,r[s]=a.sanitized),r}),{})}return n?r:t}catch(t){return null}},t.prototype._trim=function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},t}();const sr=new Map;function or(){sr.clear()}function ar(t){sr.delete(t)}function ur(t){const e=Zt.acquire();for(let t=0;t<arguments.length;t++){const i=arguments[t],n=typeof i;if("string"===n)e.push(i);else if(Array.isArray(i))e.push.apply(e,i);else if("object"===n)for(const t in i)i[t]&&e.push(t)}const i=e.join(" ");return Zt.release(e),i}function cr(t){this[t.getAttribute("data-node-ref")]=t}n.getLogger("esri.widgets.support.widgetUtils"),(()=>{const t=new Map;new ResizeObserver((e=>{or();for(const i of e)t.get(i.target)?.(i)}))})();const lr=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup","animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"].reduce(((t,e)=>(t[e]=[],t)),{}),hr=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","d","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],fr=new rr({whiteList:lr,onTagAttr:(t,e,i)=>{const n=`${e}="${i}"`;if(hr.includes(e))return n},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0),dr="http://www.w3.org/",pr=`${dr}2000/svg`,gr=`${dr}1999/xlink`;let vr,mr=[],yr=(t,e)=>{let i={};return Object.keys(t).forEach((e=>{i[e]=t[e]})),e&&Object.keys(e).forEach((t=>{i[t]=e[t]})),i},wr=(t,e)=>t.vnodeSelector===e.vnodeSelector&&(t.properties&&e.properties?t.properties.key===e.properties.key&&t.properties.bind===e.properties.bind:!t.properties&&!e.properties),br=t=>{if("string"!=typeof t)throw new Error("Style values must be strings")},kr=(t,e,i)=>{if(""!==e.vnodeSelector)for(let n=i;n<t.length;n++)if(wr(t[n],e))return n;return-1},xr=(t,e,i,n)=>{let r=t[e];if(""===r.vnodeSelector)return;let s=r.properties;if(!(s?void 0===s.key?s.bind:s.key:void 0))for(let s=0;s<t.length;s++)if(s!==e&&wr(t[s],r))throw new Error(`${i.vnodeSelector} had a ${r.vnodeSelector} child ${"added"===n?n:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)},Ar=t=>{if(t.properties){let e=t.properties.enterAnimation;e&&e(t.domNode,t.properties)}},Sr=[],jr=!1,Or=t=>{(t.children||[]).forEach(Or),t.properties&&t.properties.afterRemoved&&t.properties.afterRemoved.apply(t.properties.bind||t.properties,[t.domNode])},_r=()=>{jr=!1,Sr.forEach(Or),Sr.length=0},Ir=t=>{Sr.push(t),jr||(jr=!0,"undefined"!=typeof window&&"requestIdleCallback"in window?window.requestIdleCallback(_r,{timeout:16}):setTimeout(_r,16))},Tr=t=>{let e=t.domNode;if(t.properties){let i=t.properties.exitAnimation;if(i){e.style.pointerEvents="none";let n=()=>{e.parentNode&&(e.parentNode.removeChild(e),Ir(t))};return void i(e,n,t.properties)}}e.parentNode&&(e.parentNode.removeChild(e),Ir(t))},Er=(t,e,i)=>{if(!e)return;let n=i.eventHandlerInterceptor,r=Object.keys(e),s=r.length;for(let o=0;o<s;o++){let s=r[o],a=e[s];if("className"===s)throw new Error('Property "className" is not supported, use "class".');if("class"===s)Ur(t,a,!0);else if("classes"===s){let e=Object.keys(a),i=e.length;for(let n=0;n<i;n++){let i=e[n];a[i]&&t.classList.add(i)}}else if("styles"===s){let e=Object.keys(a),n=e.length;for(let r=0;r<n;r++){let n=e[r],s=a[n];s&&(br(s),i.styleApplyer(t,n,s))}}else if("key"!==s&&null!=a){let r=typeof a;"function"===r?(0===s.lastIndexOf("on",0)&&(n&&(a=n(s,a,t,e)),"oninput"===s&&function(){let t=a;a=function(e){t.apply(this,[e]),e.target["oninput-value"]=e.target.value}}()),t[s]=a):i.namespace===pr?"href"===s?t.setAttributeNS(gr,s,a):t.setAttribute(s,a):"string"===r&&"value"!==s?"innerHTML"===s?t[s]=fr.sanitize(a):t.setAttribute(s,a):t[s]=a}}},Nr=(t,e,i)=>{((t,e,i)=>{if(e)for(let n of e)$r(n,t,void 0,i)})(t,e.children,i),e.text&&(t.textContent=e.text),Er(t,e.properties,i),e.properties&&e.properties.afterCreate&&e.properties.afterCreate.apply(e.properties.bind||e.properties,[t,i,e.vnodeSelector,e.properties,e.children])},$r=(t,e,i,n)=>{let r,s=0,o=t.vnodeSelector,a=e.ownerDocument;if(""===o)r=t.domNode=a.createTextNode(t.text),void 0!==i?e.insertBefore(r,i):e.appendChild(r);else{for(let u=0;u<=o.length;++u){let c=o.charAt(u);if(u===o.length||"."===c||"#"===c){let c=o.charAt(s-1),l=o.slice(s,u);"."===c?r.classList.add(l):"#"===c?r.id=l:("svg"===l&&(n=yr(n,{namespace:pr})),void 0!==n.namespace?r=t.domNode=a.createElementNS(n.namespace,l):(r=t.domNode=t.domNode||a.createElement(l),"input"===l&&t.properties&&void 0!==t.properties.type&&r.setAttribute("type",t.properties.type)),void 0!==i?e.insertBefore(r,i):r.parentNode!==e&&e.appendChild(r)),s=u+1}}Nr(r,t,n)}},Ur=(t,e,i)=>{e&&e.split(" ").forEach((e=>{e&&t.classList.toggle(e,i)}))};vr=(t,e,i)=>{let n=t.domNode,r=!1;if(t===e)return!1;let s=!1;if(""===e.vnodeSelector){if(e.text!==t.text){let t=n.ownerDocument.createTextNode(e.text);return n.parentNode.replaceChild(t,n),e.domNode=t,r=!0,r}e.domNode=n}else 0===e.vnodeSelector.lastIndexOf("svg",0)&&(i=yr(i,{namespace:pr})),t.text!==e.text&&(s=!0,void 0===e.text?n.removeChild(n.firstChild):n.textContent=e.text),e.domNode=n,s=((t,e,i,n,r)=>{if(i===n)return!1;let s,o=(i=i||mr).length,a=(n=n||mr).length,u=0,c=0,l=!1;for(;c<a;){let a=u<o?i[u]:void 0,h=n[c];if(void 0!==a&&wr(a,h))l=vr(a,h,r)||l,u++;else{let a=kr(i,h,u+1);if(a>=0){for(s=u;s<a;s++)Tr(i[s]),xr(i,s,t,"removed");l=vr(i[a],h,r)||l,u=a+1}else $r(h,e,u<o?i[u].domNode:void 0,r),Ar(h),xr(n,c,t,"added")}c++}if(o>u)for(s=u;s<o;s++)Tr(i[s]),xr(i,s,t,"removed");return l})(e,n,t.children,e.children,i)||s,s=((t,e,i,n)=>{if(!i)return;let r=!1,s=Object.keys(i),o=s.length;for(let a=0;a<o;a++){let o=s[a],u=i[o],c=e[o];if("class"===o)c!==u&&(Ur(t,c,!1),Ur(t,u,!0));else if("classes"===o){let e=t.classList,i=Object.keys(u),n=i.length;for(let t=0;t<n;t++){let n=i[t],s=!!u[n];s!==!!c[n]&&(r=!0,s?e.add(n):e.remove(n))}}else if("styles"===o){let e=Object.keys(u),i=e.length;for(let s=0;s<i;s++){let i=e[s],o=u[i];o!==c[i]&&(r=!0,o?(br(o),n.styleApplyer(t,i,o)):n.styleApplyer(t,i,""))}}else if(u||"string"!=typeof c||(u=""),"value"===o){let e=t[o];e!==u&&(t["oninput-value"]?e===t["oninput-value"]:u!==c)&&(t[o]=u,t["oninput-value"]=void 0),u!==c&&(r=!0)}else if(u!==c){let e=typeof u;"function"===e&&n.eventHandlerInterceptor||(n.namespace===pr?"href"===o?t.setAttributeNS(gr,o,u):t.setAttribute(o,u):"string"===e?"innerHTML"===o?t[o]=fr.sanitize(u):"role"===o&&""===u?t.removeAttribute(o):t.setAttribute(o,u):t[o]!==u&&(t[o]=u),r=!0)}}return r})(n,t.properties,e.properties,i)||s,e.properties&&e.properties.afterUpdate&&e.properties.afterUpdate.apply(e.properties.bind||e.properties,[n,i,e.vnodeSelector,e.properties,e.children]);return s&&e.properties&&e.properties.updateAnimation&&e.properties.updateAnimation(n,e.properties,t.properties),r};let Pr=(t,e)=>({getLastRender:()=>t,update:i=>{if(t.vnodeSelector!==i.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let n=t;t=i,vr(n,i,e)},domNode:t.domNode});const Cr={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,i)=>{"-"===e.charAt(0)?t.style.setProperty(e,i):t.style[e]=i}};let Dr=t=>yr(Cr,t),zr=(t,e,i)=>(i=Dr(i),$r(e,t,void 0,i),Pr(e,i)),Rr=(t,e,i)=>(i=Dr(i),$r(e,t.parentNode,t,i),Pr(e,i)),Mr=(t,e,i)=>(i=Dr(i),e.domNode=t,Nr(t,e,i),Pr(e,i)),Fr=(t,e,i)=>(i=Dr(i),$r(e,t.parentNode,t,i),t.parentNode.removeChild(t),Pr(e,i));const qr={handleInterceptedEvent:(t,e,i,n)=>(t.scheduleRender(),e.properties[`on${n.type}`].apply(e.properties.bind||i,[n]))},Lr={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,i)=>{t.style[e]=i}},Br=(t,e,i=!1)=>{let n=t;return e.forEach(((t,r)=>{const s=n?.children?((t,e)=>t.find(e))(n.children,(e=>e.domNode===t)):void 0;i&&!s&&r!==e.length-1||(n=s)})),n};
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.0-beta.97
 */
function Gr(){const{classList:t}=document.body,e=window.matchMedia("(prefers-color-scheme: dark)").matches,i=()=>t.contains("calcite-theme-dark")||t.contains("calcite-theme-auto")&&e?"dark":"light",n=t=>document.body.dispatchEvent(new CustomEvent("calciteThemeChange",{bubbles:!0,detail:{theme:t}})),r=t=>{s!==t&&n(t),s=t};let s=i();n(s),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(t=>r(t.matches?"dark":"light"))),new MutationObserver((()=>r(i()))).observe(document.body,{attributes:!0,attributeFilter:["class"]})}let Jr;"undefined"!=typeof window&&"undefined"!=typeof location&&"undefined"!=typeof document&&window.location===location&&window.document===document&&("interactive"===document.readyState?Gr():document.addEventListener("DOMContentLoaded",(()=>Gr()),{once:!0})),Jr="components/assets";const Hr=Symbol("widget"),Vr=[],Wr={},Yr=new WeakMap;function Xr(t,e){let i=e.children;if(i&&i.length)for(let e=0;e<i.length;++e)i[e]=Xr(t,i[e]);else i=Vr;const n=e.vnodeSelector;if(ts(n)){const r=e.properties||Wr,s=r.key||n;return{vnodeSelector:"div",properties:{key:s,afterCreate:Zr,afterUpdate:Kr,afterRemoved:Qr,parentWidget:t,widgetConstructor:n,widgetProperties:{...r,key:s,children:i}},children:void 0,text:void 0,domNode:null}}return e}function Zr(t,e,i,{parentWidget:n,widgetConstructor:r,widgetProperties:s}){const o=new r(s);o.container=t,Yr.set(t,o),o.afterCreate?.(o,t),n._internalHandles.add(et((()=>Qr(t))))}function Kr(t,e,i,{widgetProperties:n}){const r=Yr.get(t);r&&(r.set(n),r.afterUpdate?.(r,t))}function Qr(t){const e=Yr.get(t);e&&(e.destroy(),Yr.delete(t))}function ts(t){return"function"==typeof t&&t[Hr]}const es=new Set;let is=0;function ns(t,e){for(const i in e)null!=t[i]&&("object"==typeof t[i]&&"object"==typeof e[i]?ns(t[i],e?.[i]):t[i]=e[i]);return t}const rs=(t=>{let e;const i={...qr,...t},n=(t=>({...Lr,...t}))(i),r=n.performanceLogger;let s,o=!0,a=!1;const u=[],c=[],l=(t,s,o)=>{let a;n.eventHandlerInterceptor=()=>function(t){let n;r("domEvent",t);const s=((t,e)=>{const i=[];for(;t&&t!==e;)i.push(t),t=t.parentNode;return i})(t.currentTarget,a.domNode),o=s.some((t=>customElements.get(t?.tagName?.toLowerCase())));if(t.eventPhase!==Event.CAPTURING_PHASE&&o){const e=t.composedPath(),i=e.slice(e.indexOf(t.currentTarget),e.indexOf(a.domNode)).filter((t=>t.getRootNode()===t.ownerDocument)).reverse();n=Br(a.getLastRender(),i,!0)}else s.reverse(),n=Br(a.getLastRender(),s);let u;return n&&(u=i.handleInterceptedEvent(e,n,this,t)),r("domEventProcessed",t),u},i.postProcessProjectionOptions?.(n);const l=o();a=t(s,l,n),u.push(a),c.push(o),i.afterFirstVNodeRendered&&i.afterFirstVNodeRendered(a,l)};let h=()=>{if(s=void 0,o){o=!1,r("renderStart",void 0);for(let t=0;t<u.length;t++){const e=c[t]();r("rendered",void 0),u[t].update(e),r("patched",void 0)}r("renderDone",void 0),o=!0}};return i.modifyDoRenderImplementation&&(h=i.modifyDoRenderImplementation(h,u,c)),e={renderNow:h,scheduleRender:()=>{s||a||(s=requestAnimationFrame(h))},stop:()=>{s&&(cancelAnimationFrame(s),s=void 0),a=!0},resume:()=>{a=!1,o=!0,e.scheduleRender()},append:(t,e)=>{l(zr,t,e)},insertBefore:(t,e)=>{l(Rr,t,e)},merge:(t,e)=>{l(Mr,t,e)},replace:(t,e)=>{l(Fr,t,e)},detach:t=>{for(let e=0;e<c.length;e++)if(c[e]===t)return c.splice(e,1),u.splice(e,1)[0];throw new Error("renderFunction was not found")}},e})({postProcessProjectionOptions(t){const e=t.eventHandlerInterceptor,i=/capture$/i;t.eventHandlerInterceptor=(t,n,r,s)=>{const o=e?.(t,n,r,s),a=i.test(t);if(!((t=t.replace(i,"")).toLowerCase()in r)||a){const e=t[2].toLowerCase()+t.slice(3),i=t=>o?.call(r,t);r.addEventListener(e,i,a);const n=()=>r.removeEventListener(e,i,a),u=s.afterRemoved;s.afterRemoved=t=>{u?.(t),n()}}return o}},handleInterceptedEvent(t,e,i,n){const{eventPhase:r,type:s}=n,o=r===Event.CAPTURING_PHASE;let a=`on${s}${o?"capture":""}`;const u=e.properties;(u&&a in u||(a=`on${s[0].toUpperCase()}${s.slice(1)}${o?"Capture":""}`,u&&a in u))&&(or(),t.scheduleRender(),u[a].call(u.bind||i,n))}});let ss=!1,os=class extends(Qi(Gi.EventedAccessor)){constructor(t,e){super(t,e),this._attached=!1,this._internalHandles=new Q,this._projector=rs,this._readyForTrueRender=!1,this.iconClass="esri-icon-checkbox-unchecked",this.key=this,this._loadLocale=A((async()=>{if(this._messageBundleProps&&this._messageBundleProps.length){const t=await O(this._messageBundleProps.map((async({bundlePath:t,propertyName:e})=>{let n=await _(t);this.uiStrings&&Object.keys(this.uiStrings)&&(n=ns(i(n),this.uiStrings)),this[e]=n})));for(const e of t)e.error&&n.getLogger(this.declaredClass).error("widget-intl:locale-error",this.declaredClass,e.error)}await this.loadLocale()})),k(x("components/assets"));const r="esri-widget-uid-"+function(){if(en)return crypto.randomUUID();const t=crypto.getRandomValues(new Uint16Array(8));t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;const e=e=>t[e].toString(16).padStart(4,"0");return e(0)+e(1)+"-"+e(2)+"-"+e(3)+"-"+e(4)+"-"+e(5)+e(6)+e(7)}(),s=this.render.bind(this);this._trackingTarget=new we((()=>this.scheduleRender()));const o=()=>{if(!this._readyForTrueRender||this.destroyed)return null;if(!this.visible)return{vnodeSelector:"div",properties:{key:r,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0};const t=s();let{properties:e}=t;e||(t.properties=e={});let{key:i,styles:n}=e;i||(e.key=r),n||(e.styles=n={}),n.display||(n.display="");let o=0;return t.children?.forEach((t=>{if(ts(t.vnodeSelector))return;let{properties:e}=t;e||(t.properties=e={}),e.key||(e.key=`${this.id}--${o++}`)})),Xr(this,t)};this.render=()=>{if(ss)return o();let t=function(t){return sr.get(t)}(this)??null;if(t)return t;this._trackingTarget.clear(),ss=!0;try{t=Ut(this._trackingTarget,o)}catch(t){throw console.error(t),t}finally{ss=!1}return t&&function(t,e){sr.set(t,e)}(this,t),t},this.addResolvingPromise(this._resourcesFetch=this.beforeFirstRender().then((()=>{this._readyForTrueRender=!0,this._postInitialize()}))),function(t){es.add(t),t.finally((()=>es.delete(t)))}(this._resourcesFetch)}normalizeCtorArgs(t,e){const i={...t};return e&&(i.container=e),i}postInitialize(){}beforeFirstRender(){return Promise.all([this.loadDependencies(),this._loadLocale()]).then((()=>{})).catch(S)}async loadDependencies(){}async loadLocale(){}destroy(){this.destroyed||(g(this._trackingTarget),g(this.viewModel),this._detach(this.container),this._set("container",null),this._internalHandles.destroy(),this._emitter.clear(),this.render=()=>null,this._projector=null,ar(this))}set container(t){this._get("container")||this._set("container",t)}castContainer(t){return function(t){return"string"==typeof t?document.getElementById(t):t??null}(t)}get domNode(){return this.container}set domNode(t){this.container=t}get id(){return this._get("id")||this.get("container.id")||Date.now().toString(16)+"-widget-"+is++}set id(t){t&&this._set("id",t)}get label(){return this.declaredClass.split(".").pop()}set label(t){this._overrideIfSome("label",t)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(t){this._set("visible",t)}get test(){return{projector:this._projector}}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||(ar(this),this._projector.scheduleRender())}classes(...t){return ur.apply(this,t)}renderNow(){ar(this),this._projector.renderNow()}_postInitialize(){if(this.destroyed)return;this.scheduleRender(),this._delegatedEventNames?.length&&this._internalHandles.add(Ji((()=>this.viewModel),((t,e)=>{e&&this._internalHandles.remove("delegated-events"),t&&I(t)&&this._internalHandles.add(this._delegatedEventNames.map((e=>T(t,e,(t=>{this.emit(e,t)})))),"delegated-events")}),Xi)),this.postInitialize();const t=async()=>{await this._loadLocale().catch(S),this.scheduleRender()};this._internalHandles.add([j(t),Ji((()=>this.uiStrings),t),Hi((()=>this.container),(t=>{this.destroyed||this._attach(t)}),{initial:!0,once:!0})])}_attach(t){t&&(this._projector.merge(t,this.render),this._attached=!0)}_detach(t){this._attached&&(this._projector.detach(this.render),this._attached=!1),t?.parentNode?.removeChild(t)}};os[Hr]=!0,Z([oi()],os.prototype,"_readyForTrueRender",void 0),Z([oi({value:null})],os.prototype,"container",null),Z([function(...t){if(3!==t.length||"string"!=typeof t[1])return 1===t.length&&"[object Function]"===nn.call(t[0])?rn(t[0]):1===t.length&&"string"==typeof t[0]?function(t){return(e,i)=>{vt(e,t).cast=e[i]}}(t[0]):void 0}("container")],os.prototype,"castContainer",null),Z([oi()],os.prototype,"domNode",null),Z([oi()],os.prototype,"iconClass",void 0),Z([oi()],os.prototype,"id",null),Z([oi()],os.prototype,"label",null),Z([oi()],os.prototype,"renderable",null),Z([oi()],os.prototype,"uiStrings",void 0),Z([oi()],os.prototype,"viewModel",void 0),Z([oi({value:!0})],os.prototype,"visible",null),Z([oi()],os.prototype,"key",void 0),Z([oi()],os.prototype,"children",void 0),Z([oi()],os.prototype,"afterCreate",void 0),Z([oi()],os.prototype,"afterUpdate",void 0),Z([oi()],os.prototype,"afterRemoved",void 0),os=Z([Ci("esri.widgets.Widget")],os);const as=os;function us(t){return(e,i)=>{e.hasOwnProperty("_messageBundleProps")||(e._messageBundleProps=e._messageBundleProps?e._messageBundleProps.slice():[]),e._messageBundleProps.push({bundlePath:t,propertyName:i})}}var cs=function(t){return{vnodeSelector:"",properties:void 0,children:void 0,text:t.toString(),domNode:null}},ls=function(t,e){for(var i=0,n=t.length;i<n;i++){var r=t[i];Array.isArray(r)?ls(r,e):null!=r&&!1!==r&&(r.hasOwnProperty("vnodeSelector")||(r=cs(r)),e.push(r))}},hs=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];if(1===i.length&&"string"==typeof i[0])return{vnodeSelector:t,properties:e||void 0,children:void 0,text:i[0],domNode:null};var r=[];return ls(i,r),{vnodeSelector:t,properties:e||void 0,children:r,text:void 0,domNode:null}};function fs(t,e,...i){return"function"!=typeof t||ts(t)?hs(t,e,...i):t(e,...i)}const ds="esri-identity-form__group",ps="esri-identity-form__label",gs="esri-input",vs="esri-button";let ms=class extends as{constructor(t,e){super(t,e),this._usernameInputNode=null,this._passwordInputNode=null,this.signingIn=!1,this.server=null,this.resource=null,this.error=null,this.oAuthPrompt=!1}render(){const{error:t,server:e,resource:i,signingIn:n,oAuthPrompt:r,messages:s}=this,o=fs("div",{class:ds},E(r?s.oAuthInfo:s.info,{server:e&&/\.arcgis\.com/i.test(e)?"ArcGIS Online":e,resource:`(${i||s.lblItem})`})),a=r?null:fs("div",{class:ds,key:"username"},fs("label",{class:ps},s.lblUser,fs("input",{value:"",required:!0,autocomplete:"off",spellcheck:!1,type:"text",bind:this,afterCreate:cr,"data-node-ref":"_usernameInputNode",class:gs}))),u=r?null:fs("div",{class:ds,key:"password"},fs("label",{class:ps},s.lblPwd,fs("input",{value:"",required:!0,type:"password",bind:this,afterCreate:cr,"data-node-ref":"_passwordInputNode",class:gs}))),c=fs("div",{class:this.classes(ds,"esri-identity-form__footer")},fs("input",{type:"submit",disabled:!!n,value:n?s.lblSigning:s.lblOk,class:vs}),fs("input",{type:"button",value:s.lblCancel,bind:this,onclick:this._cancel,class:this.classes(vs,"esri-button--secondary")})),l=t?fs("div",null,t.details&&t.details.httpStatus?s.invalidUser:s.noAuthService):null;return fs("form",{class:"esri-identity-form",bind:this,onsubmit:this._submit},o,l,a,u,c)}_cancel(){this._set("signingIn",!1),this._usernameInputNode&&(this._usernameInputNode.value=""),this._passwordInputNode&&(this._passwordInputNode.value=""),this.emit("cancel")}_submit(t){t.preventDefault(),this._set("signingIn",!0),this.emit("submit",this.oAuthPrompt?{}:{username:this._usernameInputNode&&this._usernameInputNode.value,password:this._passwordInputNode&&this._passwordInputNode.value})}};Z([oi(),us("esri/identity/t9n/identity")],ms.prototype,"messages",void 0),Z([oi()],ms.prototype,"signingIn",void 0),Z([oi()],ms.prototype,"server",void 0),Z([oi()],ms.prototype,"resource",void 0),Z([oi()],ms.prototype,"error",void 0),Z([oi()],ms.prototype,"oAuthPrompt",void 0),ms=Z([Ci("esri.identity.IdentityForm")],ms);const ys=ms;
/*!
* tabbable 6.0.1
* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
*/
var ws=["input","select","textarea","a[href]","button","[tabindex]:not(slot)","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])',"details>summary:first-of-type","details"],bs=ws.join(","),ks="undefined"==typeof Element,xs=ks?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,As=!ks&&Element.prototype.getRootNode?function(t){return t.getRootNode()}:function(t){return t.ownerDocument},Ss=function(t,e,i){var n=Array.prototype.slice.apply(t.querySelectorAll(bs));return e&&xs.call(t,bs)&&n.unshift(t),n.filter(i)},js=function t(e,i,n){for(var r=[],s=Array.from(e);s.length;){var o=s.shift();if("SLOT"===o.tagName){var a=o.assignedElements(),u=t(a.length?a:o.children,!0,n);n.flatten?r.push.apply(r,u):r.push({scopeParent:o,candidates:u})}else{xs.call(o,bs)&&n.filter(o)&&(i||!e.includes(o))&&r.push(o);var c=o.shadowRoot||"function"==typeof n.getShadowRoot&&n.getShadowRoot(o),l=!n.shadowRootFilter||n.shadowRootFilter(o);if(c&&l){var h=t(!0===c?o.children:c.children,!0,n);n.flatten?r.push.apply(r,h):r.push({scopeParent:o,candidates:h})}else s.unshift.apply(s,o.children)}}return r},Os=function(t,e){return t.tabIndex<0&&(e||/^(AUDIO|VIDEO|DETAILS)$/.test(t.tagName)||t.isContentEditable)&&isNaN(parseInt(t.getAttribute("tabindex"),10))?0:t.tabIndex},_s=function(t,e){return t.tabIndex===e.tabIndex?t.documentOrder-e.documentOrder:t.tabIndex-e.tabIndex},Is=function(t){return"INPUT"===t.tagName},Ts=function(t){var e=t.getBoundingClientRect();return 0===e.width&&0===e.height},Es=function(t,e){return!(e.disabled||function(t){return Is(t)&&"hidden"===t.type}(e)||function(t,e){var i=e.displayCheck,n=e.getShadowRoot;if("hidden"===getComputedStyle(t).visibility)return!0;var r=xs.call(t,"details>summary:first-of-type");if(xs.call(r?t.parentElement:t,"details:not([open]) *"))return!0;if(i&&"full"!==i&&"legacy-full"!==i){if("non-zero-area"===i)return Ts(t)}else{if("function"==typeof n){for(var s=t;t;){var o=t.parentElement,a=As(t);if(o&&!o.shadowRoot&&!0===n(o))return Ts(t);t=t.assignedSlot?t.assignedSlot:o||a===t.ownerDocument?o:a.host}t=s}if(function(t){for(var e,i=As(t).host,n=!!(null!==(e=i)&&void 0!==e&&e.ownerDocument.contains(i)||t.ownerDocument.contains(t));!n&&i;){var r;n=!(null===(r=i=As(i).host)||void 0===r||!r.ownerDocument.contains(i))}return n}(t))return!t.getClientRects().length;if("legacy-full"!==i)return!0}return!1}(e,t)||function(t){return"DETAILS"===t.tagName&&Array.prototype.slice.apply(t.children).some((function(t){return"SUMMARY"===t.tagName}))}(e)||function(t){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(t.tagName))for(var e=t.parentElement;e;){if("FIELDSET"===e.tagName&&e.disabled){for(var i=0;i<e.children.length;i++){var n=e.children.item(i);if("LEGEND"===n.tagName)return!!xs.call(e,"fieldset[disabled] *")||!n.contains(t)}return!0}e=e.parentElement}return!1}(e))},Ns=function(t,e){return!(function(t){return function(t){return Is(t)&&"radio"===t.type}(t)&&!function(t){if(!t.name)return!0;var e,i=t.form||As(t),n=function(t){return i.querySelectorAll('input[type="radio"][name="'+t+'"]')};if("undefined"!=typeof window&&void 0!==window.CSS&&"function"==typeof window.CSS.escape)e=n(window.CSS.escape(t.name));else try{e=n(t.name)}catch(t){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",t.message),!1}var r=function(t,e){for(var i=0;i<t.length;i++)if(t[i].checked&&t[i].form===e)return t[i]}(e,t.form);return!r||r===t}(t)}(e)||Os(e)<0||!Es(t,e))},$s=function(t){var e=parseInt(t.getAttribute("tabindex"),10);return!!(isNaN(e)||e>=0)},Us=function t(e){var i=[],n=[];return e.forEach((function(e,r){var s=!!e.scopeParent,o=s?e.scopeParent:e,a=Os(o,s),u=s?t(e.candidates):o;0===a?s?i.push.apply(i,u):i.push(o):n.push({documentOrder:r,tabIndex:a,item:e,isScope:s,content:u})})),n.sort(_s).reduce((function(t,e){return e.isScope?t.push.apply(t,e.content):t.push(e.content),t}),[]).concat(i)},Ps=function(t,e){var i;return i=(e=e||{}).getShadowRoot?js([t],e.includeContainer,{filter:Ns.bind(null,e),flatten:!1,getShadowRoot:e.getShadowRoot,shadowRootFilter:$s}):Ss(t,e.includeContainer,Ns.bind(null,e)),Us(i)},Cs=function(t,e){if(e=e||{},!t)throw new Error("No node provided");return!1!==xs.call(t,bs)&&Ns(e,t)},Ds=ws.concat("iframe").join(","),zs=function(t,e){if(e=e||{},!t)throw new Error("No node provided");return!1!==xs.call(t,Ds)&&Es(e,t)};
/*!
* focus-trap 7.0.0
* @license MIT, https://github.com/focus-trap/focus-trap/blob/master/LICENSE
*/
function Rs(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Ms(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Rs(Object(i),!0).forEach((function(e){Fs(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Rs(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function Fs(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var qs,Ls=(qs=[],{activateTrap:function(t){if(qs.length>0){var e=qs[qs.length-1];e!==t&&e.pause()}var i=qs.indexOf(t);-1===i||qs.splice(i,1),qs.push(t)},deactivateTrap:function(t){var e=qs.indexOf(t);-1!==e&&qs.splice(e,1),qs.length>0&&qs[qs.length-1].unpause()}}),Bs=function(t){return setTimeout(t,0)},Gs=function(t,e){var i=-1;return t.every((function(t,n){return!e(t)||(i=n,!1)})),i},Js=function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return"function"==typeof t?t.apply(void 0,i):t},Hs=function(t){return t.target.shadowRoot&&"function"==typeof t.composedPath?t.composedPath()[0]:t.target};const Vs="esri-identity-modal__content";let Ws=class extends as{constructor(t,e){super(t,e),this.container=document.createElement("div"),this.content=null,this.open=!1,this._focusTrap=null,this._close=()=>{this.open=!1},document.body.appendChild(this.container),this.addHandles(Ji((()=>this.open),(()=>this._toggleFocusTrap())))}destroy(){this._destroyFocusTrap()}get title(){return this.messages?.auth.signIn}render(){const t=this.id,{open:e,content:i,title:n,messages:r}=this,s=e&&!!i,o={"esri-identity-modal--open":s,"esri-identity-modal--closed":!s},a=fs("button",{class:"esri-identity-modal__close-button","aria-label":r.close,title:r.close,bind:this,onclick:this._close,type:"button"},fs("span",{"aria-hidden":"true",class:"esri-icon-close"})),u=`${t}_title`,c=`${t}_content`,l=n?fs("h1",{id:u,class:"esri-identity-modal__title"},n):null,h=s?fs("div",{bind:this,class:"esri-identity-modal__dialog",role:"dialog","aria-labelledby":u,"aria-describedby":c,afterCreate:this._createFocusTrap},a,l,this._renderContent(c)):null;return fs("div",{tabIndex:-1,class:this.classes("esri-identity-modal",o)},h)}_destroyFocusTrap(){this._focusTrap?.deactivate({onDeactivate:()=>{}}),this._focusTrap=null}_toggleFocusTrap(){const{_focusTrap:t,open:e}=this;t&&(e?t.activate():t.deactivate())}_createFocusTrap(t){this._destroyFocusTrap();const e=requestAnimationFrame((()=>{var e,i,n,r,s,o,a,u,c,l,h,f,d,p,g,v,m,y,w;this._focusTrap=(e=t,r=(null==(i={initialFocus:"input",onDeactivate:this._close})?void 0:i.document)||document,s=Ms({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0},i),o={containers:[],containerGroups:[],tabbableGroups:[],nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1,delayInitialFocusTimer:void 0},a=function(t,e,i){return t&&void 0!==t[e]?t[e]:s[i||e]},u=function(t){return o.containerGroups.findIndex((function(e){var i=e.tabbableNodes;return e.container.contains(t)||i.find((function(e){return e===t}))}))},c=function(t){var e=s[t];if("function"==typeof e){for(var i=arguments.length,n=new Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];e=e.apply(void 0,n)}if(!0===e&&(e=void 0),!e){if(void 0===e||!1===e)return e;throw new Error("`".concat(t,"` was specified but was not a node, or did not return a node"))}var a=e;if("string"==typeof e&&!(a=r.querySelector(e)))throw new Error("`".concat(t,"` as selector refers to no known node"));return a},l=function(){var t=c("initialFocus");if(!1===t)return!1;if(void 0===t)if(u(r.activeElement)>=0)t=r.activeElement;else{var e=o.tabbableGroups[0];t=e&&e.firstTabbableNode||c("fallbackFocus")}if(!t)throw new Error("Your focus-trap needs to have at least one focusable element");return t},h=function(){if(o.containerGroups=o.containers.map((function(t){var e,i,n=Ps(t,s.tabbableOptions),r=(e=t,(i=(i=s.tabbableOptions)||{}).getShadowRoot?js([e],i.includeContainer,{filter:Es.bind(null,i),flatten:!0,getShadowRoot:i.getShadowRoot}):Ss(e,i.includeContainer,Es.bind(null,i)));return{container:t,tabbableNodes:n,focusableNodes:r,firstTabbableNode:n.length>0?n[0]:null,lastTabbableNode:n.length>0?n[n.length-1]:null,nextTabbableNode:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=r.findIndex((function(e){return e===t}));if(!(i<0))return e?r.slice(i+1).find((function(t){return Cs(t,s.tabbableOptions)})):r.slice(0,i).reverse().find((function(t){return Cs(t,s.tabbableOptions)}))}}})),o.tabbableGroups=o.containerGroups.filter((function(t){return t.tabbableNodes.length>0})),o.tabbableGroups.length<=0&&!c("fallbackFocus"))throw new Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times")},f=function t(e){!1!==e&&e!==r.activeElement&&(e&&e.focus?(e.focus({preventScroll:!!s.preventScroll}),o.mostRecentlyFocusedNode=e,function(t){return t.tagName&&"input"===t.tagName.toLowerCase()&&"function"==typeof t.select}(e)&&e.select()):t(l()))},d=function(t){var e=c("setReturnFocus",t);return e||!1!==e&&t},p=function(t){var e=Hs(t);u(e)>=0||(Js(s.clickOutsideDeactivates,t)?n.deactivate({returnFocus:s.returnFocusOnDeactivate&&!zs(e,s.tabbableOptions)}):Js(s.allowOutsideClick,t)||t.preventDefault())},g=function(t){var e=Hs(t),i=u(e)>=0;i||e instanceof Document?i&&(o.mostRecentlyFocusedNode=e):(t.stopImmediatePropagation(),f(o.mostRecentlyFocusedNode||l()))},v=function(t){if(function(t){return"Escape"===t.key||"Esc"===t.key||27===t.keyCode}(t)&&!1!==Js(s.escapeDeactivates,t))return t.preventDefault(),void n.deactivate();(function(t){return"Tab"===t.key||9===t.keyCode})(t)&&function(t){var e=Hs(t);h();var i=null;if(o.tabbableGroups.length>0){var n=u(e),r=n>=0?o.containerGroups[n]:void 0;if(n<0)i=t.shiftKey?o.tabbableGroups[o.tabbableGroups.length-1].lastTabbableNode:o.tabbableGroups[0].firstTabbableNode;else if(t.shiftKey){var a=Gs(o.tabbableGroups,(function(t){return e===t.firstTabbableNode}));a<0&&(r.container===e||zs(e,s.tabbableOptions)&&!Cs(e,s.tabbableOptions)&&!r.nextTabbableNode(e,!1))&&(a=n),a>=0&&(i=o.tabbableGroups[0===a?o.tabbableGroups.length-1:a-1].lastTabbableNode)}else{var l=Gs(o.tabbableGroups,(function(t){return e===t.lastTabbableNode}));l<0&&(r.container===e||zs(e,s.tabbableOptions)&&!Cs(e,s.tabbableOptions)&&!r.nextTabbableNode(e))&&(l=n),l>=0&&(i=o.tabbableGroups[l===o.tabbableGroups.length-1?0:l+1].firstTabbableNode)}}else i=c("fallbackFocus");i&&(t.preventDefault(),f(i))}(t)},m=function(t){var e=Hs(t);u(e)>=0||Js(s.clickOutsideDeactivates,t)||Js(s.allowOutsideClick,t)||(t.preventDefault(),t.stopImmediatePropagation())},y=function(){if(o.active)return Ls.activateTrap(n),o.delayInitialFocusTimer=s.delayInitialFocus?Bs((function(){f(l())})):f(l()),r.addEventListener("focusin",g,!0),r.addEventListener("mousedown",p,{capture:!0,passive:!1}),r.addEventListener("touchstart",p,{capture:!0,passive:!1}),r.addEventListener("click",m,{capture:!0,passive:!1}),r.addEventListener("keydown",v,{capture:!0,passive:!1}),n},w=function(){if(o.active)return r.removeEventListener("focusin",g,!0),r.removeEventListener("mousedown",p,!0),r.removeEventListener("touchstart",p,!0),r.removeEventListener("click",m,!0),r.removeEventListener("keydown",v,!0),n},(n={get active(){return o.active},get paused(){return o.paused},activate:function(t){if(o.active)return this;var e=a(t,"onActivate"),i=a(t,"onPostActivate"),n=a(t,"checkCanFocusTrap");n||h(),o.active=!0,o.paused=!1,o.nodeFocusedBeforeActivation=r.activeElement,e&&e();var s=function(){n&&h(),y(),i&&i()};return n?(n(o.containers.concat()).then(s,s),this):(s(),this)},deactivate:function(t){if(!o.active)return this;var e=Ms({onDeactivate:s.onDeactivate,onPostDeactivate:s.onPostDeactivate,checkCanReturnFocus:s.checkCanReturnFocus},t);clearTimeout(o.delayInitialFocusTimer),o.delayInitialFocusTimer=void 0,w(),o.active=!1,o.paused=!1,Ls.deactivateTrap(n);var i=a(e,"onDeactivate"),r=a(e,"onPostDeactivate"),u=a(e,"checkCanReturnFocus"),c=a(e,"returnFocus","returnFocusOnDeactivate");i&&i();var l=function(){Bs((function(){c&&f(d(o.nodeFocusedBeforeActivation)),r&&r()}))};return c&&u?(u(d(o.nodeFocusedBeforeActivation)).then(l,l),this):(l(),this)},pause:function(){return o.paused||!o.active||(o.paused=!0,w()),this},unpause:function(){return o.paused&&o.active?(o.paused=!1,h(),y(),this):this},updateContainerElements:function(t){var e=[].concat(t).filter(Boolean);return o.containers=e.map((function(t){return"string"==typeof t?r.querySelector(t):t})),o.active&&h(),this}}).updateContainerElements(e),n),this._toggleFocusTrap()}));this.addHandles(et((()=>cancelAnimationFrame(e))))}_renderContent(t){const e=this.content;return"string"==typeof e?fs("div",{class:Vs,id:t,innerHTML:e}):function(t){return t&&"function"==typeof t.render}(e)?fs("div",{class:Vs,id:t},e.render()):e instanceof HTMLElement?fs("div",{class:Vs,id:t,bind:e,afterCreate:this._attachToNode}):null}_attachToNode(t){t.appendChild(this)}};Z([oi({readOnly:!0})],Ws.prototype,"container",void 0),Z([oi()],Ws.prototype,"content",void 0),Z([oi()],Ws.prototype,"open",void 0),Z([oi(),us("esri/t9n/common")],Ws.prototype,"messages",void 0),Z([oi()],Ws.prototype,"title",null),Ws=Z([Ci("esri.identity.IdentityModal")],Ws);const Ys=Ws,Xs="esriJSAPIOAuth";class Zs{constructor(t,e){this.oAuthInfo=null,this.storage=null,this.appId=null,this.codeVerifier=null,this.expires=null,this.refreshToken=null,this.ssl=null,this.stateUID=null,this.token=null,this.userId=null,this.oAuthInfo=t,this.storage=e,this._init()}isValid(){let t=!1;if(this.oAuthInfo&&this.userId&&(this.refreshToken||this.token))if(null==this.expires&&this.refreshToken)t=!0;else if(this.expires){const e=Date.now();this.expires>e&&(this.expires-e)/1e3>60*this.oAuthInfo.minTimeUntilExpiration&&(t=!0)}return t}save(){if(!this.storage)return!1;const t=this._load(),e=this.oAuthInfo;if(e&&e.authNamespace&&e.portalUrl){let i=t[e.authNamespace];i||(i=t[e.authNamespace]={}),this.appId||(this.appId=e.appId),i[e.portalUrl]={appId:this.appId,codeVerifier:this.codeVerifier,expires:this.expires,refreshToken:this.refreshToken,ssl:this.ssl,stateUID:this.stateUID,token:this.token,userId:this.userId};try{this.storage.setItem(Xs,JSON.stringify(t))}catch(t){return console.warn(t),!1}return!0}return!1}destroy(){const t=this._load(),e=this.oAuthInfo;if(e&&e.appId&&e.portalUrl&&(null==this.expires||this.expires>Date.now())&&(this.refreshToken||this.token)){const t=e.portalUrl.replace(/^http:/i,"https:")+"/sharing/rest/oauth2/revokeToken",i=new FormData;if(i.append("f","json"),i.append("auth_token",this.refreshToken||this.token),i.append("client_id",e.appId),i.append("token_type_hint",this.refreshToken?"refresh_token":"access_token"),"function"==typeof navigator.sendBeacon)navigator.sendBeacon(t,i);else{const e=new XMLHttpRequest;e.open("POST",t),e.send(i)}}if(e&&e.authNamespace&&e.portalUrl&&this.storage){const i=t[e.authNamespace];if(i){delete i[e.portalUrl];try{this.storage.setItem(Xs,JSON.stringify(t))}catch(t){console.log(t)}}}e&&(e._oAuthCred=null,this.oAuthInfo=null)}_init(){const t=this._load(),e=this.oAuthInfo;if(e&&e.authNamespace&&e.portalUrl){let i=t[e.authNamespace];i&&(i=i[e.portalUrl],i&&(this.appId=i.appId,this.codeVerifier=i.codeVerifier,this.expires=i.expires,this.refreshToken=i.refreshToken,this.ssl=i.ssl,this.stateUID=i.stateUID,this.token=i.token,this.userId=i.userId))}}_load(){let t={};if(this.storage){const e=this.storage.getItem(Xs);if(e)try{t=JSON.parse(e)}catch(t){console.warn(t)}}return t}}Zs.prototype.declaredClass="esri.identity.OAuthCredential";class Ks{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(t){const e=new Ks;return this._values.forEach(((n,r)=>{t&&t.has(r)||e.set(r,i(n.value),n.origin)})),e}get(t,e){e=this._normalizeOrigin(e);const i=this._values.get(t);return null==e||i?.origin===e?i?.value:void 0}originOf(t){return this._values.get(t)?.origin??kt.USER}keys(t){t=this._normalizeOrigin(t);const e=[...this._values.keys()];return null==t?e:e.filter((e=>this._values.get(e)?.origin===t))}set(t,e,i){if((i=this._normalizeOrigin(i))===kt.DEFAULTS){const e=this._values.get(t);if(e&&null!=e.origin&&e.origin>i)return}this._values.set(t,new Qs(e,i))}delete(t,e){null!=(e=this._normalizeOrigin(e))&&this._values.get(t)?.origin!==e||this._values.delete(t)}has(t,e){return null!=(e=this._normalizeOrigin(e))?this._values.get(t)?.origin===e:this._values.has(t)}forEach(t){this._values.forEach((({value:e},i)=>t(e,i)))}_normalizeOrigin(t){if(null!=t)return t===kt.DEFAULTS?t:kt.USER}}class Qs{constructor(t,e){this.value=t,this.origin=e}}function to(t,e,i){if(!t||!t.read||!1===t.read.enabled||!t.read.source)return!1;const n=t.read.source;if("string"==typeof n){if(n===e)return!0;if(n.includes(".")&&0===n.indexOf(e)&&dt(n,i))return!0}else for(const t of n){if(t===e)return!0;if(t.includes(".")&&0===t.indexOf(e)&&dt(t,i))return!0}return!1}function eo(t,e,i,n,r){let s=Oi(e[i],r);(function(t){return t&&(!t.read||!1!==t.read.enabled&&!t.read.source)})(s)&&(t[i]=!0);for(const o of Object.getOwnPropertyNames(e))s=Oi(e[o],r),to(s,i,n)&&(t[o]=!0)}function io(t,e,i,n){const r=Ii(i.metadatas[e],"any",n),s=r&&r.default;if(void 0===s)return;const o="function"==typeof s?s.call(t,e,n):s;void 0!==o&&i.set(e,o)}const no={origin:"service"};function ro(t,e,i,n,r){const s={};return e.write?.writer?.call(t,n,s,i,r),s}function so(t,e,i,r,s,o){if(!r||!r.write)return!1;const u=t.get(i);if(!s&&r.write.overridePolicy){const e=r.write.overridePolicy.call(t,u,i,o);void 0!==e&&(s=e)}if(s||(s=r.write),!s||!1===s.enabled)return!1;if((null===u&&!s.allowNull&&!s.writerEnsuresNonNull||void 0===u)&&s.isRequired){const e=new a("web-document-write:property-required",`Missing value for required property '${i}' on '${t.declaredClass}'`,{propertyName:i,target:t});return e&&o&&o.messages?o.messages.push(e):e&&!o&&n.getLogger("esri.core.accessorSupport.write").error(e.name,e.message),!1}return!(void 0===u||null===u&&!s.allowNull&&!s.writerEnsuresNonNull||(!e.store.multipleOriginsSupported||e.store.originOf(i)===kt.DEFAULTS)&&function(t,e,i,n,r){const s=n.default;if(void 0===s)return!1;if(null!=n.defaultEquals)return n.defaultEquals(r);if("function"==typeof s){if(Array.isArray(r)){const n=s.call(t,e,i);return N(n,r)}return!1}return s===r}(t,i,o,r,u)||!s.ignoreOrigin&&o&&o.origin&&e.store.multipleOriginsSupported&&e.store.originOf(i)<St(o.origin))}const oo=e=>{let i=class extends e{constructor(...e){super(...e);const i=t(it(this)),n=i.store,r=new Ks;i.store=r,function(t,e,i){e.keys().forEach((t=>{i.set(t,e.get(t),kt.DEFAULTS)})),Object.keys(t.metadatas).forEach((e=>{t.internalGet(e)&&i.set(e,t.internalGet(e),kt.DEFAULTS)}))}(i,n,r)}read(t,e){!function(t,e,i=no){if(!e||"object"!=typeof e)return;const n=it(t),r=n.metadatas,s={};for(const t of Object.getOwnPropertyNames(e))eo(s,r,t,e,i);n.setDefaultOrigin(i.origin);for(const o of Object.getOwnPropertyNames(s)){const s=Oi(r[o],i).read,a=s&&s.source;let u;u=a&&"string"==typeof a?ht(e,a):e[o],s&&s.reader&&(u=s.reader.call(t,u,e,i)),void 0!==u&&n.set(o,u)}if(!i||!i.ignoreDefaults){n.setDefaultOrigin("defaults");for(const e of Object.getOwnPropertyNames(r))s[e]||io(t,e,n,i)}n.setDefaultOrigin("user")}(this,t,e)}write(t={},e){return function(t,e,i){if(t&&"function"==typeof t.toJSON&&(!t.toJSON.isDefaultToJSON||!t.write))return nt(e,t.toJSON(i));const n=it(t),r=n.metadatas;for(const s in r){const o=_i(r[s],i);if(!so(t,n,s,o,void 0,i))continue;const a=t.get(s),u=ro(t,o,o.write&&"string"==typeof o.write.target?o.write.target:s,a,i);Object.keys(u).length>0&&(e=nt(e,u),i?.resources?.pendingOperations?.length&&Promise.all(i.resources.pendingOperations).then((()=>nt(e,u))),i&&i.writtenProperties&&i.writtenProperties.push({target:t,propName:s,oldOrigin:Ot(n.store.originOf(s)),newOrigin:i.origin}))}return e}(this,t,e)}toJSON(t){return this.write({},t)}static fromJSON(t,e){return ao.call(this,t,e)}};return i=Z([Ci("esri.core.JSONSupport")],i),i.prototype.toJSON.isDefaultToJSON=!0,i};function ao(t,e){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const i=new this;return i.read(t,e),i}let uo=class extends(oo(Li)){};var co;uo=Z([Ci("esri.core.JSONSupport")],uo);let lo=co=class extends uo{constructor(t){super(t),this._oAuthCred=null,this.appId=null,this.authNamespace="/",this.expiration=20160,this.flowType="auto",this.forceLogin=!1,this.forceUserId=!1,this.locale=null,this.minTimeUntilExpiration=30,this.popup=!1,this.popupCallbackUrl="oauth-callback.html",this.popupWindowFeatures="height=490,width=800,resizable,scrollbars,status",this.portalUrl="https://www.arcgis.com",this.preserveUrlHash=!1,this.userId=null}clone(){return co.fromJSON(this.toJSON())}};Z([oi({json:{write:!0}})],lo.prototype,"appId",void 0),Z([oi({json:{write:!0}})],lo.prototype,"authNamespace",void 0),Z([oi({json:{write:!0}})],lo.prototype,"expiration",void 0),Z([oi({json:{write:!0}})],lo.prototype,"flowType",void 0),Z([oi({json:{write:!0}})],lo.prototype,"forceLogin",void 0),Z([oi({json:{write:!0}})],lo.prototype,"forceUserId",void 0),Z([oi({json:{write:!0}})],lo.prototype,"locale",void 0),Z([oi({json:{write:!0}})],lo.prototype,"minTimeUntilExpiration",void 0),Z([oi({json:{write:!0}})],lo.prototype,"popup",void 0),Z([oi({json:{write:!0}})],lo.prototype,"popupCallbackUrl",void 0),Z([oi({json:{write:!0}})],lo.prototype,"popupWindowFeatures",void 0),Z([oi({json:{write:!0}})],lo.prototype,"portalUrl",void 0),Z([oi({json:{write:!0}})],lo.prototype,"preserveUrlHash",void 0),Z([oi({json:{write:!0}})],lo.prototype,"userId",void 0),lo=co=Z([Ci("esri.identity.OAuthInfo")],lo);const ho=lo;let fo=class extends uo{constructor(t){super(t),this.adminTokenServiceUrl=null,this.currentVersion=null,this.hasPortal=null,this.hasServer=null,this.owningSystemUrl=null,this.owningTenant=null,this.server=null,this.shortLivedTokenValidity=null,this.tokenServiceUrl=null,this.webTierAuth=null}};Z([oi({json:{write:!0}})],fo.prototype,"adminTokenServiceUrl",void 0),Z([oi({json:{write:!0}})],fo.prototype,"currentVersion",void 0),Z([oi({json:{write:!0}})],fo.prototype,"hasPortal",void 0),Z([oi({json:{write:!0}})],fo.prototype,"hasServer",void 0),Z([oi({json:{write:!0}})],fo.prototype,"owningSystemUrl",void 0),Z([oi({json:{write:!0}})],fo.prototype,"owningTenant",void 0),Z([oi({json:{write:!0}})],fo.prototype,"server",void 0),Z([oi({json:{write:!0}})],fo.prototype,"shortLivedTokenValidity",void 0),Z([oi({json:{write:!0}})],fo.prototype,"tokenServiceUrl",void 0),Z([oi({json:{write:!0}})],fo.prototype,"webTierAuth",void 0),fo=Z([Ci("esri.identity.ServerInfo")],fo);const po=fo,go={},vo=t=>{const e=new P(t.owningSystemUrl).host,i=new P(t.server).host,n=/.+\.arcgis\.com$/i;return n.test(e)&&n.test(i)},mo=(t,e)=>!!(vo(t)&&e&&e.some((e=>e.test(t.server))));let yo=null,wo=null;try{yo=window.localStorage,wo=window.sessionStorage}catch{}class bo extends Gi{constructor(){super(),this._portalConfig=globalThis.esriGeowConfig,this.serverInfos=[],this.oAuthInfos=[],this.credentials=[],this._soReqs=[],this._xoReqs=[],this._portals=[],this._defaultOAuthInfo=null,this._defaultTokenValidity=60,this.dialog=null,this.formConstructor=ys,this.tokenValidity=null,this.normalizeWebTierAuth=!1,this._appOrigin="null"!==window.origin?window.origin:window.location.origin,this._appUrlObj=C(window.location.href),this._busy=null,this._rejectOnPersistedPageShow=!1,this._oAuthLocationParams=null,this._gwTokenUrl="/sharing/rest/generateToken",this._agsRest="/rest/services",this._agsPortal=/\/sharing(\/|$)/i,this._agsAdmin=/(https?:\/\/[^\/]+\/[^\/]+)\/admin\/?(\/.*)?$/i,this._adminSvcs=/\/rest\/admin\/services(\/|$)/i,this._gwDomains=[{regex:/^https?:\/\/www\.arcgis\.com/i,customBaseUrl:"maps.arcgis.com",tokenServiceUrl:"https://www.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/(?:dev|[a-z\d-]+\.mapsdev)\.arcgis\.com/i,customBaseUrl:"mapsdev.arcgis.com",tokenServiceUrl:"https://dev.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/(?:devext|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,customBaseUrl:"mapsdevext.arcgis.com",tokenServiceUrl:"https://devext.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/(?:qaext|[a-z\d-]+\.mapsqa)\.arcgis\.com/i,customBaseUrl:"mapsqa.arcgis.com",tokenServiceUrl:"https://qaext.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/[a-z\d-]+\.maps\.arcgis\.com/i,customBaseUrl:"maps.arcgis.com",tokenServiceUrl:"https://www.arcgis.com/sharing/rest/generateToken"}],this._legacyFed=[],this._regexSDirUrl=/http.+\/rest\/services\/?/gi,this._regexServerType=/(\/(FeatureServer|GPServer|GeoDataServer|GeocodeServer|GeoenrichmentServer|GeometryServer|GlobeServer|ImageServer|KnowledgeGraphServer|MapServer|MobileServer|NAServer|NetworkDiagramServer|OGCFeatureServer|ParcelFabricServer|RelationalCatalogServer|SceneServer|StreamServer|UtilityNetworkServer|ValidationServer|VectorTileServer|VersionManagementServer)).*/gi,this._gwUser=/http.+\/users\/([^\/]+)\/?.*/i,this._gwItem=/http.+\/items\/([^\/]+)\/?.*/i,this._gwGroup=/http.+\/groups\/([^\/]+)\/?.*/i,this._rePortalTokenSvc=/\/sharing(\/rest)?\/generatetoken/i,this._createDefaultOAuthInfo=!0,this._hasTestedIfAppIsOnPortal=!1,this._getOAuthLocationParams(),window.addEventListener("pageshow",(t=>{this._pageShowHandler(t)}))}registerServers(t){const e=this.serverInfos;e?(t=t.filter((t=>!this.findServerInfo(t.server))),this.serverInfos=e.concat(t)):this.serverInfos=t,t.forEach((t=>{t.owningSystemUrl&&this._portals.push(t.owningSystemUrl),t.hasPortal&&this._portals.push(t.server)}))}registerOAuthInfos(t){const e=this.oAuthInfos;if(e){for(const i of t){const t=this.findOAuthInfo(i.portalUrl);t&&e.splice(e.indexOf(t),1)}this.oAuthInfos=e.concat(t)}else this.oAuthInfos=t}registerToken(t){t={...t};const e=this._sanitizeUrl(t.server),i=this._isServerRsrc(e);let n,r=this.findServerInfo(e),s=!0;r||(r=new po,r.server=this._getServerInstanceRoot(e),i?r.hasServer=!0:(r.tokenServiceUrl=this._getTokenSvcUrl(e),r.hasPortal=!0),this.registerServers([r])),n=this._findCredential(e),n?(delete t.server,Object.assign(n,t),s=!1):(n=new ko({userId:t.userId,server:r.server,token:t.token,expires:t.expires,ssl:t.ssl,scope:i?"server":"portal"}),n.resources=[e],this.credentials.push(n)),n.emitTokenChange(!1),s||n.refreshServerTokens()}toJSON(){return U({serverInfos:this.serverInfos.map((t=>t.toJSON())),oAuthInfos:this.oAuthInfos.map((t=>t.toJSON())),credentials:this.credentials.map((t=>t.toJSON()))})}initialize(t){if(!t)return;"string"==typeof t&&(t=JSON.parse(t));const e=t.serverInfos,i=t.oAuthInfos,n=t.credentials;if(e){const t=[];e.forEach((e=>{e.server&&e.tokenServiceUrl&&t.push(e.declaredClass?e:new po(e))})),t.length&&this.registerServers(t)}if(i){const t=[];i.forEach((e=>{e.appId&&t.push(e.declaredClass?e:new ho(e))})),t.length&&this.registerOAuthInfos(t)}n&&n.forEach((t=>{t.server&&t.token&&t.expires&&t.expires>Date.now()&&((t=t.declaredClass?t:new ko(t)).emitTokenChange(),this.credentials.push(t))}))}findServerInfo(t){let e;t=this._sanitizeUrl(t);for(const i of this.serverInfos)if(this._hasSameServerInstance(i.server,t)){e=i;break}return e}findOAuthInfo(t){let e;t=this._sanitizeUrl(t);for(const i of this.oAuthInfos)if(this._hasSameServerInstance(i.portalUrl,t)){e=i;break}return e}findCredential(t,e){if(!t)return;let i;t=this._sanitizeUrl(t);const n=this._isServerRsrc(t)?"server":"portal";if(e){for(const r of this.credentials)if(this._hasSameServerInstance(r.server,t)&&e===r.userId&&r.scope===n){i=r;break}}else for(const e of this.credentials)if(this._hasSameServerInstance(e.server,t)&&-1!==this._getIdenticalSvcIdx(t,e)&&e.scope===n){i=e;break}return i}getCredential(t,e){let i,n,r=!0;e&&(i=!!e.token,n=e.error,r=!1!==e.prompt),e={...e},t=this._sanitizeUrl(t);const s=new AbortController,o=D();if(e.signal&&z(e.signal,(()=>{s.abort()})),z(s,(()=>{o.reject(new a("identity-manager:user-aborted","ABORTED"))})),R(s))return o.promise;e.signal=s.signal;const u=this._isAdminResource(t),c=i?this.findCredential(t):null;let l;if(c&&n&&n.details&&498===n.details.httpStatus)c.destroy();else if(c)return l=new a("identity-manager:not-authorized","You are currently signed in as: '"+c.userId+"'. You do not have access to this resource: "+t,{error:n}),o.reject(l),o.promise;const h=this._findCredential(t,e);if(h)return o.resolve(h),o.promise;let f=this.findServerInfo(t);if(f)!f.hasServer&&this._isServerRsrc(t)&&(f._restInfoPms=this._getTokenSvcUrl(t),f.hasServer=!0);else{const e=this._getTokenSvcUrl(t);if(!e)return l=new a("identity-manager:unknown-resource","Unknown resource - could not find token service endpoint."),o.reject(l),o.promise;f=new po,f.server=this._getServerInstanceRoot(t),"string"==typeof e?(f.tokenServiceUrl=e,f.hasPortal=!0):(f._restInfoPms=e,f.hasServer=!0),this.registerServers([f])}return f.hasPortal&&void 0===f._selfReq&&(r||M(f.tokenServiceUrl,this._appOrigin)||this._gwDomains.some((t=>t.tokenServiceUrl===f.tokenServiceUrl)))&&(f._selfReq={owningTenant:e&&e.owningTenant,selfDfd:this._getPortalSelf(f.tokenServiceUrl.replace(this._rePortalTokenSvc,"/sharing/rest/portals/self"),t)}),this._enqueue(t,f,e,o,u)}getResourceName(t){return this._isRESTService(t)?t.replace(this._regexSDirUrl,"").replace(this._regexServerType,"")||"":this._gwUser.test(t)&&t.replace(this._gwUser,"$1")||this._gwItem.test(t)&&t.replace(this._gwItem,"$1")||this._gwGroup.test(t)&&t.replace(this._gwGroup,"$1")||""}generateToken(t,e,i){const n=this._rePortalTokenSvc.test(t.tokenServiceUrl),r=new P(this._appOrigin),s=t.shortLivedTokenValidity;let o,u,c,l,h,f,d,p;e&&(p=this.tokenValidity||s||this._defaultTokenValidity,p>s&&s>0&&(p=s)),i&&(o=i.isAdmin,u=i.serverUrl,c=i.token,f=i.signal,d=i.ssl,t.customParameters=i.customParameters),o?l=t.adminTokenServiceUrl:(l=t.tokenServiceUrl,h=new P(l.toLowerCase()),t.webTierAuth&&i?.serverUrl&&!d&&"http"===r.scheme&&(M(r.uri,l,!0)||"https"===h.scheme&&r.host===h.host&&"7080"===r.port&&"7443"===h.port)&&(l=l.replace(/^https:/i,"http:").replace(/:7443/i,":7080")));const g={query:{request:"getToken",username:e?.username,password:e?.password,serverUrl:u,token:c,expiration:p,referer:o||n?this._appOrigin:null,client:o?"referer":null,f:"json",...t.customParameters},method:"post",authMode:"anonymous",useProxy:this._useProxy(t,i),signal:f,...i?.ioArgs};return n||(g.withCredentials=!1),F(l,g).then((i=>{const n=i.data;if(!n||!n.token)return new a("identity-manager:authentication-failed","Unable to generate token");const r=t.server;return go[r]||(go[r]={}),e&&(go[r][e.username]=e.password),n.validity=p,n}))}isBusy(){return!!this._busy}checkSignInStatus(t){return this.checkAppAccess(t,"").then((t=>t.credential))}checkAppAccess(t,e,i){let n=!1;return this.getCredential(t,{prompt:!1}).then((r=>{let s;const o={f:"json"};if("portal"===r.scope)if(e&&(this._doPortalSignIn(t)||i&&i.force))s=r.server+"/sharing/rest/oauth2/validateAppAccess",o.client_id=e;else{if(!r.token)return{credential:r};s=r.server+"/sharing/rest"}else{if(!r.token)return{credential:r};s=r.server+"/rest/services"}return r.token&&(o.token=r.token),F(s,{query:o,authMode:"anonymous"}).then((t=>{if(!1===t.data.valid)throw new a("identity-manager:not-authorized",`You are currently signed in as: '${r.userId}'.`,t.data);return n=!!t.data.viewOnlyUserTypeApp,{credential:r}})).catch((t=>{if("identity-manager:not-authorized"===t.name)throw t;const e=t.details&&t.details.httpStatus;if(498===e)throw r.destroy(),new a("identity-manager:not-authenticated","User is not signed in.");if(400===e)throw new a("identity-manager:invalid-request");return{credential:r}}))})).then((t=>({credential:t.credential,viewOnly:n})))}setOAuthResponseHash(t){t&&("#"===t.charAt(0)&&(t=t.substring(1)),this._processOAuthPopupParams(q(t)))}setOAuthRedirectionHandler(t){this._oAuthRedirectFunc=t}setProtocolErrorHandler(t){this._protocolFunc=t}signIn(t,e,i={}){const n=D(),r=()=>{u?.remove(),c?.remove(),l?.remove(),o?.destroy(),this.dialog?.destroy(),this.dialog=o=u=c=l=null},s=()=>{r(),this._oAuthDfd=null,n.reject(new a("identity-manager:user-aborted","ABORTED"))};i.signal&&z(i.signal,(()=>{s()}));let o=new this.formConstructor;o.resource=this.getResourceName(t),o.server=e.server,this.dialog=new Ys,this.dialog.content=o,this.dialog.open=!0,this.emit("dialog-create");let u=o.on("cancel",s),c=Ji((()=>this.dialog.open),s),l=o.on("submit",(t=>{this.generateToken(e,t,{isAdmin:i.isAdmin,signal:i.signal}).then((s=>{r();const o=new ko({userId:t.username,server:e.server,token:s.token,expires:null!=s.expires?Number(s.expires):null,ssl:!!s.ssl,isAdmin:i.isAdmin,validity:s.validity});n.resolve(o)})).catch((t=>{o.error=t,o.signingIn=!1}))}));return n.promise}oAuthSignIn(t,e,i,n){this._oAuthDfd=D();const r=this._oAuthDfd;let s;n?.signal&&z(n.signal,(()=>{const t=this._oAuthDfd&&this._oAuthDfd.oAuthWin_;t&&!t.closed?t.close():this.dialog&&f()})),r.resUrl_=t,r.sinfo_=e,r.oinfo_=i;const o=i._oAuthCred;if(o.storage&&("authorization-code"===i.flowType||"auto"===i.flowType&&!i.popup&&e.currentVersion>=8.4)){let t=crypto.getRandomValues(new Uint8Array(32));s=L(t),o.codeVerifier=s,t=crypto.getRandomValues(new Uint8Array(32)),o.stateUID=L(t),o.save()||(o.codeVerifier=s=null)}else o.codeVerifier=null;let u,c,l,h;this._getCodeChallenge(s).then((r=>{!i.popup||n&&!1===n.oAuthPopupConfirmation?this._doOAuthSignIn(t,e,i,r):(u=new this.formConstructor,u.oAuthPrompt=!0,u.server=e.server,this.dialog=new Ys,this.dialog.content=u,this.dialog.open=!0,this.emit("dialog-create"),c=u.on("cancel",f),l=Ji((()=>this.dialog.open),f),h=u.on("submit",(()=>{d(),this._doOAuthSignIn(t,e,i,r)})))}));const f=()=>{d(),this._oAuthDfd=null,r.reject(new a("identity-manager:user-aborted","ABORTED"))},d=()=>{c?.remove(),l?.remove(),h?.remove(),u?.destroy(),this.dialog?.destroy(),this.dialog=null};return r.promise}destroyCredentials(){this.credentials&&this.credentials.slice().forEach((t=>{t.destroy()})),this.emit("credentials-destroy")}enablePostMessageAuth(t="https://www.arcgis.com/sharing/rest"){this._postMessageAuthHandle&&this._postMessageAuthHandle.remove(),this._postMessageAuthHandle=T(window,"message",(e=>{if((e.origin===this._appOrigin||e.origin.endsWith(".arcgis.com"))&&"arcgis:auth:requestCredential"===e.data?.type){const i=e.source;this.getCredential(t).then((t=>{i.postMessage({type:"arcgis:auth:credential",credential:{expires:t.expires,server:t.server,ssl:t.ssl,token:t.token,userId:t.userId}},e.origin)})).catch((t=>{i.postMessage({type:"arcgis:auth:error",error:{name:t.name,message:t.message}},e.origin)}))}}))}disablePostMessageAuth(){this._postMessageAuthHandle&&(this._postMessageAuthHandle.remove(),this._postMessageAuthHandle=null)}_getOAuthLocationParams(){let t=window.location.hash;if(t){"#"===t.charAt(0)&&(t=t.substring(1));const e=q(t);let i=!1;if(e.access_token&&e.expires_in&&e.state&&e.hasOwnProperty("username"))try{e.state=JSON.parse(e.state),e.state.portalUrl&&(this._oAuthLocationParams=e,i=!0)}catch{}else if(e.error&&e.error_description&&(console.log("IdentityManager OAuth Error: ",e.error," - ",e.error_description),"access_denied"===e.error&&(i=!0,e.state)))try{e.state=JSON.parse(e.state)}catch{}i&&(window.location.hash=e.state?.hash||"")}let e=window.location.search;if(e){"?"===e.charAt(0)&&(e=e.substring(1));const t=q(e);let i=!1;if(t.code&&t.state)try{t.state=JSON.parse(t.state),t.state.portalUrl&&t.state.uid&&(this._oAuthLocationParams=t,i=!0)}catch{}else if(t.error&&t.error_description&&(console.log("IdentityManager OAuth Error: ",t.error," - ",t.error_description),"access_denied"===t.error&&(i=!0,t.state)))try{t.state=JSON.parse(t.state)}catch{}if(i){const e={...t};["code","error","error_description","message_code","persist","state"].forEach((t=>{delete e[t]}));const i=B(e),n=window.location.pathname+(i?`?${i}`:"")+(t.state?.hash||"");window.history.replaceState(window.history.state,"",n)}}}_getOAuthToken(t,e,i,n,r){return t=t.replace(/^http:/i,"https:"),F(`${t}/sharing/rest/oauth2/token`,{authMode:"anonymous",method:"post",query:n&&r?{grant_type:"authorization_code",code:e,redirect_uri:n,client_id:i,code_verifier:r}:{grant_type:"refresh_token",refresh_token:e,client_id:i}}).then((t=>t.data))}_getCodeChallenge(t){if(t&&globalThis.isSecureContext){const e=(new TextEncoder).encode(t);return crypto.subtle.digest("SHA-256",e).then((t=>L(new Uint8Array(t))))}return Promise.resolve(null)}_pageShowHandler(t){if(t.persisted&&this.isBusy()&&this._rejectOnPersistedPageShow){const t=new a("identity-manager:user-aborted","ABORTED");this._errbackFunc(t)}}_findCredential(t,e){let i,n,r,s,o=-1;const a=e&&e.token,u=e&&e.resource,c=this._isServerRsrc(t)?"server":"portal",l=this.credentials.filter((e=>this._hasSameServerInstance(e.server,t)&&e.scope===c));if(t=u||t,l.length)if(1===l.length){if(i=l[0],r=this.findServerInfo(i.server),n=r&&r.owningSystemUrl,s=n?this.findCredential(n,i.userId):void 0,o=this._getIdenticalSvcIdx(t,i),!a)return-1===o&&i.resources.push(t),this._addResource(t,s),i;-1!==o&&(i.resources.splice(o,1),this._removeResource(t,s))}else{let e,i;if(l.some((a=>(i=this._getIdenticalSvcIdx(t,a),-1!==i&&(e=a,r=this.findServerInfo(e.server),n=r&&r.owningSystemUrl,s=n?this.findCredential(n,e.userId):void 0,o=i,!0)))),a)e&&(e.resources.splice(o,1),this._removeResource(t,s));else if(e)return this._addResource(t,s),e}}_findOAuthInfo(t){let e=this.findOAuthInfo(t);if(!e)for(const i of this.oAuthInfos)if(this._isIdProvider(i.portalUrl,t)){e=i;break}return e}_addResource(t,e){e&&-1===this._getIdenticalSvcIdx(t,e)&&e.resources.push(t)}_removeResource(t,e){let i=-1;e&&(i=this._getIdenticalSvcIdx(t,e),i>-1&&e.resources.splice(i,1))}_useProxy(t,e){return e&&e.isAdmin&&!M(t.adminTokenServiceUrl,this._appOrigin)||!this._isPortalDomain(t.tokenServiceUrl)&&"10.1"===String(t.currentVersion)&&!M(t.tokenServiceUrl,this._appOrigin)}_getOrigin(t){const e=new P(t);return e.scheme+"://"+e.host+(null!=e.port?":"+e.port:"")}_getServerInstanceRoot(t){const e=t.toLowerCase();let i=e.indexOf(this._agsRest);return-1===i&&this._isAdminResource(t)&&(i=this._agsAdmin.test(t)?t.replace(this._agsAdmin,"$1").length:t.search(this._adminSvcs)),-1!==i||G(e)||(i=e.indexOf("/sharing")),-1===i&&"/"===e.substr(-1)&&(i=e.length-1),i>-1?t.substring(0,i):t}_hasSameServerInstance(t,e){return"/"===t.substr(-1)&&(t=t.slice(0,-1)),t=t.toLowerCase(),e=this._getServerInstanceRoot(e).toLowerCase(),t=this._normalizeAGOLorgDomain(t),e=this._normalizeAGOLorgDomain(e),(t=t.substr(t.indexOf(":")))===e.substr(e.indexOf(":"))}_normalizeAGOLorgDomain(t){const e=/^https?:\/\/(?:cdn|[a-z\d-]+\.maps)\.arcgis\.com/i,i=/^https?:\/\/(?:cdndev|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,n=/^https?:\/\/(?:cdnqa|[a-z\d-]+\.mapsqa)\.arcgis\.com/i;return e.test(t)?t=t.replace(e,"https://www.arcgis.com"):i.test(t)?t=t.replace(i,"https://devext.arcgis.com"):n.test(t)&&(t=t.replace(n,"https://qaext.arcgis.com")),t}_sanitizeUrl(t){const e=(J.request.proxyUrl||"").toLowerCase(),i=e?t.toLowerCase().indexOf(e+"?"):-1;return-1!==i&&(t=t.substring(i+e.length+1)),t=H(t),C(t).path}_isRESTService(t){return t.includes(this._agsRest)}_isAdminResource(t){return this._agsAdmin.test(t)||this._adminSvcs.test(t)}_isServerRsrc(t){return this._isRESTService(t)||this._isAdminResource(t)}_isIdenticalService(t,e){let i=!1;if(this._isRESTService(t)&&this._isRESTService(e)){const n=this._getSuffix(t).toLowerCase(),r=this._getSuffix(e).toLowerCase();if(i=n===r,!i){const t=/(.*)\/(MapServer|FeatureServer|UtilityNetworkServer).*/gi;i=n.replace(t,"$1")===r.replace(t,"$1")}}else this._isAdminResource(t)&&this._isAdminResource(e)?i=!0:this._isServerRsrc(t)||this._isServerRsrc(e)||!this._isPortalDomain(t)||(i=!0);return i}_isPortalDomain(t){const e=new P(t.toLowerCase()),i=this._portalConfig;let n=this._gwDomains.some((t=>t.regex.test(e.uri)));return!n&&i&&(n=this._hasSameServerInstance(this._getServerInstanceRoot(i.restBaseUrl),e.uri)),n||J.portalUrl&&(n=M(e,J.portalUrl,!0)),n||(n=this._portals.some((t=>this._hasSameServerInstance(t,e.uri)))),n=n||this._agsPortal.test(e.path),n}_isIdProvider(t,e){let i=-1,n=-1;this._gwDomains.forEach(((r,s)=>{-1===i&&r.regex.test(t)&&(i=s),-1===n&&r.regex.test(e)&&(n=s)}));let r=!1;if(i>-1&&n>-1&&(0===i||4===i?0!==n&&4!==n||(r=!0):1===i?1!==n&&2!==n||(r=!0):2===i?2===n&&(r=!0):3===i&&3===n&&(r=!0)),!r){const i=this.findServerInfo(e),n=i&&i.owningSystemUrl;n&&vo(i)&&this._isPortalDomain(n)&&this._isIdProvider(t,n)&&(r=!0)}return r}_getIdenticalSvcIdx(t,e){let i=-1;for(let n=0;n<e.resources.length;n++)if(this._isIdenticalService(t,e.resources[n])){i=n;break}return i}_getSuffix(t){return t.replace(this._regexSDirUrl,"").replace(this._regexServerType,"$1")}_getTokenSvcUrl(t){let e,i,n;if(this._isRESTService(t)||this._isAdminResource(t)){const n=this._getServerInstanceRoot(t);return e=n+"/admin/generateToken",i=F(t=n+"/rest/info",{query:{f:"json"}}).then((t=>t.data)),{adminUrl:e,promise:i}}if(this._isPortalDomain(t)){let e="";if(this._gwDomains.some((i=>(i.regex.test(t)&&(e=i.tokenServiceUrl),!!e))),e||this._portals.some((i=>(this._hasSameServerInstance(i,t)&&(e=i+this._gwTokenUrl),!!e))),e||(n=t.toLowerCase().indexOf("/sharing"),-1!==n&&(e=t.substring(0,n)+this._gwTokenUrl)),e||(e=this._getOrigin(t)+this._gwTokenUrl),e){const i=new P(t).port;/^http:\/\//i.test(t)&&"7080"===i&&(e=e.replace(/:7080/i,":7443")),e=e.replace(/http:/i,"https:")}return e}if(t.toLowerCase().includes("premium.arcgisonline.com"))return"https://premium.arcgisonline.com/server/tokens"}_processOAuthResponseParams(t,e,i){const n=e._oAuthCred;if(t.code){const r=n.codeVerifier;return n.codeVerifier=null,n.stateUID=null,n.save(),this._getOAuthToken(i.server,t.code,e.appId,this._getRedirectURI(e,!0),r).then((r=>{const s=new ko({userId:r.username,server:i.server,token:r.access_token,expires:Date.now()+1e3*r.expires_in,ssl:r.ssl,oAuthState:t.state,_oAuthCred:n});return e.userId=s.userId,n.storage=r.persist?yo:wo,n.refreshToken=r.refresh_token,n.token=null,n.expires=r.refresh_token_expires_in?Date.now()+1e3*r.refresh_token_expires_in:null,n.userId=s.userId,n.ssl=s.ssl,n.save(),s}))}const r=new ko({userId:t.username,server:i.server,token:t.access_token,expires:Date.now()+1e3*Number(t.expires_in),ssl:"true"===t.ssl,oAuthState:t.state,_oAuthCred:n});return e.userId=r.userId,n.storage=t.persist?yo:wo,n.refreshToken=null,n.token=r.token,n.expires=r.expires,n.userId=r.userId,n.ssl=r.ssl,n.save(),Promise.resolve(r)}_processOAuthPopupParams(t){const e=this._oAuthDfd;if(this._oAuthDfd=null,e)if(clearInterval(this._oAuthIntervalId),this._oAuthOnPopupHandle?.remove(),t.error){const i="access_denied"===t.error,n=new a(i?"identity-manager:user-aborted":"identity-manager:authentication-failed",i?"ABORTED":"OAuth: "+t.error+" - "+t.error_description);e.reject(n)}else this._processOAuthResponseParams(t,e.oinfo_,e.sinfo_).then((t=>{e.resolve(t)})).catch((t=>{e.reject(t)}))}_setOAuthResponseQueryString(t){t&&("?"===t.charAt(0)&&(t=t.substring(1)),this._processOAuthPopupParams(q(t)))}_exchangeToken(t,e,i){return F(`${t}/sharing/rest/oauth2/exchangeToken`,{authMode:"anonymous",method:"post",query:{f:"json",client_id:e,token:i}}).then((t=>t.data.token))}_getPlatformSelf(t,e){return t=t.replace(/^http:/i,"https:"),F(`${t}/sharing/rest/oauth2/platformSelf`,{authMode:"anonymous",headers:{"X-Esri-Auth-Client-Id":e,"X-Esri-Auth-Redirect-Uri":window.location.href.replace(/#.*$/,"")},method:"post",query:{f:"json",expiration:30},withCredentials:!0}).then((t=>t.data))}_getPortalSelf(t,e){let i;return this._gwDomains.some((e=>(e.regex.test(t)&&(i=e.customBaseUrl),!!i))),i?Promise.resolve({allSSL:!0,currentVersion:"8.4",customBaseUrl:i,portalMode:"multitenant",supportsOAuth:!0}):(this._appOrigin.startsWith("https:")?t=t.replace(/^http:/i,"https:").replace(/:7080/i,":7443"):/^http:/i.test(e)&&(t=t.replace(/^https:/i,"http:").replace(/:7443/i,":7080")),F(t,{query:{f:"json"},authMode:"anonymous",withCredentials:!0}).then((t=>t.data)))}_doPortalSignIn(t){const e=this._portalConfig,i=window.location.href,n=this.findServerInfo(t);return!(!e&&!this._isPortalDomain(i)||!(n?n.hasPortal||n.owningSystemUrl&&this._isPortalDomain(n.owningSystemUrl):this._isPortalDomain(t))||!(this._isIdProvider(i,t)||e&&(this._hasSameServerInstance(this._getServerInstanceRoot(e.restBaseUrl),t)||this._isIdProvider(e.restBaseUrl,t))||M(i,t,!0)))}_checkProtocol(t,e,i,n){let r=!0;const s=n?e.adminTokenServiceUrl:e.tokenServiceUrl;return s.trim().toLowerCase().startsWith("https:")&&!this._appOrigin.startsWith("https:")&&V(s)&&(r=!!this._protocolFunc&&!!this._protocolFunc({resourceUrl:t,serverInfo:e}),!r)&&i(new a("identity-manager:aborted","Aborted the Sign-In process to avoid sending password over insecure connection.")),r}_enqueue(t,e,i,n,r,s){return n||(n=D()),n.resUrl_=t,n.sinfo_=e,n.options_=i,n.admin_=r,n.refresh_=s,this._busy?this._hasSameServerInstance(this._getServerInstanceRoot(t),this._busy.resUrl_)?(this._oAuthDfd&&this._oAuthDfd.oAuthWin_&&this._oAuthDfd.oAuthWin_.focus(),this._soReqs.push(n)):this._xoReqs.push(n):this._doSignIn(n),n.promise}_doSignIn(t){this._busy=t,this._rejectOnPersistedPageShow=!1;const e=e=>{const i=t.options_&&t.options_.resource,n=t.resUrl_,r=t.refresh_;let s=!1;this.credentials.includes(e)||(r&&this.credentials.includes(r)?(r.userId=e.userId,r.token=e.token,r.expires=e.expires,r.validity=e.validity,r.ssl=e.ssl,r.creationTime=e.creationTime,s=!0,e=r):this.credentials.push(e)),e.resources||(e.resources=[]),e.resources.includes(i||n)||e.resources.push(i||n),e.scope=this._isServerRsrc(n)?"server":"portal",e.emitTokenChange();const o=this._soReqs,a={};this._soReqs=[],o.forEach((t=>{if(!this._isIdenticalService(n,t.resUrl_)){const i=this._getSuffix(t.resUrl_);a[i]||(a[i]=!0,e.resources.push(t.resUrl_))}})),t.resolve(e),o.forEach((t=>{this._hasSameServerInstance(this._getServerInstanceRoot(n),t.resUrl_)?t.resolve(e):this._soReqs.push(t)})),this._busy=t.resUrl_=t.sinfo_=t.refresh_=null,s||this.emit("credential-create",{credential:e}),this._soReqs.length?this._doSignIn(this._soReqs.shift()):this._xoReqs.length&&this._doSignIn(this._xoReqs.shift())},i=e=>{t.reject(e),this._busy=t.resUrl_=t.sinfo_=t.refresh_=null,this._soReqs.length?this._doSignIn(this._soReqs.shift()):this._xoReqs.length&&this._doSignIn(this._xoReqs.shift())},n=(r,s,o,u)=>{const c=t.sinfo_,l=!t.options_||!1!==t.options_.prompt,h=c.hasPortal&&this._findOAuthInfo(t.resUrl_);let f,d;if(r)e(new ko({userId:r,server:c.server,token:o||null,expires:null!=u?Number(u):null,ssl:!!s}));else if(window!==window.parent&&this._appUrlObj.query?.["arcgis-auth-origin"]&&this._appUrlObj.query?.["arcgis-auth-portal"]&&this._hasSameServerInstance(this._getServerInstanceRoot(this._appUrlObj.query["arcgis-auth-portal"]),t.resUrl_)){window.parent.postMessage({type:"arcgis:auth:requestCredential"},this._appUrlObj.query["arcgis-auth-origin"]);const n=T(window,"message",(t=>{t.source===window.parent&&t.data&&("arcgis:auth:credential"===t.data.type?(n.remove(),t.data.credential.expires<Date.now()?i(new a("identity-manager:credential-request-failed","Parent application's token has expired.")):e(new ko(t.data.credential))):"arcgis:auth:error"===t.data.type&&(n.remove(),i("tokenExpiredError"===t.data.error.name?new a("identity-manager:credential-request-failed","Parent application's token has expired."):a.fromJSON(t.data.error))))}));z(t.options_?.signal,(()=>{n.remove()}))}else if(h){let r=h._oAuthCred;if(!r){const t=new Zs(h,yo),e=new Zs(h,wo);t.isValid()&&e.isValid()?t.expires>e.expires?(r=t,e.destroy()):(r=e,t.destroy()):r=t.isValid()?t:e,h._oAuthCred=r}if(r.isValid()){f=new ko({userId:r.userId,server:c.server,token:r.token,expires:r.expires,ssl:r.ssl,_oAuthCred:r});const i=h.appId!==r.appId&&this._doPortalSignIn(t.resUrl_);i||r.refreshToken?(t._pendingDfd=r.refreshToken?this._getOAuthToken(c.server,r.refreshToken,r.appId).then((t=>(f.expires=Date.now()+1e3*t.expires_in,f.token=t.access_token,f))):Promise.resolve(f),t._pendingDfd.then((t=>i?this._exchangeToken(t.server,h.appId,t.token).then((e=>(t.token=e,t))).catch((()=>t)):t)).then((t=>{e(t)})).catch((()=>{r?.destroy(),n()}))):e(f)}else if(this._oAuthLocationParams&&this._hasSameServerInstance(h.portalUrl,this._oAuthLocationParams.state.portalUrl)&&(this._oAuthLocationParams.access_token||this._oAuthLocationParams.code&&this._oAuthLocationParams.state.uid===r.stateUID&&r.codeVerifier)){const n=this._oAuthLocationParams;this._oAuthLocationParams=null,t._pendingDfd=this._processOAuthResponseParams(n,h,c).then((t=>{e(t)})).catch(i)}else{const n=()=>{l?t._pendingDfd=this.oAuthSignIn(t.resUrl_,c,h,t.options_).then(e,i):(d=new a("identity-manager:not-authenticated","User is not signed in."),i(d))};this._doPortalSignIn(t.resUrl_)?t._pendingDfd=this._getPlatformSelf(c.server,h.appId).then((t=>{M(t.portalUrl,this._appOrigin,!0)?(f=new ko({userId:t.username,server:c.server,expires:Date.now()+1e3*t.expires_in,token:t.token}),e(f)):n()})).catch(n):n()}}else if(l){if(this._checkProtocol(t.resUrl_,c,i,t.admin_)){let n=t.options_;t.admin_&&(n=n||{},n.isAdmin=!0),t._pendingDfd=this.signIn(t.resUrl_,c,n).then(e,i)}}else d=new a("identity-manager:not-authenticated","User is not signed in."),i(d)},r=()=>{const n=t.sinfo_,r=n.owningSystemUrl,s=t.options_;let o,a,u,c;if(s&&(o=s.token,a=s.error,u=s.prompt),c=this._findCredential(r,{token:o,resource:t.resUrl_}),!c)for(const t of this.credentials)if(this._isIdProvider(r,t.server)){c=t;break}if(c){const r=this.findCredential(t.resUrl_,c.userId);if(r)e(r);else if(mo(n,this._legacyFed)){const t=c.toJSON();t.server=n.server,t.resources=null,e(new ko(t))}else(t._pendingDfd=this.generateToken(this.findServerInfo(c.server),null,{serverUrl:t.resUrl_,token:c.token,signal:t.options_.signal,ssl:c.ssl})).then((i=>{e(new ko({userId:c?.userId,server:n.server,token:i.token,expires:null!=i.expires?Number(i.expires):null,ssl:!!i.ssl,isAdmin:t.admin_,validity:i.validity}))}),i)}else this._busy=null,o&&(t.options_.token=null),(t._pendingDfd=this.getCredential(r.replace(/\/?$/,"/sharing"),{resource:t.resUrl_,owningTenant:n.owningTenant,signal:t.options_.signal,token:o,error:a,prompt:u})).then((()=>{this._enqueue(t.resUrl_,t.sinfo_,t.options_,t,t.admin_)}),(e=>{t.resUrl_=t.sinfo_=t.refresh_=null,t.reject(e)}))};this._errbackFunc=i;const s=t.sinfo_.owningSystemUrl,o=this._isServerRsrc(t.resUrl_),u=t.sinfo_._restInfoPms;u?u.promise.then((e=>{const i=t.sinfo_;if(i._restInfoPms){i.adminTokenServiceUrl=i._restInfoPms.adminUrl,i._restInfoPms=null,i.tokenServiceUrl=(W("authInfo.tokenServicesUrl",e)||W("authInfo.tokenServiceUrl",e)||W("tokenServiceUrl",e))??null,i.shortLivedTokenValidity=W("authInfo.shortLivedTokenValidity",e)??null,i.currentVersion=e.currentVersion,i.owningTenant=e.owningTenant;const t=i.owningSystemUrl=e.owningSystemUrl;t&&this._portals.push(t)}o&&i.owningSystemUrl?r():n()}),(()=>{t.sinfo_._restInfoPms=null;const e=new a("identity-manager:server-identification-failed","Unknown resource - could not find token service endpoint.");i(e)})):o&&s?r():t.sinfo_._selfReq?t.sinfo_._selfReq.selfDfd.then((e=>{const i={};let n,r,s,o;return e&&(n=e.user&&e.user.username,i.username=n,i.allSSL=e.allSSL,r=e.supportsOAuth,o=parseFloat(e.currentVersion),"multitenant"===e.portalMode&&(s=e.customBaseUrl),t.sinfo_.currentVersion=o),t.sinfo_.webTierAuth=!!n,n&&this.normalizeWebTierAuth?this.generateToken(t.sinfo_,null,{ssl:i.allSSL}).catch((()=>null)).then((t=>(i.portalToken=t&&t.token,i.tokenExpiration=t&&t.expires,i))):!n&&r&&o>=4.4&&!this._findOAuthInfo(t.resUrl_)?this._generateOAuthInfo({portalUrl:t.sinfo_.server,customBaseUrl:s,owningTenant:t.sinfo_._selfReq.owningTenant}).catch((()=>null)).then((()=>i)):i})).catch((()=>null)).then((e=>{t.sinfo_._selfReq=null,e?n(e.username,e.allSSL,e.portalToken,e.tokenExpiration):n()})):n()}_generateOAuthInfo(t){let e,i=null,n=t.portalUrl;const r=t.customBaseUrl,s=t.owningTenant,o=!this._defaultOAuthInfo&&this._createDefaultOAuthInfo&&!this._hasTestedIfAppIsOnPortal;if(o){i=window.location.href;let t=i.indexOf("?");t>-1&&(i=i.slice(0,t)),t=i.search(/\/(apps|home)\//),i=t>-1?i.slice(0,t):null}return o&&i?(this._hasTestedIfAppIsOnPortal=!0,e=F(i+"/sharing/rest",{query:{f:"json"}}).then((()=>{this._defaultOAuthInfo=new ho({appId:"arcgisonline",popupCallbackUrl:i+"/home/oauth-callback.html"})}))):e=Promise.resolve(),e.then((()=>{if(this._defaultOAuthInfo)return n=n.replace(/^http:/i,"https:"),F(n+"/sharing/rest/oauth2/validateRedirectUri",{query:{accountId:s,client_id:this._defaultOAuthInfo.appId,redirect_uri:k(this._defaultOAuthInfo.popupCallbackUrl),f:"json"}}).then((t=>{if(t.data.valid){const e=this._defaultOAuthInfo.clone();e.portalUrl=t.data.urlKey&&r?"https://"+t.data.urlKey.toLowerCase()+"."+r:n,e.popup=window!==window.top||!(M(n,this._appOrigin)||this._gwDomains.some((t=>t.regex.test(n)&&t.regex.test(this._appOrigin)))),this.oAuthInfos.push(e)}}))}))}_doOAuthSignIn(t,e,i,n){const r=i._oAuthCred,s={portalUrl:i.portalUrl};!i.popup&&i.preserveUrlHash&&window.location.hash&&(s.hash=window.location.hash),r.stateUID&&(s.uid=r.stateUID);const o={client_id:i.appId,response_type:r.codeVerifier?"code":"token",state:JSON.stringify(s),expiration:i.expiration,locale:i.locale,redirect_uri:this._getRedirectURI(i,!!r.codeVerifier)};i.forceLogin&&(o.force_login=!0),i.forceUserId&&i.userId&&(o.prepopulatedusername=i.userId),!i.popup&&this._doPortalSignIn(t)&&(o.redirectToUserOrgUrl=!0),r.codeVerifier&&(o.code_challenge=n||r.codeVerifier,o.code_challenge_method=n?"S256":"plain");const u=i.portalUrl.replace(/^http:/i,"https:")+"/sharing/oauth2/authorize",c=u+"?"+B(o);if(i.popup){const t=window.open(c,"esriJSAPIOAuth",i.popupWindowFeatures);if(t)t.focus(),this._oAuthDfd.oAuthWin_=t,this._oAuthIntervalId=setInterval((()=>{if(t.closed){clearInterval(this._oAuthIntervalId),this._oAuthOnPopupHandle.remove();const t=this._oAuthDfd;if(t){const e=new a("identity-manager:user-aborted","ABORTED");t.reject(e)}}}),500),this._oAuthOnPopupHandle=T(window,["arcgis:auth:hash","arcgis:auth:location:search"],(t=>{"arcgis:auth:hash"===t.type?this.setOAuthResponseHash(t.detail):this._setOAuthResponseQueryString(t.detail)}));else{const t=new a("identity-manager:popup-blocked","ABORTED");this._oAuthDfd.reject(t)}}else this._rejectOnPersistedPageShow=!0,this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:o,authorizeUrl:u,resourceUrl:t,serverInfo:e,oAuthInfo:i}):window.location.href=c}_getRedirectURI(t,e){const i=window.location.href.replace(/#.*$/,"");if(t.popup)return k(t.popupCallbackUrl);if(e){const t=C(i);return t.query&&["code","error","error_description","message_code","persist","state"].forEach((e=>{delete t.query[e]})),Y(t.path,t.query)}return i}}bo.prototype.declaredClass="esri.identity.IdentityManagerBase";let ko=class extends Gi.EventedAccessor{constructor(t){super(t),this._oAuthCred=null,this.tokenRefreshBuffer=2,t&&t._oAuthCred&&(this._oAuthCred=t._oAuthCred)}initialize(){this.resources=this.resources||[],null==this.creationTime&&(this.creationTime=Date.now())}refreshToken(){const t=$.findServerInfo(this.server),e=t&&t.owningSystemUrl,i=!!e&&"server"===this.scope,n=i&&mo(t,$._legacyFed),r=t.webTierAuth,s=r&&$.normalizeWebTierAuth,o=go[this.server],a=o&&o[this.userId];let u,c=this.resources&&this.resources[0],l=i?$.findServerInfo(e):null,h={username:this.userId,password:a};if(r&&!s)return;i&&!l&&$.serverInfos.some((t=>($._isIdProvider(e,t.server)&&(l=t),!!l)));const f=l?$.findCredential(l.server,this.userId):null;if(!i||f){if(!n){if(i)u={serverUrl:c,token:f&&f.token,ssl:f&&f.ssl};else if(s)h=null,u={ssl:this.ssl};else{if(!a){let e;return c&&(c=$._sanitizeUrl(c),this._enqueued=1,e=$._enqueue(c,t,null,null,this.isAdmin,this),e.then((()=>{this._enqueued=0,this.refreshServerTokens()})).catch((()=>{this._enqueued=0}))),e}this.isAdmin&&(u={isAdmin:!0})}return $.generateToken(i?l:t,i?null:h,u).then((t=>{this.token=t.token,this.expires=null!=t.expires?Number(t.expires):null,this.creationTime=Date.now(),this.validity=t.validity,this.emitTokenChange(),this.refreshServerTokens()})).catch((()=>{}))}f?.refreshToken()}}refreshServerTokens(){"portal"===this.scope&&$.credentials.forEach((t=>{const e=$.findServerInfo(t.server),i=e&&e.owningSystemUrl;t!==this&&t.userId===this.userId&&i&&"server"===t.scope&&($._hasSameServerInstance(this.server,i)||$._isIdProvider(i,this.server))&&(mo(e,$._legacyFed)?(t.token=this.token,t.expires=this.expires,t.creationTime=this.creationTime,t.validity=this.validity,t.emitTokenChange()):t.refreshToken())}))}emitTokenChange(t){clearTimeout(this._refreshTimer);const e=this.server&&$.findServerInfo(this.server),i=e&&e.owningSystemUrl,n=i&&$.findServerInfo(i);!1===t||i&&"portal"!==this.scope&&(!n||!n.webTierAuth||$.normalizeWebTierAuth)||null==this.expires&&null==this.validity||this._startRefreshTimer(),this.emit("token-change")}destroy(){this.userId=this.server=this.token=this.expires=this.validity=this.resources=this.creationTime=null,this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);const t=$.credentials.indexOf(this);t>-1&&$.credentials.splice(t,1),this.emitTokenChange(),this.emit("destroy")}toJSON(){const t=U({userId:this.userId,server:this.server,token:this.token,expires:this.expires,validity:this.validity,ssl:this.ssl,isAdmin:this.isAdmin,creationTime:this.creationTime,scope:this.scope}),e=this.resources;return e&&e.length>0&&(t.resources=e.slice()),t}_startRefreshTimer(){clearTimeout(this._refreshTimer);const t=6e4*this.tokenRefreshBuffer,e=2**31-1;let i=(this.validity?this.creationTime+6e4*this.validity:this.expires)-Date.now();i<0?i=0:i>e&&(i=e),this._refreshTimer=setTimeout(this.refreshToken.bind(this),i>t?i-t:i)}};Z([oi()],ko.prototype,"creationTime",void 0),Z([oi()],ko.prototype,"expires",void 0),Z([oi()],ko.prototype,"isAdmin",void 0),Z([oi()],ko.prototype,"oAuthState",void 0),Z([oi()],ko.prototype,"resources",void 0),Z([oi()],ko.prototype,"scope",void 0),Z([oi()],ko.prototype,"server",void 0),Z([oi()],ko.prototype,"ssl",void 0),Z([oi()],ko.prototype,"token",void 0),Z([oi()],ko.prototype,"tokenRefreshBuffer",void 0),Z([oi()],ko.prototype,"userId",void 0),Z([oi()],ko.prototype,"validity",void 0),ko=Z([Ci("esri.identity.Credential")],ko);class xo extends bo{}xo.prototype.declaredClass="esri.identity.IdentityManager";const Ao=new xo;X(Ao);export default Ao;