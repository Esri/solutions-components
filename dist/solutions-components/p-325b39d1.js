/*!
 * Copyright 2022 Esri
 * Licensed under the Apache License, Version 2.0
 * http://www.apache.org/licenses/LICENSE-2.0
 */
import{g as t}from"./p-a458e487.js";import{h as s,a as i,t as e}from"./p-dd3d070d.js";import{S as n}from"./p-96397baa.js";import{d as o}from"./p-4e32bf8c.js";import{h as a,H as r}from"./p-f8be5d5f.js";import{C as l,S as c}from"./p-14da4ba2.js";
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.2.0
 */function h(){this.setUpItems(),this.setUpFilter(),this.deselectRemovedItems()}const u=["ArrowUp","ArrowDown"];function f(){this.setUpItems(),this.setUpFilter(),this.emitCalciteListChange=o(x.bind(this),0),this.emitCalciteListFilter=o(j.bind(this),0)}function d(){this.mutationObserver?.observe(this.el,{childList:!0,subtree:!0})}function m(){this.mutationObserver?.disconnect()}function p(t){const{selectedValues:i}=this,{item:e,value:n,selected:o,shiftPressed:a}=t.detail;o?(this.multiple&&a&&this.selectSiblings(e),this.multiple||this.deselectSiblingItems(e),i.set(n,e)):(i.delete(n),this.multiple&&a&&this.selectSiblings(e,!0)),this.multiple||(C(e,o),o&&s(e)),this.lastSelectedItem=e,this.emitCalciteListChange()}function b(t){const s=t.detail.oldValue,i=this.selectedValues;if(i.has(s)){const e=i.get(s);i.delete(s),i.set(t.detail.newValue,e)}t.stopPropagation()}function v(t){const{el:s,items:i,multiple:e,selectedValues:n}=this;e||s.contains(t.relatedTarget)||A(i).forEach((s=>{C(s,0===n.size?s.contains(t.target)||t.target===s:s.selected)}))}function g(t){const{key:i,target:e}=t;if(!function(t){return!!u.find((s=>s===t))}(i))return;const{items:n,multiple:o,selectionFollowsFocus:a}=this,{length:r}=n,l=n.indexOf(e);if(!r||-1===l)return;t.preventDefault();const c=n[w(this,e,"ArrowUp"===i?"up":"down")];n.forEach((t=>C(t,t===c))),!o&&a&&(c.selected=!0),s(c)}function w(s,i,e){const{items:n}=s,{length:o}=n,a=n.indexOf(i),r="up"===e?-1:1;let l=1,c=t(a+r*l++,o);const h=c;for(;n[c].disabled&&(c=t(a+r*l++,o),c!==h););return c}function F(t,s){const{items:i}=t;return i.indexOf(s)}function A(t){return t.filter((t=>!t.disabled))}function j(){this.calciteListFilter.emit()}function x(){this.calciteListChange.emit(this.selectedValues)}function y(t){if(t.defaultPrevented)return;const s=t.target,i=this.selectedValues;"CALCITE-PICK-LIST-GROUP"===s.parentElement.tagName&&s.slot===n.parentItem?(s.parentElement.remove(),Array.from(s.parentElement.children).forEach((t=>i.delete(t.value)))):(s.remove(),i.delete(s.value)),this.emitCalciteListChange()}function C(t,s){t.disabled||(s?t.removeAttribute("tabindex"):t.setAttribute("tabindex","-1"))}async function E(t){if(this.filterEnabled&&"filter"===t)return void await s(this.filterEl);const{items:i,multiple:e,selectionFollowsFocus:n}=this;if(0===i.length)return;if(e)return A(i)[0]?.setFocus();const o=A(i),a=o.find((t=>t.selected))||o[0];return n&&a&&(a.selected=!0),a.setFocus()}function I(t){this.items=Array.from(this.el.querySelectorAll(t));let s=!1;const{items:i}=this;i.forEach((t=>{t.icon=this.getIconType(),this.multiple||(t.deselectDisabled=!0,C(t,!1)),t.selected&&(s=!0,C(t,!0),this.selectedValues.set(t.value,t))}));const[e]=i;s||!e||e.disabled||C(e,!0)}function L(){const t=this.selectedValues,s=this.items.map((({value:t})=>t));t.forEach((t=>{s.includes(t.value)||this.selectedValues.delete(t.value)}))}function P(t){this.items.forEach((s=>{s.value!==t.value&&(s.toggleSelected(!1),this.selectedValues.has(s.value)&&this.selectedValues.delete(s.value))}))}function S(t,s=!1){if(!this.lastSelectedItem)return;const{items:i}=this,e=i.findIndex((t=>t.value===this.lastSelectedItem.value)),n=i.findIndex((s=>s.value===t.value));i.slice(Math.min(e,n),Math.max(e,n)).forEach((t=>{t.toggleSelected(!s),s?this.selectedValues.delete(t.value):this.selectedValues.set(t.value,t)}))}let T;function k(t=!1){const{filteredData:s,filterText:e}=this,n=s.map((t=>t.value));let o=!1;T||(T=new Set);const a=this.items?.filter((t=>{const s=t.parentElement;s.matches("calcite-pick-list-group")&&T.add(s);const i=!e||n.includes(t.value);return t.hidden=!i,o||(o=i&&t.selected),i}))||[];T.forEach((t=>{const s=a.some((s=>t.contains(s)));if(t.hidden=!s,!s)return;const e=i(t,"parent-item");e&&(e.hidden=!1,a.includes(e)&&Array.from(t.children).forEach((t=>t.hidden=!1)))})),T.clear(),a.length>0&&!o&&!this.multiple&&C(a[0],!0),this.setFilteredItems(a),t&&this.emitCalciteListFilter()}function U(){const t=this.filterEl?.filteredItems;t&&(this.filteredData=t),this.handleFilter()}function D(t){t.stopPropagation();const{filteredItems:s,value:i}=t.currentTarget;this.filterText=i,this.filteredData=s,this.handleFilter(!0)}function M(){return this.items.map((t=>({label:t.label,description:t.description,metadata:t.metadata,value:t.value})))}
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.2.0
 */const V=({props:{disabled:t,loading:s,filterEnabled:i,dataForFilter:n,handleFilterEvent:o,filterPlaceholder:h,filterText:u,setFilterEl:f,dragEnabled:d,storeAssistiveEl:m},...p})=>{const b=a("slot",null);return a(r,{"aria-busy":e(s),role:"menu",...p},a("section",null,d?a("span",{"aria-live":"assertive",class:"assistive-text",ref:m}):null,a("header",{class:{[l.sticky]:!0}},i?a("calcite-filter",{"aria-label":h,disabled:s||t,items:n,onCalciteFilterChange:o,placeholder:h,value:u,ref:f}):null,a("slot",{name:c.menuActions})),s?a("calcite-scrim",{loading:s}):null,b))};export{V as L,P as a,D as b,d as c,L as d,m as e,U as f,M as g,k as h,f as i,p as j,g as k,b as l,h as m,v as n,I as o,E as p,F as q,y as r,S as s,w as t}