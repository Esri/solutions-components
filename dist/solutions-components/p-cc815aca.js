/*!
 * Copyright 2022 Esri
 * Licensed under the Apache License, Version 2.0
 * http://www.apache.org/licenses/LICENSE-2.0
 */
/** @license
 * Copyright 2022 Esri
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var e,n;function t(t,o,c,r=!1){const u=parseInt(t),s=e[o],D=parseFloat(c.toString());if(Number.isNaN(D)||0===D)return"";const H=!0===r||"true"===r.toString().toLowerCase();let M;switch(u){case n.ALLIGATOR_CRACKING:M=i;break;case n.BLEEDING:M=l;break;case n.BLOCK_CRACKING:M=f;break;case n.BUMPS_SAGS:M=d;break;case n.CORRUGATION:M=b;break;case n.DEPRESSION:M=I;break;case n.EDGE_CRACKING:M=$;break;case n.REFLECTION_CRACKING:M=A;break;case n.LANE_SHOULDER_DROP_OFF:M=C;break;case n.LONG_TRANS_CRACKING:M=G;break;case n.PATCHING_UTIL_CUT_PATCHING:M=R;break;case n.POLISHED_AGGREGATE:M=N;break;case n.POTHOLES:M=h;break;case n.RAILROAD_CROSSING:M=p;break;case n.RUTTING:M=E;break;case n.SHOVING:M=O;break;case n.SLIPPAGE_CRACKING:M=k;break;case n.SWELL:M=L;break;case n.RAVELING:M=v;break;case n.WEATHERING:M=_}const S=M(s,Math.log10(D)),T=a(S),m=`${t}|${o}|${T}|${D}`;return H&&(console.log(`Deduct value: ${S}`),console.log(`Rounded deduct value: ${T}`),console.log(`Formatted devduct value (type|severity|roundedDV|density): ${m}`)),m}function o(e,n=!1){let t=e.indexOf("|")>-1?function(e,n){const t={},o=function(e){return e.split(",").reduce(((e,n)=>{const t=n.split("|"),o=t[0],c=t[1],r=parseFloat(t[2]),u=parseFloat(t[3]);return e[o]||(e[o]={}),e[o][c]={deductValue:r,density:u},e}),{})}(e),u=Object.keys(o).filter((e=>Object.keys(o[e]).length>1));return u.length>0&&u.forEach((e=>{let u,s,a,i,l,f;Object.keys(o[e]).forEach((n=>{"H"===n?(u=o[e][n].deductValue,i=o[e][n].density):"M"===n?(s=o[e][n].deductValue,l=o[e][n].density):(a=o[e][n].deductValue,f=o[e][n].density)}));const d=(i&&l&&f?c:r)(e,u,s,a,i,l,f,n);d&&(t[e]=d,n&&(console.log("updates"),console.log(t)))})),function(e,n){const t=[];return e.split(",").reduce(((e,o)=>{const c=o.split("|"),r=c[0],u=parseFloat(c[2]);return Object.keys(n).length>0&&n[r]?(t.push(r),e.push(...n[r]),delete n[r]):t.indexOf(r)<0&&e.push(u),e}),[])}(e,t)}(e,n):e.split(",").map((e=>parseFloat(e)));const o=!0===n||"true"===n.toString().toLowerCase();let u=0;if(t=t.filter((e=>Math.abs(e)>0)),t.length>0){const e=function(e,n){let t;const o=e.filter((e=>e>2));if(o.length<=1)t=o.reduce(((e,n)=>e+n),0),n&&(console.log("If none or only one individual deduct value is greater"),console.log("than two, the total value is used in place of the maximum CD"),console.log(`Max CDV: ${t}`));else{const o=e.sort(((e,n)=>n-e)),c=o[0],r=1+9/98*(100-c);if(n&&(console.log(`Deduct values sorted in descending order: ${o}`),console.log(`Highest deduct value: ${c}`),console.log(`Allowable number of deducts including fractions: ${r}`)),r<=10){const e=function(e,n){const t=n-Math.floor(n);return e.length<n?e:e.reduce(((e,o,c)=>(c+1<n?e.push(o):t>0&&e.push(a(o*t)),e)),[])}(o,r);n&&console.log(`Reduce deduct values to the m largest including the fractional part: ${e}`);const c=function(e,n){let t=e.length;const o=[];for(;t>=1;)n&&console.log(`vals: ${e}`),o.push(D(e,n)),t-=1,e.splice(t,1,2);return o}(e,n);t=Math.max(...c),n&&console.log(`Max CDV: ${t}`)}else n&&console.log("Allowable number of deducts including fractions (must be less than or equal to ten)")}return t}(t,o);u=100-a(e)}return u}function c(e,n,t,c,r,s,a,i){const l=o(`${n},${t},${c}`,!0);i&&(console.log("pci1"),console.log(l));const f=u(e,"M",(a+s).toString(),n,i),d=u(e,"H",(s+r).toString(),c,i),b=u(e,"H",(a+r).toString(),t,i),I=u(e,"H",(a+s+r).toString(),0,i);i&&(console.log("low med pci2"),console.log(f.pci),console.log("med high pci2"),console.log(d.pci),console.log("low high pci2"),console.log(b.pci),console.log("low med high pci2"),console.log(I.pci));const $=[f,d,b,I].reduce(((e,n)=>n.pci>l&&(!e||n.pci>e.pci)?n:e),void 0);return $?$.dv:void 0}function r(e,n,t,c,r,s,a,i){const l=o(`${n||t},${c||t}`,!0);i&&(console.log("pci1"),console.log(l));const f=r||s,d=u(e,f===r?"H":"M",(f+(a||s)).toString(),0,i);return i&&(console.log("pci2"),console.log(d.pci)),d.pci>l?d.dv:void 0}function u(e,n,c,r,u){const s=t(e,n,c).split("|"),a=parseFloat(s[2]);return{pci:o(`${s[2]},${r}`,u),dv:r?[a,r]:[a]}}function s(e,n){return n.reduce(((n,t,o)=>n+(0===o?t:1===o?t*e:t*Math.pow(e,o))),0)}function a(e){return Math.round(10*e)/10}function i(n,t){return s(t,n===e.H?[30.71,29.22,9.407,-6.981,-2.158,3.047,-.6578]:n===e.M?[21.62,21.32,5.194,-1.343,.2341]:[11.31,16.05,7.572,-1.471])}function l(n,t){return s(t,n===e.H?[5.343,6.927,7.926,4.265,-.7582]:n===e.M?[2.38,5.483,4.128,.8366,.03659,.1052]:[.01391,.5079,1.576,1.191,.1329,.03823])}function f(n,t){return s(t,n===e.H?[7.926,11.93,8.826,3.432,-1.382]:n===e.M?[2.587,9.142,6.647,-.455,-.2439,.1107]:[.646,4.002,4.2,.4987,-.06269])}function d(n,t){return s(t,n===e.H?[52.77,38.07,8.964,-.4148,-1.589,2.478]:n===e.M?[24.66,27.86,15.73,3.295,-5.27,5.921,7.959]:[8.768,13.79,7.064,7.455,6.041,-1.739,-1.371])}function b(n,t){return s(t,n===e.H?[34.21,21.59,1.863,6.141,-.687,-1.885,.4916]:n===e.M?[15.78,19.69,6.276,-2.124,.5868,.06045]:[2.173,5.609,5.976,-.7348,-.2172,1.494,-.5659])}function I(n,t){return s(t,n===e.H?[17.84,5.904,9.406,18.28,-2.753,-7.798,2.402]:n===e.M?[8.471,3.171,10.25,12.2,-.9687,-4.601,1.079]:[4.836,-.7572,4.786,12.39,1.233,-4.871,.9749])}function $(n,t){return s(t,n===e.H?[14.99,13.5,10.62,5.15,-1.792,-2.826]:n===e.M?[9.177,10.26,5.704,-.6812,-.8588,.2123]:[3.049,4.802,4.058,-.3556,-1.55,1.02])}function A(n,t){return s(t,n===e.H?[14.99,17.21,27.63,31.13,-20.94,-18.82,9.985]:n===e.M?[9.9193,10.88,8.073,14.8,-3.792,-9.583,3.651]:[2.356,6.664,3.717,-1.393,1.94,1.785,-.9707])}function C(n,t){return s(t,n===e.H?[7.549,6.907,7.284,9.304,2.064]:n===e.M?[4.02,1.744,14.36,15.92,-40.22,23.6]:[2.004,1.065,9.706,11.75,-27.52,15.04])}function G(n,t){return s(t,n===e.H?[19.56,24.06,12.12,9.336,1.532,-4.396]:n===e.M?[9.751,15.53,4.719,1.369,1.206,-1.164]:[2.347,9.074,8.424,-1.338,-1.873,1.144])}function R(n,t){return s(t,n===e.H?[20.15,16.55,5.415,10.77,3.257,-4.502]:n===e.M?[10.28,12.71,6.174,1.928,.6923,-.4673]:[2.523,6.892,5.702,2.407,.2185,-.8722])}function N(e,n){return s(n,"H"===e||"M"===e||"L"===e?[3.417,-26.82,71.15,-76.22,38.52,-6.904]:[])}function h(n,t){return s(t,n===e.H?[110.7,60.66,2.378,-2.664]:n===e.M?[90.47,60.41,-.1123,-4.746]:[58.19,40.53,2.884,-1.443,.1195])}function p(n,t){return s(t,n===e.H?[20,38.64,-62.82,193.6,-162.7,41.22]:n===e.M?[6.994,23.47,-52.3,167.3,-143.6,37.64]:[1.998,-.7488,13.8,-.7917,-1.981])}function E(n,t){return s(t,n===e.H?[27.61,25.19,8.557,1.65,-2.203]:n===e.M?[18.47,20.77,6.617,-1.13,-2.286]:[8.833,14.84,3.129,.1451,2.438,-1.279])}function O(n,t){return s(t,n===e.H?[18.7,20.17,10.3,4.694,1.331,-2.61]:n===e.M?[10.39,14.78,5.488,4.001,3.23,-2.387]:[4.002,10.66,6.332,-.5226,-.1923])}function k(n,t){return s(t,n===e.H?[19.73,32.21,25.87,-2.871,-10.55,1.496,.7393]:n===e.M?[11.38,18.55,18.38,1.628,-7.596,.5841,.5946]:[5.144,12.95,11.95,-.833,-2.995,1.325,-.2113])}function L(n,t){return s(t,n===e.H?[34,16.84,-23.09,41.17,-14.84]:n===e.M?[12,15.67,20.59,-28.33,21,-5.508]:[1.995,11.9,-12.83,16.74,-5.361])}function v(n,t){return s(t,n===e.H?[16.77,10.67,5.758,12.9,-.0633,-5.659,1.48]:n===e.M?[8.512,5.106,1.63,3.469,1.028,-1.211,.1938]:[])}function _(n,t){return s(t,n===e.H?[3.673,3.349,2.598,-1.233,2.754,2.434,-1.485]:n===e.M?[1.12,.9769,.93,-.5955,1.041,1.111,-.614]:[-.0386,-.0736,.834,1.63,-.0287,-.639,.1515])}function D(e,n){return function(e,n,t){const o=s(e,{7:[-9.482,.6045,3563e-7,-5448e-9],6:[-8.165,.5724,4266e-7,-4254e-9],5:[-7.932,.6091,3464e-7,-4265e-9],4:[-6.78,.6301,7376e-7,-6357e-9],3:[-5.015,.7546,-43e-5,-3075e-9],2:[-1.668,.7992,-3013e-7,-5214e-9],1:[1651e-18,1,-4249e-21,1149e-22]}[n>=7?7:n]);return t&&(console.log(`totalDV: ${e}`),console.log(`q: ${n}`),console.log(`CDV: ${o}`)),o}(e.reduce(((e,n)=>e+n),0),e.reduce(((e,n)=>n>2?e+1:e),0),n)}!function(e){e.H="H",e.M="M",e.L="L"}(e||(e={})),function(e){e[e.ALLIGATOR_CRACKING=1]="ALLIGATOR_CRACKING",e[e.BLEEDING=2]="BLEEDING",e[e.BLOCK_CRACKING=3]="BLOCK_CRACKING",e[e.BUMPS_SAGS=4]="BUMPS_SAGS",e[e.CORRUGATION=5]="CORRUGATION",e[e.DEPRESSION=6]="DEPRESSION",e[e.EDGE_CRACKING=7]="EDGE_CRACKING",e[e.REFLECTION_CRACKING=8]="REFLECTION_CRACKING",e[e.LANE_SHOULDER_DROP_OFF=9]="LANE_SHOULDER_DROP_OFF",e[e.LONG_TRANS_CRACKING=10]="LONG_TRANS_CRACKING",e[e.PATCHING_UTIL_CUT_PATCHING=11]="PATCHING_UTIL_CUT_PATCHING",e[e.POLISHED_AGGREGATE=12]="POLISHED_AGGREGATE",e[e.POTHOLES=13]="POTHOLES",e[e.RAILROAD_CROSSING=14]="RAILROAD_CROSSING",e[e.RUTTING=15]="RUTTING",e[e.SHOVING=16]="SHOVING",e[e.SLIPPAGE_CRACKING=17]="SLIPPAGE_CRACKING",e[e.SWELL=18]="SWELL",e[e.RAVELING=19]="RAVELING",e[e.WEATHERING=20]="WEATHERING"}(n||(n={}));export{n as E,e as a,t as b,o as c}