/*!
 * Copyright 2022 Esri
 * Licensed under the Apache License, Version 2.0
 * http://www.apache.org/licenses/LICENSE-2.0
 */
import{r as t,h as e,H as i,g as n,c as o}from"./p-c2f00d41.js";import{s as r,g as s,a}from"./p-83166522.js";import{S as l}from"./p-6fe17794.js";import{c,d as h}from"./p-1c247f54.js";import{l as u}from"./p-4557725d.js";import{g as d,h as f,d as m,e as p,q as g}from"./p-3c449907.js";import{E as y,f as b,g as w,c as v}from"./p-be41429f.js";import{s as k}from"./p-4557d5a8.js";import{g as x}from"./p-4aaa2132.js";import{a as S,g as T}from"./p-fc884dd6.js";
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.0-beta.97
 */var D;!function(t){t.valid="check-circle",t.invalid="exclamation-mark-triangle",t.idle="information"}(D||(D={}));const P=class{constructor(e){t(this,e),this.active=!1,this.scale="m",this.status="idle"}handleIconEl(){this.requestedIcon=r(D,this.icon,this.status)}connectedCallback(){this.status=s(this.el,"status",this.status),this.scale=s(this.el,"scale",this.scale),this.requestedIcon=r(D,this.icon,this.status)}render(){return e(i,{"calcite-hydrated-hidden":!this.active},this.renderIcon(this.requestedIcon),e("slot",null))}renderIcon(t){if(t)return e("calcite-icon",{class:"calcite-input-message-icon",icon:t,scale:"s"})}get el(){return n(this)}static get watchers(){return{status:["handleIconEl"],icon:["handleIconEl"]}}};P.style="@keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in-down{0%{opacity:0;transform:translate3D(0, -5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;transform:translate3D(0, 5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-scale{0%{opacity:0;transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;animation-fill-mode:both;animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{animation-name:in}.calcite-animate__in-down{animation-name:in-down}.calcite-animate__in-up{animation-name:in-up}.calcite-animate__in-scale{animation-name:in-scale}@media (prefers-reduced-motion: reduce){:root{--calcite-internal-duration-factor:0.01}}:root{--calcite-floating-ui-transition:var(--calcite-animation-timing)}:host([hidden]){display:none}:host([active][scale=m]),:host([active][scale=l]){--calcite-input-message-spacing-value:0.25rem}:host{visibility:hidden;box-sizing:border-box;display:flex;block-size:0px;inline-size:100%;align-items:center;font-weight:var(--calcite-font-weight-medium);color:var(--calcite-ui-text-1);opacity:0;transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s}:host([active]){visibility:visible;block-size:auto;opacity:1;transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s}:host([active][scale=m]),:host([active][scale=l]){-webkit-margin-before:var(--calcite-input-message-spacing-value);margin-block-start:var(--calcite-input-message-spacing-value)}:host([calcite-hydrated-hidden]){visibility:hidden !important;pointer-events:none}.calcite-input-message-icon{pointer-events:none;display:inline-flex;flex-shrink:0;transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s;-webkit-margin-end:0.5rem;margin-inline-end:0.5rem}:host([status=invalid]) .calcite-input-message-icon{color:var(--calcite-ui-danger)}:host([status=warning]) .calcite-input-message-icon{color:var(--calcite-ui-warning)}:host([status=valid]) .calcite-input-message-icon{color:var(--calcite-ui-success)}:host([status=idle]) .calcite-input-message-icon{color:var(--calcite-ui-brand)}:host([status][active]){color:var(--calcite-ui-text-1)}:host([status][scale=s]){font-size:var(--calcite-font-size--3);line-height:0.75rem}:host([status][scale=m]){-webkit-margin-before:0.25rem;margin-block-start:0.25rem;font-size:var(--calcite-font-size--2);line-height:1rem}:host([status][scale=l]){-webkit-margin-before:0.25rem;margin-block-start:0.25rem;font-size:var(--calcite-font-size--1);line-height:1rem}";
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.0-beta.97
 */
const A="actions-end",L=class{constructor(e){t(this,e),this.calciteNoticeClose=o(this,"calciteNoticeClose",6),this.calciteNoticeOpen=o(this,"calciteNoticeOpen",6),this.active=!1,this.open=!1,this.color="blue",this.dismissible=!1,this.closable=!1,this.intlClose="Close",this.scale="m",this.width="auto",this.close=()=>{this.open=!1,this.calciteNoticeClose.emit()}}activeHandler(t){this.open=t}openHandler(t){this.active=t}handleDismissible(t){this.closable=t}handleClosable(t){this.dismissible=t}updateRequestedIcon(){this.requestedIcon=r(l,this.icon,this.color)}connectedCallback(){c(this);const t=this.active||this.open;t&&(this.activeHandler(t),this.openHandler(t)),this.dismissible&&this.handleDismissible(this.dismissible),this.closable&&this.handleClosable(this.closable)}disconnectedCallback(){h(this)}componentWillLoad(){this.requestedIcon=r(l,this.icon,this.color)}render(){const{el:t}=this,i=e("button",{"aria-label":this.intlClose,class:"notice-close",onClick:this.close,ref:t=>this.closeButton=t},e("calcite-icon",{icon:"x",scale:"l"===this.scale?"m":"s"})),n=a(t,A);return e("div",{class:"container"},this.requestedIcon?e("div",{class:"notice-icon"},e("calcite-icon",{icon:this.requestedIcon,scale:"l"===this.scale?"m":"s"})):null,e("div",{class:"notice-content"},e("slot",{name:"title"}),e("slot",{name:"message"}),e("slot",{name:"link"})),n?e("div",{class:"actions-end"},e("slot",{name:A})):null,this.closable?i:null)}async setFocus(){const t=this.el.querySelector("calcite-link");(this.closeButton||t)&&(t?t.setFocus():this.closeButton&&this.closeButton.focus())}get el(){return n(this)}static get watchers(){return{active:["activeHandler"],open:["openHandler"],dismissible:["handleDismissible"],closable:["handleClosable"],icon:["updateRequestedIcon"],color:["updateRequestedIcon"]}}};L.style="@keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in-down{0%{opacity:0;transform:translate3D(0, -5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;transform:translate3D(0, 5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-scale{0%{opacity:0;transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;animation-fill-mode:both;animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{animation-name:in}.calcite-animate__in-down{animation-name:in-down}.calcite-animate__in-up{animation-name:in-up}.calcite-animate__in-scale{animation-name:in-scale}@media (prefers-reduced-motion: reduce){:root{--calcite-internal-duration-factor:0.01}}:root{--calcite-floating-ui-transition:var(--calcite-animation-timing)}:host([hidden]){display:none}:host([scale=s]){--calcite-notice-spacing-token-small:0.5rem;--calcite-notice-spacing-token-large:0.75rem}:host([scale=s]) .container slot[name=title]::slotted(*),:host([scale=s]) .container *::slotted([slot=title]){margin-block:0.125rem;font-size:var(--calcite-font-size--1);line-height:1.375}:host([scale=s]) .container slot[name=message]::slotted(*),:host([scale=s]) .container *::slotted([slot=message]){margin-block:0.125rem;font-size:var(--calcite-font-size--2);line-height:1.375}:host([scale=s]) ::slotted(calcite-link){margin-block:0.125rem;font-size:var(--calcite-font-size--2);line-height:1.375}:host([scale=s]) .notice-close{padding:0.5rem}:host([scale=m]){--calcite-notice-spacing-token-small:0.75rem;--calcite-notice-spacing-token-large:1rem}:host([scale=m]) .container slot[name=title]::slotted(*),:host([scale=m]) .container *::slotted([slot=title]){margin-block:0.125rem;font-size:var(--calcite-font-size-0);line-height:1.375}:host([scale=m]) .container slot[name=message]::slotted(*),:host([scale=m]) .container *::slotted([slot=message]){margin-block:0.125rem;font-size:var(--calcite-font-size--1);line-height:1.375}:host([scale=m]) ::slotted(calcite-link){margin-block:0.125rem;font-size:var(--calcite-font-size--1);line-height:1.375}:host([scale=l]){--calcite-notice-spacing-token-small:1rem;--calcite-notice-spacing-token-large:1.25rem}:host([scale=l]) .container slot[name=title]::slotted(*),:host([scale=l]) .container *::slotted([slot=title]){margin-block:0.125rem;font-size:var(--calcite-font-size-1);line-height:1.375}:host([scale=l]) .container slot[name=message]::slotted(*),:host([scale=l]) .container *::slotted([slot=message]){margin-block:0.125rem;font-size:var(--calcite-font-size-0);line-height:1.375}:host([scale=l]) ::slotted(calcite-link){margin-block:0.125rem;font-size:var(--calcite-font-size-0);line-height:1.375}:host([width=auto]){--calcite-notice-width:auto}:host([width=half]){--calcite-notice-width:50%}:host([width=full]){--calcite-notice-width:100%}:host{margin-inline:auto;display:none;max-inline-size:100%;align-items:center;inline-size:var(--calcite-notice-width)}.container{pointer-events:none;margin-block:0px;box-sizing:border-box;display:none;inline-size:100%;background-color:var(--calcite-ui-foreground-1);opacity:0;transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s;max-block-size:0;text-align:start;-webkit-border-start:0px solid;border-inline-start:0px solid;box-shadow:0 0 0 0 transparent}.notice-close{outline-color:transparent}.notice-close:focus{outline:2px solid var(--calcite-ui-brand);outline-offset:-2px}:host{display:flex}:host([open]) .container{pointer-events:auto;display:flex;max-block-size:100%;align-items:center;border-width:2px;opacity:1;--tw-shadow:0 4px 8px -1px rgba(0, 0, 0, 0.08), 0 2px 4px -1px rgba(0, 0, 0, 0.04);--tw-shadow-colored:0 4px 8px -1px var(--tw-shadow-color), 0 2px 4px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.container slot[name=title]::slotted(*),.container *::slotted([slot=title]){margin:0px;font-weight:var(--calcite-font-weight-medium);color:var(--calcite-ui-text-1)}.container slot[name=message]::slotted(*),.container *::slotted([slot=message]){margin:0px;display:inline;font-weight:var(--calcite-font-weight-normal);color:var(--calcite-ui-text-2);-webkit-margin-end:var(--calcite-notice-spacing-token-small);margin-inline-end:var(--calcite-notice-spacing-token-small)}.notice-content{box-sizing:border-box;transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s;padding-inline:var(--calcite-notice-spacing-token-large);flex:0 0 auto;display:flex;min-inline-size:0px;flex-direction:column;overflow-wrap:break-word;flex:1 1 0;padding-block:var(--calcite-notice-spacing-token-small);padding-inline:0 var(--calcite-notice-spacing-token-small)}.notice-content:first-of-type:not(:only-child){-webkit-padding-start:var(--calcite-notice-spacing-token-large);padding-inline-start:var(--calcite-notice-spacing-token-large)}.notice-content:only-of-type{padding-block:var(--calcite-notice-spacing-token-small);padding-inline:var(--calcite-notice-spacing-token-large)}.notice-icon{display:flex;align-items:center;box-sizing:border-box;transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s;padding-block:var(--calcite-notice-spacing-token-small);padding-inline:var(--calcite-notice-spacing-token-large);flex:0 0 auto}.notice-close{display:flex;cursor:pointer;align-items:center;align-self:stretch;border-style:none;background-color:transparent;color:var(--calcite-ui-text-3);outline:2px solid transparent;outline-offset:2px;box-sizing:border-box;transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s;padding-block:var(--calcite-notice-spacing-token-small);padding-inline:var(--calcite-notice-spacing-token-large);flex:0 0 auto;-webkit-appearance:none}.notice-close:hover,.notice-close:focus{background-color:var(--calcite-ui-foreground-2);color:var(--calcite-ui-text-1)}.notice-close:active{background-color:var(--calcite-ui-foreground-3)}.actions-end{display:flex;align-self:stretch}:host([color=blue]) .container{border-color:var(--calcite-ui-brand)}:host([color=blue]) .container .notice-icon{color:var(--calcite-ui-brand)}:host([color=red]) .container{border-color:var(--calcite-ui-danger)}:host([color=red]) .container .notice-icon{color:var(--calcite-ui-danger)}:host([color=yellow]) .container{border-color:var(--calcite-ui-warning)}:host([color=yellow]) .container .notice-icon{color:var(--calcite-ui-warning)}:host([color=green]) .container{border-color:var(--calcite-ui-success)}:host([color=green]) .container .notice-icon{color:var(--calcite-ui-success)}";const M=class{constructor(e){t(this,e),this.selectionSetChange=o(this,"selectionSetChange",7),this.sketchTypeChange=o(this,"sketchTypeChange",7),this.workflowTypeChange=o(this,"workflowTypeChange",7),this._selectedIds=[],this._selectionLabel="",this.enabledLayerIds=[],this.defaultBufferDistance=void 0,this.defaultBufferUnit=void 0,this.geometries=void 0,this.isUpdate=!1,this.mapView=void 0,this.searchConfiguration=void 0,this.selectionSet=void 0,this.selectLayerView=void 0,this.showBufferTools=!0,this._layerSelectChecked=void 0,this._searchTerm=void 0,this._translations=void 0,this._workflowType=void 0}async watchGeometriesHandler(t,e){if(t!==e){if(t.length>0)return this._geomQuery(this.geometries);if(0===t.length)return this._clearResults(!0,!0)}}async workflowTypeHandler(t,e){t!==e&&(this.mapView.popup.autoOpenEnabled=["SELECT","SKETCH","REFINE"].indexOf(t)<0,this.workflowTypeChange.emit(t))}async clearSelection(){return this._clearResults()}async getSelection(){/\S+/gm.test(this._selectionLabel)||(this._selectionLabel=this._getSelectionBaseLabel());const t=this._selectionLabel===this._getSelectionBaseLabel();return{id:this.isUpdate?this.selectionSet.id:Date.now(),workflowType:this._workflowType,searchResult:this._searchResult,buffer:this._bufferGeometry,distance:this._bufferTools.distance,download:!0,unit:this._bufferTools.unit,label:this._workflowType===y.SEARCH||this._selectionLabel&&!t?this._selectionLabel:`${this._selectionLabel} ${this._bufferTools.distance} ${this._bufferTools.unit}`,selectedIds:this._selectedIds,layerView:this.selectLayerView,geometries:this.geometries,refineSelectLayers:this._refineTools.layerViews}}labelChange(t){this._selectionLabel=t.detail}sketchGraphicsChange(t){this._updateSelection(y.SKETCH,t.detail,this._selectionLabel||this._translations.sketch)}refineSelectionGraphicsChange(t){const e=t.detail;this._updateSelection(y.SELECT,e,this._selectionLabel||this._translations.select);const i=Array.isArray(e)?e.map((t=>t.attributes[t.layer.objectIdField])):[];return this._highlightFeatures(i)}async componentWillLoad(){await this._getTranslations(),await this._initModules()}async componentDidLoad(){return this._init()}render(){var t,n;const o=this._workflowType===y.SEARCH,r=o?" div-visible-search":" div-not-visible",s=this._workflowType===y.SKETCH||this._workflowType===y.SELECT,a=this.showBufferTools?"search-distance":"div-not-visible",l=this._layerSelectChecked&&!o?" div-visible":" div-not-visible",c=this._layerSelectChecked||o?" div-not-visible":" div-visible",h=o?"div-not-visible":"div-visible";return e(i,null,e("div",{class:"padding-bottom-1"},e("calcite-radio-group",{class:"w-100",onCalciteRadioGroupChange:t=>this._workflowChange(t)},e("calcite-radio-group-item",{checked:o,class:"w-50 end-border",value:y.SEARCH},this._translations.search),e("calcite-radio-group-item",{checked:s,class:"w-50",value:y.SKETCH},this._translations.sketch))),e("div",{class:r},e("div",{class:"search-widget",ref:t=>{this._searchElement=t}})),e("div",{class:h},e("calcite-label",{layout:"inline"},e("calcite-checkbox",{onCalciteCheckboxChange:()=>this._layerSelectChanged(),ref:t=>this._selectFromLayerElement=t}),"Use layer features")),e("div",{class:c},e("map-draw-tools",{active:!0,border:!0,mapView:this.mapView,ref:t=>{this._drawTools=t}})),e("div",{class:l},e("refine-selection-tools",{active:!0,border:!0,enabledLayerIds:this.enabledLayerIds,layerViews:this._refineSelectLayers,mapView:this.mapView,mode:b.ADD,ref:t=>{this._refineTools=t},refineMode:w.SUBSET})),e("calcite-label",{class:a},this._translations.searchDistance,e("buffer-tools",{distance:(null===(t=this.selectionSet)||void 0===t?void 0:t.distance)||this.defaultBufferDistance,geometries:this.geometries,onBufferComplete:t=>this._bufferComplete(t),ref:t=>this._bufferTools=t,unit:(null===(n=this.selectionSet)||void 0===n?void 0:n.unit)||this.defaultBufferUnit})),e("slot",null))}async _initModules(){const[t,e,i,n,o]=await u(["esri/layers/GraphicsLayer","esri/Graphic","esri/widgets/Search","esri/geometry/geometryEngine","esri/layers/FeatureLayer"]);this.GraphicsLayer=t,this.Graphic=e,this.Search=i,this._geometryEngine=n,this.FeatureLayer=o}async _init(){this._initGraphicsLayer(),this._initSelectionSet(),this._initSearchWidget()}_initSelectionSet(){var t,e,i,n,o,r;this.selectionSet?(this._searchTerm=null===(e=null===(t=this.selectionSet)||void 0===t?void 0:t.searchResult)||void 0===e?void 0:e.name,this._workflowType=null===(i=this.selectionSet)||void 0===i?void 0:i.workflowType,this._searchResult=null===(n=this.selectionSet)||void 0===n?void 0:n.searchResult,this._refineSelectLayers=null===(o=this.selectionSet)||void 0===o?void 0:o.refineSelectLayers,this.geometries=[...null===(r=this.selectionSet)||void 0===r?void 0:r.geometries],this._selectionLabel=this._getSelectionBaseLabel(),d(this.selectionSet.selectedIds,this.selectionSet.layerView,this.mapView,!1)):this._workflowType=y.SEARCH}_getSelectionBaseLabel(){var t,e;return this._workflowType===y.SKETCH?this._translations.sketch:this._workflowType===y.SELECT?this._translations.select:this._workflowType===y.SEARCH&&this._searchResult?null===(t=this._searchResult)||void 0===t?void 0:t.name:null===(e=this.selectionSet)||void 0===e?void 0:e.label}_initSearchWidget(){if(this.mapView&&this._searchElement){const t=this._getSearchConfig(this.searchConfiguration,this.mapView),e=Object.assign({view:this.mapView,container:this._searchElement,searchTerm:this._searchTerm},t);this._searchWidget=new this.Search(e),this._searchWidget.on("search-clear",(()=>{this._clearResults(!1)})),this._searchWidget.on("select-result",(t=>{var e;this._clearResults(!1),t.result&&(this._searchResult=t.result,this._updateSelection(y.SEARCH,[t.result.feature],null===(e=null==t?void 0:t.result)||void 0===e?void 0:e.name))}))}}_getSearchConfig(t,e){var i;const n=null==t?void 0:t.sources;return n&&n.forEach((t=>{var i,n,o;if(t.hasOwnProperty("layer")){const r=t,s=(null===(i=r.layer)||void 0===i?void 0:i.id)?e.map.findLayerById(r.layer.id):null;s?r.layer=s:(null===(n=null==r?void 0:r.layer)||void 0===n?void 0:n.url)&&(r.layer=new this.FeatureLayer(null===(o=null==r?void 0:r.layer)||void 0===o?void 0:o.url))}})),null===(i=null==t?void 0:t.sources)||void 0===i||i.forEach((t=>{if(t.hasOwnProperty("locator")){const e=t;e.url=e.url,delete e.url}})),t}_initGraphicsLayer(){const t=this._translations.bufferLayer,e=this.mapView.map.layers.findIndex((e=>e.title===t));if(e>-1)this._bufferGraphicsLayer=this.mapView.map.layers.getItemAt(e);else{this._bufferGraphicsLayer=new this.GraphicsLayer({title:t}),k.managedLayers.push(t);const e=this.mapView.map.layers.findIndex((t=>t.title===this._translations.sketchLayer));e>-1?this.mapView.map.layers.add(this._bufferGraphicsLayer,e):this.mapView.map.layers.add(this._bufferGraphicsLayer)}}_layerSelectChanged(){this._layerSelectChecked=this._selectFromLayerElement.checked,this.sketchTypeChange.emit(this._layerSelectChecked?v.LAYER:v.INTERACTIVE)}_workflowChange(t){this._workflowType=t.detail}async _highlightFeatures(t){var e;null===(e=k.highlightHandle)||void 0===e||e.remove(),t.length>0&&(k.highlightHandle=await f(t,this.selectLayerView,this.mapView)),this.selectionSetChange.emit(t.length)}async _selectFeatures(t){this._selectedIds=await m(t,this.selectLayerView.layer),this._drawTools.graphics=this.geometries.map((t=>{var e,i,n;const o={geometry:t,symbol:"point"===t.type?null===(e=this._drawTools)||void 0===e?void 0:e.pointSymbol:"polyline"===t.type?null===(i=this._drawTools)||void 0===i?void 0:i.polylineSymbol:"polygon"===t.type?null===(n=this._drawTools)||void 0===n?void 0:n.polygonSymbol:void 0};return new this.Graphic(o)})),this._highlightFeatures(this._selectedIds)}async _bufferComplete(t){if(this._bufferGeometry=Array.isArray(t.detail)?t.detail[0]:t.detail,this._bufferGeometry){const t=new this.Graphic({geometry:this._bufferGeometry,symbol:{type:"simple-fill",color:[227,139,79,.8],outline:{color:[255,255,255],width:1}}});this._bufferGraphicsLayer.removeAll(),this._bufferGraphicsLayer.add(t),this._selectFeatures([this._bufferGeometry]),this.mapView.goTo(t.geometry.extent)}else this._bufferGraphicsLayer&&this._bufferGraphicsLayer.removeAll(),this._geomQuery(this.geometries)}_geomQuery(t){const e=p(t,this._geometryEngine);return this._selectFeatures(e)}async _clearResults(t=!0,e=!0){var i,n;this._selectedIds=[],e&&(this._selectionLabel=""),this._bufferGraphicsLayer&&this._bufferGraphicsLayer.removeAll(),t&&this._searchWidget&&this._searchWidget.clear(),null===(i=k.highlightHandle)||void 0===i||i.remove(),(null===(n=this._drawTools)||void 0===n?void 0:n.clear)&&this._drawTools.clear(),this.selectionSetChange.emit(this._selectedIds.length)}_updateSelection(t,e,i){this.geometries=Array.isArray(e)?e.map((t=>t.geometry)):this.geometries,this._workflowType=t,this._selectionLabel=i}async _getTranslations(){const t=await x(this.el);this._translations=t[0]}get el(){return n(this)}static get watchers(){return{geometries:["watchGeometriesHandler"],_workflowType:["workflowTypeHandler"]}}};function _(t){return null!=t}function E(t){return null==t}function I(t){return t}function z(t){return _(t)&&t.destroy(),null}function C(t){return _(t)&&t.remove(),null}function $(){return null}function R(t){return t}function O(t,e,i){if(E(t)&&E(e))return!0;if(E(t)||E(e)||t.length!==e.length)return!1;if(i){for(let n=0;n<t.length;n++)if(!i(t[n],e[n]))return!1}else for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}M.style=':host{display:block}.div-visible{display:inherit}.div-visible-search{display:flex;height:44px;align-items:center;padding-bottom:0}.div-not-visible{display:none}.padding-bottom-1{padding-bottom:1rem}.search-widget{width:100% !important;border:1px solid var(--calcite-ui-border-input)}.w-100{width:100%}.w-50{width:50%}.search-distance-container{padding-top:"1rem" !important}.end-border{-webkit-border-end:1px solid var(--calcite-ui-border-2);border-inline-end:1px solid var(--calcite-ui-border-2)}.search-distance{display:flex;padding-top:1rem}';class j{constructor(){this.last=0}}const N=new j;function U(t,e,i,n){n=n||N;const o=Math.max(0,n.last-10);for(let r=o;r<i;++r)if(t[r]===e)return n.last=r,r;const r=Math.min(o,i);for(let i=0;i<r;++i)if(t[i]===e)return n.last=i,i;return-1}const F=new Set;function W(t,e,i=t.length,n=e.length,o,r){if(0===n||0===i)return i;F.clear();for(let t=0;t<n;++t)F.add(e[t]);o=o||N;const s=Math.max(0,o.last-10);for(let e=s;e<i;++e)if(F.has(t[e])&&(r&&r.push(t[e]),F.delete(t[e]),t[e]=t[i-1],--i,--e,0===F.size||0===i))return F.clear(),i;for(let e=0;e<s;++e)if(F.has(t[e])&&(r&&r.push(t[e]),F.delete(t[e]),t[e]=t[i-1],--i,--e,0===F.size||0===i))return F.clear(),i;return F.clear(),i}function H(t,e){const i=t.indexOf(e);return-1!==i?(t.splice(i,1),e):null}function q(t,e){let i;if(e)for(i in t)t.hasOwnProperty(i)&&(void 0===t[i]?delete t[i]:t[i]instanceof Object&&q(t[i],!0));else for(i in t)t.hasOwnProperty(i)&&void 0===t[i]&&delete t[i];return t}function G(t){if(!t||"object"!=typeof t||"function"==typeof t)return t;const e=function(t){if(function(t){return t instanceof Int8Array||t&&t.constructor&&"Int8Array"===t.constructor.name}(t)||function(t){return t instanceof Uint8Array||t&&t.constructor&&"Uint8Array"===t.constructor.name}(t)||function(t){return t instanceof Uint8ClampedArray||t&&t.constructor&&"Uint8ClampedArray"===t.constructor.name}(t)||function(t){return t instanceof Int16Array||t&&t.constructor&&"Int16Array"===t.constructor.name}(t)||function(t){return t instanceof Uint16Array||t&&t.constructor&&"Uint16Array"===t.constructor.name}(t)||function(t){return t instanceof Int32Array||t&&t.constructor&&"Int32Array"===t.constructor.name}(t)||function(t){return t instanceof Uint32Array||t&&t.constructor&&"Uint32Array"===t.constructor.name}(t)||function(t){return t instanceof Float32Array||t&&t.constructor&&"Float32Array"===t.constructor.name}(t)||function(t){return t instanceof Float64Array||t&&t.constructor&&"Float64Array"===t.constructor.name}(t))return function(t,e,i){if(t.slice)return t.slice(e,i);void 0===e?e=0:(e<0&&(e+=t.length),e=Math.min(t.length,Math.max(0,e))),void 0===i?i=t.length:(i<0&&(i+=t.length),i=Math.min(t.length,Math.max(0,i)));const n=Math.max(0,i-e),o=new t.constructor(n);for(let i=0;i<n;i++)o[i]=t[e+i];return o}(t);if(t instanceof Date)return new Date(t.getTime());if(t instanceof ArrayBuffer)return t.slice(0,t.byteLength);if(t instanceof Map){const e=new Map;for(const[i,n]of t)e.set(i,G(n));return e}if(t instanceof Set){const e=new Set;for(const i of t)e.add(G(i));return e}return null}(t);if(_(e))return e;if(function(t){return"function"==typeof t.clone}(t))return t.clone();if(function(t){return"function"==typeof t.map&&"function"==typeof t.forEach}(t))return t.map(G);if(function(t){return"function"==typeof t.notifyChange&&"function"==typeof t.watch}(t))return t.clone();const i={};for(const e of Object.getOwnPropertyNames(t))i[e]=G(t[e]);return i}function Y(t){if("[object Object]"!==Object.prototype.toString.call(t))return!1;const e=Object.getPrototypeOf(t);return null===e||e===Object.prototype}function V(t,e){return t===e||"number"==typeof t&&isNaN(t)&&"number"==typeof e&&isNaN(e)||"function"==typeof(t||{}).getTime&&"function"==typeof(e||{}).getTime&&t.getTime()===e.getTime()||!1}function B(t,e){return t===e||(null==t||"string"==typeof t?t===e:"number"==typeof t?t===e||"number"==typeof e&&isNaN(t)&&isNaN(e):t instanceof Date?e instanceof Date&&t.getTime()===e.getTime():Array.isArray(t)?Array.isArray(e)&&O(t,e):t instanceof Set?e instanceof Set&&function(t,e){if(t.size!==e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0}(t,e):t instanceof Map?e instanceof Map&&function(t,e){if(t.size!==e.size)return!1;for(const[i,n]of t){const t=e.get(i);if(t!==n||void 0===t&&!e.has(i))return!1}return!0}(t,e):!!Y(t)&&Y(e)&&function(t,e){if(null===t||null===e)return!1;const i=Object.keys(t);if(null===e||Object.keys(e).length!==i.length)return!1;for(const n of i)if(t[n]!==e[n]||!Object.prototype.hasOwnProperty.call(e,n))return!1;return!0}(t,e))}function J(t,e){if(null!=e)return e[t]||Q(t.split("."),!1,e)}function K(t,e,i){const n=t.split("."),o=n.pop(),r=Q(n,!0,i);r&&o&&(r[o]=e)}function Q(t,e,i){let n=i;for(const i of t){if(null==n)return;if(!(i in n)){if(!e)return;n[i]={}}n=n[i]}return n}function X(t,e,i){return e?Object.keys(e).reduce(((t,n)=>{let o=t[n],r=e[n];return o===r?t:void 0===o?(t[n]=G(r),t):(Array.isArray(r)||Array.isArray(t)?(o=t[n]=o?Array.isArray(o)?o.concat():[o]:[],r&&(Array.isArray(r)||(r=[r]),i?r.forEach((t=>{o.includes(t)||o.push(t)})):t[n]=r.concat())):r&&"object"==typeof r?t[n]=X(o,r,i):t.hasOwnProperty(n)&&!e.hasOwnProperty(n)||(t[n]=r),t)}),t||{}):t}class Z{constructor(t,e={ignoreUnknown:!1,useNumericKeys:!1}){this._jsonToAPI=t,this._options=e,this.apiValues=[],this.jsonValues=[],this._apiToJSON=this._invertMap(t),this.apiValues=this._getKeysSorted(this._apiToJSON),this.jsonValues=this._getKeysSorted(this._jsonToAPI),this.read=t=>this.fromJSON(t),this.write=(t,e,i)=>{const n=this.toJSON(t);void 0!==n&&K(i,n,e)},this.write.isJSONMapWriter=!0}toJSON(t){if(this._apiToJSON.hasOwnProperty(t)){const e=this._apiToJSON[t];return this._options.useNumericKeys?+e:e}return this._options.ignoreUnknown?void 0:t}fromJSON(t){return this._jsonToAPI.hasOwnProperty(t)?this._jsonToAPI[t]:this._options.ignoreUnknown?void 0:t}_invertMap(t){const e={};for(const i in t)e[t[i]]=i;return e}_getKeysSorted(t){const e=[];for(const i in t)e.push(i);return e.sort(),e}}let tt;const et=globalThis.esriConfig?.locale??globalThis.dojoConfig?.locale;function it(){return et??globalThis.navigator?.language??"en"}function nt(){return void 0===tt&&(tt=it()),tt}const ot=[];function rt(t){return ot.push(t),{remove(){ot.splice(ot.indexOf(t),1)}}}const st=[];function at(t){return st.push(t),{remove(){ot.splice(st.indexOf(t),1)}}}globalThis.addEventListener?.("languagechange",(function(){const t=it();tt!==t&&(tt=t,[...st].forEach((e=>{e.call(null,t)})),[...ot].forEach((e=>{e.call(null,t)})))}));const lt={year:"numeric",month:"numeric",day:"numeric"},ct={year:"numeric",month:"long",day:"numeric"},ht={year:"numeric",month:"short",day:"numeric"},ut={year:"numeric",month:"long",weekday:"long",day:"numeric"},dt={hour:"numeric",minute:"numeric"},ft={...dt,second:"numeric"},mt={"short-date":lt,"short-date-short-time":{...lt,...dt},"short-date-short-time-24":{...lt,...dt,hour12:!1},"short-date-long-time":{...lt,...ft},"short-date-long-time-24":{...lt,...ft,hour12:!1},"short-date-le":lt,"short-date-le-short-time":{...lt,...dt},"short-date-le-short-time-24":{...lt,...dt,hour12:!1},"short-date-le-long-time":{...lt,...ft},"short-date-le-long-time-24":{...lt,...ft,hour12:!1},"long-month-day-year":ct,"long-month-day-year-short-time":{...ct,...dt},"long-month-day-year-short-time-24":{...ct,...dt,hour12:!1},"long-month-day-year-long-time":{...ct,...ft},"long-month-day-year-long-time-24":{...ct,...ft,hour12:!1},"day-short-month-year":ht,"day-short-month-year-short-time":{...ht,...dt},"day-short-month-year-short-time-24":{...ht,...dt,hour12:!1},"day-short-month-year-long-time":{...ht,...ft},"day-short-month-year-long-time-24":{...ht,...ft,hour12:!1},"long-date":ut,"long-date-short-time":{...ut,...dt},"long-date-short-time-24":{...ut,...dt,hour12:!1},"long-date-long-time":{...ut,...ft},"long-date-long-time-24":{...ut,...ft,hour12:!1},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":dt,"long-time":ft},pt=new Z({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"},{ignoreUnknown:!0});pt.toJSON.bind(pt),pt.fromJSON.bind(pt);const gt={ar:"ar-u-nu-latn-ca-gregory"};let yt=new WeakMap,bt=mt["short-date-short-time"];function wt(t,e){return function(t){const e=t||bt;let i=yt.get(e);if(!i){const t=nt(),n=gt[nt()]||t;i=new Intl.DateTimeFormat(n,e),yt.set(e,i)}return i}(e).format(t)}at((()=>{yt=new WeakMap,bt=mt["short-date-short-time"]}));const vt={ar:"ar-u-nu-latn"};let kt,xt=new WeakMap,St={};function Tt(t,e){return-0===t&&(t=0),function(t){const e=t||St;if(!xt.has(e)){const i=nt(),n=vt[nt()]||i;xt.set(e,new Intl.NumberFormat(n,t))}return xt.get(e)}(e).format(t)}function Dt(t){return"function"==typeof kt[t]?kt[t]=kt[t](globalThis):kt[t]}at((()=>{xt=new WeakMap,St={}})),kt=globalThis.dojoConfig?.has||globalThis.esriConfig?.has?{...globalThis.dojoConfig?.has,...globalThis.esriConfig?.has}:{},Dt.add=(t,e,i,n)=>((n||void 0===kt[t])&&(kt[t]=e),i&&Dt(t)),Dt.cache=kt,Dt.add("esri-deprecation-warnings",!0),(()=>{Dt.add("host-webworker",void 0!==globalThis.WorkerGlobalScope&&self instanceof globalThis.WorkerGlobalScope);const t="undefined"!=typeof window&&"undefined"!=typeof location&&"undefined"!=typeof document&&window.location===location&&window.document===document;if(Dt.add("host-browser",t),Dt.add("host-node","object"==typeof globalThis.process&&globalThis.process.versions?.node&&globalThis.process.versions.v8),Dt.add("dom",t),Dt("host-browser")){const t=navigator,e=t.userAgent,i=t.appVersion,n=parseFloat(i);if(Dt.add("wp",parseFloat(e.split("Windows Phone")[1])||void 0),Dt.add("msapp",parseFloat(e.split("MSAppHost/")[1])||void 0),Dt.add("khtml",i.includes("Konqueror")?n:void 0),Dt.add("edge",parseFloat(e.split("Edge/")[1])||void 0),Dt.add("opr",parseFloat(e.split("OPR/")[1])||void 0),Dt.add("webkit",!Dt("wp")&&!Dt("edge")&&parseFloat(e.split("WebKit/")[1])||void 0),Dt.add("chrome",!Dt("edge")&&!Dt("opr")&&parseFloat(e.split("Chrome/")[1])||void 0),Dt.add("android",!Dt("wp")&&parseFloat(e.split("Android ")[1])||void 0),Dt.add("safari",!i.includes("Safari")||Dt("wp")||Dt("chrome")||Dt("android")||Dt("edge")||Dt("opr")?void 0:parseFloat(i.split("Version/")[1])),Dt.add("mac",i.includes("Macintosh")),!Dt("wp")&&e.match(/(iPhone|iPod|iPad)/)){const t=RegExp.$1.replace(/P/,"p"),i=e.match(/OS ([\d_]+)/)?RegExp.$1:"1",n=parseFloat(i.replace(/_/,".").replace(/_/g,""));Dt.add(t,n),Dt.add("ios",n)}Dt.add("trident",parseFloat(i.split("Trident/")[1])||void 0),Dt("webkit")||(!e.includes("Gecko")||Dt("wp")||Dt("khtml")||Dt("trident")||Dt("edge")||Dt.add("mozilla",n),Dt("mozilla")&&Dt.add("ff",parseFloat(e.split("Firefox/")[1]||e.split("Minefield/")[1])||void 0))}})(),(()=>{if(globalThis.navigator){const t=navigator.userAgent,e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(t),i=/iPhone/i.test(t);e&&Dt.add("esri-mobile",e),i&&Dt.add("esri-iPhone",i),Dt.add("esri-geolocation",!!navigator.geolocation)}Dt.add("esri-canvas-svg-support",!Dt("trident")),Dt.add("esri-wasm","WebAssembly"in globalThis),Dt.add("esri-shared-array-buffer",(()=>{const t="SharedArrayBuffer"in globalThis,e=!1===globalThis.crossOriginIsolated;return t&&!e})),Dt.add("wasm-simd",(()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])))),Dt.add("esri-atomics","Atomics"in globalThis),Dt.add("esri-workers","Worker"in globalThis),Dt.add("web-feat:cache","caches"in globalThis),Dt.add("esri-workers-arraybuffer-transfer",!Dt("safari")||Number(Dt("safari"))>=12),Dt.add("featurelayer-simplify-thresholds",[.5,.5,.5,.5]),Dt.add("featurelayer-simplify-payload-size-factors",[1,1,4]),Dt.add("featurelayer-snapshot-enabled",!0),Dt.add("featurelayer-snapshot-point-min-threshold",8e4),Dt.add("featurelayer-snapshot-point-max-threshold",4e5),Dt.add("featurelayer-snapshot-point-coverage",.1),Dt.add("featurelayer-advanced-symbols",!1),Dt.add("featurelayer-pbf",!0),Dt.add("featurelayer-pbf-statistics",!1),Dt.add("feature-layers-workers",!0),Dt.add("feature-polyline-generalization-factor",1),Dt.add("mapview-transitions-duration",200),Dt.add("mapview-srswitch-adjust-rotation-scale-threshold",24e6),Dt.add("mapserver-pbf-enabled",!1),Dt.add("mapimagelayer-popup-identify-max-tolerance",20),Dt.add("heatmap-allow-raster-fallback",!0),Dt.add("heatmap-force-raster",!1),Dt("host-webworker")||Dt("host-browser")&&(Dt.add("esri-csp-restrictions",(()=>{try{new Function}catch{return!0}return!1})),Dt.add("esri-image-decode",(()=>{if("decode"in new Image){const t=new Image;return t.src='data:image/svg+xml;charset=UTF-8,<svg version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>',void t.decode().then((()=>{Dt.add("esri-image-decode",!0,!0,!0)})).catch((()=>{Dt.add("esri-image-decode",!1,!0,!0)}))}return!1})),Dt.add("esri-url-encodes-apostrophe",(()=>{const t=window.document.createElement("a");return t.href="?'",t.href.includes("?%27")})))})();const Pt={analysisTheme:{accentColor:[255,128,0],textColor:"white"},apiKey:void 0,applicationUrl:globalThis.location?.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",portalUrl:"https://www.arcgis.com",routeServiceUrl:"https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{crossOriginNoCorsDomains:null,httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],maxUrlLength:2e3,priority:"high",proxyRules:[],proxyUrl:null,timeout:6e4,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};globalThis.esriConfig&&(function(t,e,i=!1){X(Pt,e,i)}(0,globalThis.esriConfig,!0),delete Pt.has),Pt.assetsPath||(Pt.assetsPath=`https://js.arcgis.com/${"4.25.5".slice(0,-2)}/@arcgis/core/assets`,Pt.defaultAssetsPath=Pt.assetsPath);const At=/\{([^\}]+)\}/g;function Lt(t){return t??""}const Mt={info:0,warn:1,error:2,none:3};class _t{constructor(t){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},null!=t.level&&(this.level=t.level),null!=t.writer&&(this.writer=t.writer),this._module=t.module,_t._loggers[this.module]=this;const e=this.module.lastIndexOf(".");-1!==e&&(this._parent=_t.getLogger(this.module.slice(0,e)))}get module(){return this._module}get parent(){return this._parent}error(...t){this._log("error","always",...t)}warn(...t){this._log("warn","always",...t)}info(...t){this._log("info","always",...t)}errorOnce(...t){this._log("error","once",...t)}warnOnce(...t){this._log("warn","once",...t)}infoOnce(...t){this._log("info","once",...t)}errorOncePerTick(...t){this._log("error","oncePerTick",...t)}warnOncePerTick(...t){this._log("warn","oncePerTick",...t)}infoOncePerTick(...t){this._log("info","oncePerTick",...t)}get test(){const t=this;return{loggedMessages:t._loggedMessages,clearLoggedWarnings:()=>t._loggedMessages.warn.clear()}}static get testSingleton(){return{resetLoggers(t={}){const e=_t._loggers;return _t._loggers=t,e},set throttlingDisabled(t){_t._throttlingDisabled=t}}}static getLogger(t){let e=_t._loggers[t];return e||(e=new _t({module:t})),e}_log(t,e,...i){if(this._matchLevel(t)){if("always"!==e&&!_t._throttlingDisabled){const n=this._argsToKey(i),o=this._loggedMessages[t].get(n);if("once"===e&&null!=o||"oncePerTick"===e&&o&&o>=_t._tickCounter)return;this._loggedMessages[t].set(n,_t._tickCounter),_t._scheduleTickCounterIncrement()}for(const e of Pt.log.interceptors)if(e(t,this.module,...i))return;this._inheritedWriter()(t,this.module,...i)}}_parentWithMember(t,e){let i=this;for(;_(i);){const e=i[t];if(_(e))return e;i=i.parent}return e}_inheritedWriter(){return this._parentWithMember("writer",this._consoleWriter)}_consoleWriter(t,e,...i){console[t](`[${e}]`,...i)}_matchLevel(t){return Mt[this._parentWithMember("level",Pt.log.level?Pt.log.level:"warn")]<=Mt[t]}_argsToKey(...t){return function(t){let e=0;for(let i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e|=0;return e}(JSON.stringify(t,((t,e)=>"object"!=typeof e||Array.isArray(e)?e:"[Object]")))}static _scheduleTickCounterIncrement(){_t._tickCounterScheduled||(_t._tickCounterScheduled=!0,Promise.resolve().then((()=>{_t._tickCounter++,_t._tickCounterScheduled=!1})))}}_t._loggers={},_t._tickCounter=0,_t._tickCounterScheduled=!1,_t._throttlingDisabled=!1;const Et=_t.getLogger("esri.intl.substitute");function It(t,e,i={}){const{format:n={}}=i;return function(t,e){return t.replace(At,((t,i)=>Lt(e(i))))}(t,(t=>function(t,e,i){let n,o;const r=t.indexOf(":");if(-1===r?n=t.trim():(n=t.slice(0,r).trim(),o=t.slice(r+1).trim()),!n)return"";const s=J(n,e);if(null==s)return"";const a=(o?i?.[o]:null)??i?.[n];return a?function(t,e){switch(e.type){case"date":return wt(t,e.intlOptions);case"number":return Tt(t,e.intlOptions);default:return Et.warn("missing format descriptor for key {key}"),zt(t)}}(s,a):o?function(t,e){switch(e.toLowerCase()){case"dateformat":return wt(t);case"numberformat":return Tt(t);default:return Et.warn(`inline format is unsupported since 4.12: ${e}`),/^(dateformat|datestring)/i.test(e)?wt(t):/^numberformat/i.test(e)?Tt(t):zt(t)}}(s,o):zt(s)}(t,e,n)))}function zt(t){switch(typeof t){case"string":return t;case"number":return Tt(t);case"boolean":return""+t;default:return t instanceof Date?wt(t):""}}class Ct{constructor(t,e,i){this.name=t,this.details=i,this instanceof Ct&&(this.message=(e&&function(t,e){return t.replace(/\$\{([^\s\:\}]*)(?:\:([^\s\:\}]+))?\}/g,((t,i)=>{if(""===i)return"$";const n=J(i,e)??"";if(void 0===n)throw new Error(`could not find key "${i}" in template`);return n.toString()}))}(e,i))??"")}toString(){return"["+this.name+"]: "+this.message}}class $t extends Ct{constructor(t,e,i){if(super(t,e,i),!(this instanceof $t))return new $t(t,e,i)}toJSON(){if(null!=this.details)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,((t,e)=>{if(e&&"object"==typeof e&&"function"==typeof e.toJSON)return e;try{return G(e)}catch(t){return"[object]"}})))}}catch(t){throw _t.getLogger("esri.core.Error").error(t),t}return{name:this.name,message:this.message,details:this.details}}static fromJSON(t){return new $t(t.name,t.message,t.details)}}$t.prototype.type="error";const Rt=function(t){return{setTimeout:(e,i)=>{const n=t.setTimeout(e,i);return{remove:()=>t.clearTimeout(n)}}}}(globalThis);function Ot(t){return t&&("function"==typeof t.on||"function"==typeof t.addEventListener)}function jt(t,e,i){if(!Ot(t))throw new TypeError("target is not a Evented or EventTarget object");if("on"in t)return t.on(e,i);if(Array.isArray(e)){const n=e.slice();for(const e of n)t.addEventListener(e,i);return{remove(){for(const e of n)t.removeEventListener(e,i)}}}return t.addEventListener(e,i),{remove(){t.removeEventListener(e,i)}}}function Nt(t,e,i){if(!Ot(t))throw new TypeError("target is not a Evented or EventTarget object");if("once"in t)return t.once(e,i);const n=jt(t,e,(e=>{n.remove(),i.call(t,e)}));return{remove(){n.remove()}}}function Ut(t="Aborted"){return new $t("AbortError",t)}function Ft(t){return _(t)?"aborted"in t?t:t.signal:t}function Wt(t){const e=Ft(t);return _(e)&&e.aborted}function Ht(t){if(!Gt(t))throw t}function qt(t,e){const i=Ft(t);if(!E(i)){if(!i.aborted)return Nt(i,"abort",(()=>e()));e()}}function Gt(t){return"AbortError"===t?.name}function Yt(){let t=null;const e=new Promise(((e,i)=>{t={promise:void 0,resolve:e,reject:i}}));return t.promise=e,t}async function Vt(t){if(!t)return;if("function"!=typeof t.forEach){const e=Object.keys(t),i=e.map((e=>t[e])),n=await Vt(i),o={};return e.map(((t,e)=>o[t]=n[e])),o}const e=t;return new Promise((t=>{const i=[];let n=e.length;0===n&&t(i),e.forEach((e=>{const o={promise:e||Promise.resolve(e)};i.push(o),o.promise.then((t=>{o.value=t})).catch((t=>{o.error=t})).then((()=>{--n,0===n&&t(i)}))}))}))}function Bt(t){return function(t){return t&&"function"==typeof t.then}(t)?t:Promise.resolve(t)}function Jt(t,e=-1){let i,n,o,r,s=null;const a=(...l)=>{if(i){n=l,r&&r.reject(Ut()),r=Yt();const t=r.promise;if(s){const t=s;s=null,t.abort()}return t}if(o=r||Yt(),r=null,e>0){const n=new AbortController;i=Bt(t(...l,n.signal));const o=i;(function(t){const e=new AbortController;return qt(void 0,(()=>e.abort())),new Promise(((i,n)=>{let o=setTimeout((()=>{o=0,i(undefined)}),t);qt(e,(()=>{o&&(clearTimeout(o),n(Ut()))}))}))})(e).then((()=>{i===o&&(r?n.abort():s=n)}))}else i=1,i=Bt(t(...l));const c=()=>{const t=n;n=o=i=s=null,null!=t&&a(...t)},h=i,u=o;return h.then(c,c),h.then(u.resolve,u.reject),u.promise};return a}function Kt(){let t,e;const i=new Promise(((i,n)=>{t=i,e=n})),n=e=>{t(e)};return n.resolve=e=>t(e),n.reject=t=>e(t),n.timeout=(t,e)=>Rt.setTimeout((()=>n.reject(e)),t),n.promise=i,n}const Qt=/^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/,Xt={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:!0,nl:!0,pl:!0,"pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,"zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function Zt(t){return Xt[t]??!1}const te=[],ee=new Map;async function ie(t){const e=nt();ee.has(t)||ee.set(t,async function(t,e){const i=[];for(const n of te)if(ne(n.pattern,t))try{return await n.fetchMessageBundle(t,e)}catch(t){i.push(t)}if(i.length)throw new $t("intl:message-bundle-error",`Errors occurred while loading "${t}"`,{errors:i});throw new $t("intl:no-message-bundle-loader",`No loader found for message bundle "${t}"`)}(t,e));const i=ee.get(t);return i&&await oe.add(i),i}function ne(t,e){return"string"==typeof t?e.startsWith(t):t.test(e)}at((()=>{ee.clear()}));const oe=new class{constructor(){this._numLoading=0,this._dfd=null}async waitForAll(){this._dfd&&await this._dfd.promise}add(t){return this._increase(),t.then((()=>this._decrease()),(()=>this._decrease())),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=Yt())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&0===this._numLoading&&(this._dfd.resolve(),this._dfd=null)}},re=_t.getLogger("esri.core.urlUtils"),se=Pt.request,ae="esri/config: esriConfig.request.proxyUrl is not set.",le=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,ce=/^\s*http:/i,he=/^\s*https:/i,ue=/^\s*file:/i,de=/:\d+$/,fe=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,me=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),pe=new RegExp("^((([^\\[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^\\[:]*))(:([0-9]+))?$");class ge{constructor(t=""){this.uri=t,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let e=this.uri.match(me);this.scheme=e[2]||(e[1]?"":null),this.authority=e[4]||(e[3]?"":null),this.path=e[5],this.query=e[7]||(e[6]?"":null),this.fragment=e[9]||(e[8]?"":null),null!=this.authority&&(e=this.authority.match(pe),this.user=e[3]||null,this.password=e[4]||null,this.host=e[6]||e[7],this.port=e[9]||null)}toString(){return this.uri}}const ye={};let be=new ge(Pt.applicationUrl);const we=function(){const t=be.path,e=t.substring(0,t.lastIndexOf(t.split("/")[t.split("/").length-1]));return`${be.scheme}://${be.host}${null!=be.port?`:${be.port}`:""}${e}`}();let ve=we;const ke=()=>be;function xe(t){if(!t)return null;const e={path:null,query:null},i=new ge(t),n=t.indexOf("?");return null===i.query?e.path=t:(e.path=t.substring(0,n),e.query=Se(i.query)),i.fragment&&(e.hash=i.fragment,null===i.query&&(e.path=e.path.substring(0,e.path.length-(i.fragment.length+1)))),e}function Se(t){const e=t.split("&"),i={};for(const t of e){if(!t)continue;const e=t.indexOf("=");let n,o;e<0?(n=decodeURIComponent(t),o=""):(n=decodeURIComponent(t.slice(0,e)),o=decodeURIComponent(t.slice(e+1)));let r=i[n];"string"==typeof r&&(r=i[n]=[r]),Array.isArray(r)?r.push(o):i[n]=o}return i}function Te(t){return t&&"object"==typeof t&&"toJSON"in t&&"function"==typeof t.toJSON}function De(t,e){return t?e&&"function"==typeof e?Object.keys(t).map((i=>encodeURIComponent(i)+"="+encodeURIComponent(e(i,t[i])))).join("&"):Object.keys(t).map((i=>{const n=t[i];if(null==n)return"";const o=encodeURIComponent(i)+"=",r=e&&e[i];return r?o+encodeURIComponent(r(n)):Array.isArray(n)?n.map((t=>Te(t)?o+encodeURIComponent(JSON.stringify(t)):o+encodeURIComponent(t))).join("&"):Te(n)?o+encodeURIComponent(JSON.stringify(n)):o+encodeURIComponent(n)})).filter((t=>t)).join("&"):""}function Pe(t=!1){let e,i=se.proxyUrl;if("string"==typeof t){e=function(t){return null!=t&&he.test(t)||"https"===be.scheme&&We(t)}(t);const n=_e(t);n&&(i=n.proxyUrl)}else e=!!t;if(!i)throw re.warn(ae),new $t("urlutils:proxy-not-set",ae);return e&&Ge()&&(i=qe(i)),xe(i)}const Ae={path:"",query:""};function Le(t){const e=t.indexOf("?");return-1!==e?(Ae.path=t.slice(0,e),Ae.query=t.slice(e+1)):(Ae.path=t,Ae.query=null),Ae}function Me(t){return(t=Ye(t=function(t){return t&&"/"===t[t.length-1]?t:`${t}/`}(t=Le(t).path),!0)).toLowerCase()}function _e(t){const e=se.proxyRules,i=Me(t);for(let t=0;t<e.length;t++)if(0===i.indexOf(e[t].urlPrefix))return e[t]}function Ee(t,e,i=!1){if(!t||!e)return!1;const n=Ve(t),o=Ve(e);return!(!i&&n.scheme!==o.scheme)&&null!=n.host&&null!=o.host&&n.host.toLowerCase()===o.host.toLowerCase()&&n.port===o.port}function Ie(t){if("string"==typeof t){if(!je(t))return!0;t=Ve(t)}if(Ee(t,be))return!0;const e=se.trustedServers||[];for(let i=0;i<e.length;i++){const n=ze(e[i]);for(let e=0;e<n.length;e++)if(Ee(t,n[e]))return!0}return!1}function ze(t){return ye[t]||(ye[t]=He(t)||We(t)?[new ge(Ce(t))]:[new ge(`http://${t}`),new ge(`https://${t}`)]),ye[t]}function Ce(t,e=ve,i){return We(t)?i&&i.preserveProtocolRelative?t:"http"===be.scheme&&be.authority===Oe(t).slice(2)?`http:${t}`:`https:${t}`:He(t)?t:Re("/"===t[0]?function(t){const e=t.indexOf("//"),i=t.indexOf("/",e+2);return-1===i?t:t.slice(0,i)}(e):e,t)}function $e(t){return function(t){const e=se.httpsDomains;if(!function(t){return null!=t&&ce.test(t)||"http"===be.scheme&&We(t)}(t))return t;const i=t.indexOf("/",7);let n;if(n=-1===i?t:t.slice(0,i),n=n.toLowerCase().slice(7),de.test(n)){if(!n.endsWith(":80"))return t;n=n.slice(0,-3),t=t.replace(":80","")}return"http"===be.scheme&&n===be.authority&&!fe.test(t)||(Ge()&&n===be.authority||e&&e.some((t=>n===t||n.endsWith(`.${t}`)))||Ge()&&!_e(t))&&(t=qe(t)),t}(t=function(t){return t.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}(t=function(t){if(/^https?:\/\//i.test(t)){const e=Le(t);t=(t=e.path.replace(/\/{2,}/g,"/")).replace("/","//"),e.query&&(t+=`?${e.query}`)}return t}(t=Ce(t=t.trim()))))}function Re(...t){const e=t.filter(_);if(!e||!e.length)return;const i=[];if(je(e[0])){const t=e[0],n=t.indexOf("//");-1!==n&&(i.push(t.slice(0,n+1)),function(t){return null!=t&&ue.test(t)}(e[0])&&(i[0]+="/"),e[0]=t.slice(n+2))}else"/"===e[0][0]&&i.push("");const n=e.reduce(((t,e)=>e?t.concat(e.split("/")):t),[]);for(let t=0;t<n.length;t++){const e=n[t];".."===e&&i.length>0&&".."!==i[i.length-1]?i.pop():(!e&&t===n.length-1||e&&("."!==e||0===i.length))&&i.push(e)}return i.join("/")}function Oe(t,e=!1){if(null==t||Ne(t)||Ue(t))return null;let i=t.indexOf("://");if(-1===i&&We(t))i=2;else{if(-1===i)return null;i+=3}const n=t.indexOf("/",i);return-1!==n&&(t=t.slice(0,n)),e&&(t=Ye(t,!0)),t}function je(t){return We(t)||He(t)}function Ne(t){return null!=t&&"blob:"===t.slice(0,5)}function Ue(t){return null!=t&&"data:"===t.slice(0,5)}function Fe(t){return btoa(String.fromCharCode.apply(null,t)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function We(t){return null!=t&&"/"===t[0]&&"/"===t[1]}function He(t){return null!=t&&le.test(t)}function qe(t){return We(t)?`https:${t}`:t.replace(ce,"https:")}function Ge(){return"https"===be.scheme}function Ye(t,e=!1){return We(t)?t.slice(2):(t=t.replace(le,""),e&&t.length>1&&"/"===t[0]&&"/"===t[1]&&(t=t.slice(2)),t)}function Ve(t){return"string"==typeof t?new ge(Ce(t)):(t.scheme||(t.scheme=be.scheme),t)}function Be(t,e){const i=xe(t),n=i.query||{};for(const t in e)n[t]=e[t];const o=De(n);return o?`${i.path}?${o}`:i.path}let Je;function Ke(t){Je=t}function Qe(t){return/\/(sharing|usrsvcs)\/(appservices|servers)\//i.test(t)}Dt("host-webworker");const Xe=["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"];function Ze(t){const e=Oe(t,!0);return!!e&&e.endsWith(".arcgis.com")&&!Xe.includes(e)&&!t.endsWith("/sharing/rest/generateToken")}function ti(){try{return new DOMException("Aborted","AbortError")}catch{const t=new Error;return t.name="AbortError",t}}async function ei(t,e){const i=Ue(t),n=Ne(t);n||i||(t=$e(t));const o={url:t,requestOptions:{...e}};let r=function(t){const e=e=>null==e||e instanceof RegExp&&e.test(t)||"string"==typeof e&&t.startsWith(e),i=se.interceptors;if(i)for(const t of i)if(Array.isArray(t.urls)){if(t.urls.some(e))return t}else if(e(t.urls))return t;return null}(t);if(r){const t=await async function(t,e){if(null!=t.responseData)return t.responseData;if(t.headers&&(e.requestOptions.headers={...e.requestOptions.headers,...t.headers}),t.query&&(e.requestOptions.query={...e.requestOptions.query,...t.query}),t.before){let i,n;try{n=await t.before(e)}catch(t){i=ui("request:interceptor",t,e)}if((n instanceof Error||n instanceof $t)&&(i=ui("request:interceptor",n,e)),i)throw t.error&&t.error(i),i;return n}}(r,o);if(null!=t)return{data:t,getHeader:li,requestOptions:o.requestOptions,url:o.url};r.after||r.error||(r=null)}if(t=o.url,"image"===(e=o.requestOptions).responseType){if(Dt("host-webworker")||Dt("host-node"))throw ui("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),o)}else if(i)throw ui("request:invalid-parameters",new Error("Data URLs are not supported for responseType = "+e.responseType),o);if("head"===e.method){if(e.body)throw ui("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),o);if(i||n)throw ui("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),o)}if(await async function(){Dt("host-webworker")?ii||(ii=await import("./p-9bfcf5f3.js")):ei._abortableFetch||(ei._abortableFetch=globalThis.fetch.bind(globalThis))}(),ii)return ii.execute(t,e);const s=new AbortController;qt(e,(()=>s.abort()));const a={controller:s,credential:void 0,credentialToken:void 0,fetchOptions:void 0,hasToken:!1,interceptor:r,params:o,redoRequest:!1,useIdentity:ni.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},l=await gi(a);return r?.after?.(l),l}let ii;const ni=Pt.request,oi="FormData"in globalThis,ri=[499,498,403,401],si=["COM_0056","COM_0057","SB_0008"],ai=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],li=()=>null,ci=Symbol();function hi(t){const e=Oe(t);return!e||e.endsWith(".arcgis.com")||ei._corsServers.includes(e)||Ie(e)}function ui(t,e,i,n){let o="Error";const r={url:i.url,requestOptions:i.requestOptions,getHeader:li,ssl:!1};if(e instanceof $t)return e.details?(e.details=G(e.details),e.details.url=i.url,e.details.requestOptions=i.requestOptions):e.details=r,e;if(e){const t=n&&(t=>n.headers.get(t)),i=n&&n.status,s=e.message;s&&(o=s),t&&(r.getHeader=t),r.httpStatus=(null!=e.httpCode?e.httpCode:e.code)||i||0,r.subCode=e.subcode,r.messageCode=e.messageCode,r.messages="string"==typeof e.details?[e.details]:e.details,r.raw=ci in e?e[ci]:e}return Gt(e)?Ut():new $t(t,o,r)}async function di(){Je||await import("./p-df84af8e.js")}function fi(t){return ai.some((e=>e.test(t)))}async function mi(t){let e=t.params.url;const i=t.params.requestOptions,n=t.fetchOptions??{},o=Ne(e)||Ue(e),r=i.responseType||"json",s=o?0:null!=i.timeout?i.timeout:ni.timeout;let a=!1;if(!o){t.useSSL&&(e=qe(e)),i.cacheBust&&"default"===n.cache&&(e=function(t,e,i){const n=xe(t),o=n.query||{};return o["request.preventCache"]=String(i),`${n.path}?${De(o)}`}(e,0,Date.now()));let o={...i.query};t.credentialToken&&(o.token=t.credentialToken);let r=De(o);Dt("esri-url-encodes-apostrophe")&&(r=r.replace(/'/g,"%27"));const s=e.length+1+r.length;let l;a="delete"===i.method||"post"===i.method||"put"===i.method||!!i.body||s>ni.maxUrlLength;const c=i.useProxy||!!_e(e);if(c){const t=Pe(e);l=t.path,!a&&l.length+1+s>ni.maxUrlLength&&(a=!0),t.query&&(o={...t.query,...o})}if("HEAD"===n.method&&(a||c)){if(a){if(s>ni.maxUrlLength)throw ui("request:invalid-parameters",new Error("URL exceeds maximum length"),t.params);throw ui("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),t.params)}if(c)throw ui("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),t.params)}if(a?(n.method="delete"===i.method?"DELETE":"put"===i.method?"PUT":"POST",i.body?e=Be(e,o):(n.body=De(o),n.headers||(n.headers={}),n.headers["Content-Type"]="application/x-www-form-urlencoded")):e=Be(e,o),c&&(t.useProxy=!0,e=`${l}?${e}`),o.token&&oi&&n.body instanceof FormData&&!Qe(e)&&n.body.set("token",o.token),i.hasOwnProperty("withCredentials"))t.withCredentials=i.withCredentials;else if(!Ee(e,ke()))if(Ie(e))t.withCredentials=!0;else if(Je){const i=Je.findServerInfo(e);i&&i.webTierAuth&&(t.withCredentials=!0)}t.withCredentials&&(n.credentials="include",function(t){const e=Pt.request.crossOriginNoCorsDomains;if(e){let i=Oe(t);if(i)return i=i.toLowerCase(),!Ee(i,ke())&&e[i]<Date.now()-36e5}return!1}(e)&&await async function(t){const e=Pt.request.crossOriginNoCorsDomains,i=Oe(t);e&&i&&(e[i.toLowerCase()]=Date.now());const n=xe(t);t=n.path,"json"===n.query?.f&&(t+="?f=json");try{await fetch(t,{mode:"no-cors",credentials:"include"})}catch{}}(a?Be(e,o):e))}let l,c,h=0,u=!1;s>0&&(h=setTimeout((()=>{u=!0,t.controller.abort()}),s));try{if("native-request-init"===i.responseType)c=n,c.url=e;else if("image"!==i.responseType||"default"!==n.cache||"GET"!==n.method||a||function(t){if(t)for(const e of Object.getOwnPropertyNames(t))if(t[e])return!0;return!1}(i.headers)||!o&&!t.useProxy&&ni.proxyUrl&&!hi(e)){if(l=await ei._abortableFetch(e,n),t.useProxy||function(t){const e=Oe(t);e&&!ei._corsServers.includes(e)&&ei._corsServers.push(e)}(e),"native"===i.responseType)c=l;else if("HEAD"!==n.method)if(l.ok){switch(r){case"array-buffer":c=await l.arrayBuffer();break;case"blob":case"image":c=await l.blob();break;default:c=await l.text()}if(h&&(clearTimeout(h),h=0),"json"===r||"xml"===r||"document"===r)if(c)switch(r){case"json":c=JSON.parse(c);break;case"xml":c=pi(c,"application/xml");break;case"document":c=pi(c,"text/html")}else c=null;if(c){if("array-buffer"===r||"blob"===r){const t=l.headers.get("Content-Type");if(t&&/application\/json|text\/plain/i.test(t)&&c["blob"===r?"size":"byteLength"]<=750)try{const t=await new Response(c).json();t.error&&(c=t)}catch{}}"image"===r&&c instanceof Blob&&(c=await bi(URL.createObjectURL(c),t,!0))}}else c=await l.text()}else c=await bi(e,t)}catch(n){if("AbortError"===n.name){if(u)throw new Error("Timeout exceeded");throw Ut("Request canceled")}if(!(!l&&n instanceof TypeError&&ni.proxyUrl)||i.body||"delete"===i.method||"head"===i.method||"post"===i.method||"put"===i.method||t.useProxy||hi(e))throw n;t.redoRequest=!0,function(t){const e={proxyUrl:t.proxyUrl,urlPrefix:Me(t.urlPrefix)},i=se.proxyRules,n=e.urlPrefix;let o=i.length;for(let t=0;t<i.length;t++){const e=i[t].urlPrefix;if(0===n.indexOf(e)){if(n.length===e.length)return-1;o=t;break}0===e.indexOf(n)&&(o=t+1)}i.splice(o,0,e)}({proxyUrl:ni.proxyUrl,urlPrefix:Oe(e)??""})}finally{h&&clearTimeout(h)}return[l,c]}function pi(t,e){let i;try{i=(new DOMParser).parseFromString(t,e)}catch{}if(!i||i.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return i}async function gi(t){let e,i;await async function(t){const e=t.params.url,i=t.params.requestOptions,n=t.controller.signal,o=i.body;let r=null,s=null;if(oi&&"HTMLFormElement"in globalThis&&(o instanceof FormData?r=o:o instanceof HTMLFormElement&&(r=new FormData(o))),"string"==typeof o&&(s=o),t.fetchOptions={cache:i.cacheBust&&!ei._abortableFetch.polyfill?"no-cache":"default",credentials:"same-origin",headers:i.headers||{},method:"head"===i.method?"HEAD":"GET",mode:"cors",priority:ni.priority,redirect:"follow",signal:n},(r||s)&&(t.fetchOptions.body=r||s),"anonymous"===i.authMode&&(t.useIdentity=!1),t.hasToken=!!(/token=/i.test(e)||i.query?.token||r?.get("token")),!t.hasToken&&Pt.apiKey&&Ze(e)&&(i.query||(i.query={}),i.query.token=Pt.apiKey,t.hasToken=!0),t.useIdentity&&!t.hasToken&&!t.credentialToken&&!fi(e)&&!Wt(n)){let o;"immediate"===i.authMode?(await di(),o=await Je.getCredential(e,{signal:n}),t.credential=o):"no-prompt"===i.authMode?(await di(),o=await Je.getCredential(e,{prompt:!1,signal:n}).catch((()=>{})),t.credential=o):Je&&(o=Je.findCredential(e)),o&&(t.credentialToken=o.token,t.useSSL=!!o.ssl)}}(t);try{do{[e,i]=await mi(t)}while(!await yi(t,e,i))}catch(i){const n=ui("request:server",i,t.params,e);throw n.details.ssl=t.useSSL,t.interceptor&&t.interceptor.error&&t.interceptor.error(n),n}const n=t.params.url;if(i&&/\/sharing\/rest\/(accounts|portals)\/self/i.test(n)){if(!t.hasToken&&!t.credentialToken&&i.user?.username&&!Ie(n)){const t=Oe(n,!0);t&&ni.trustedServers.push(t)}Array.isArray(i.authorizedCrossOriginNoCorsDomains)&&function(t){Pt.request.crossOriginNoCorsDomains||(Pt.request.crossOriginNoCorsDomains={});const e=Pt.request.crossOriginNoCorsDomains;for(let i of t)i=i.toLowerCase(),/^https?:\/\//.test(i)?e[Oe(i)??""]=0:(e[Oe("http://"+i)??""]=0,e[Oe("https://"+i)??""]=0)}(i.authorizedCrossOriginNoCorsDomains)}const o=t.credential;if(o&&Je){const t=Je.findServerInfo(o.server);let e=t&&t.owningSystemUrl;if(e){e=e.replace(/\/?$/,"/sharing");const t=Je.findCredential(e,o.userId);t&&-1===Je._getIdenticalSvcIdx(e,t)&&t.resources.unshift(e)}}return{data:i,getHeader:e?t=>e?.headers.get(t):li,requestOptions:t.params.requestOptions,ssl:t.useSSL,url:t.params.url}}async function yi(t,e,i){if(t.redoRequest)return t.redoRequest=!1,!1;const n=t.params.requestOptions;if(!e||"native"===n.responseType||"native-request-init"===n.responseType)return!0;let o,r;if(!e.ok)throw o=new Error(`Unable to load ${e.url} status: ${e.status}`),o[ci]=i,o;i&&(i.error?o=i.error:"error"===i.status&&Array.isArray(i.messages)&&(o={...i},o[ci]=i,o.details=i.messages));let s,a=null;o&&(r=Number(o.code),a=o.hasOwnProperty("subcode")?Number(o.subcode):null,s=o.messageCode,s=s&&s.toUpperCase());const l=n.authMode;if(403===r&&(4===a||o.message&&o.message.toLowerCase().includes("ssl")&&!o.message.toLowerCase().includes("permission"))){if(!t.useSSL)return t.useSSL=!0,!1}else if(!t.hasToken&&t.useIdentity&&("no-prompt"!==l||498===r)&&void 0!==r&&ri.includes(r)&&!fi(t.params.url)&&(403!==r||s&&!si.includes(s)&&(null==a||2===a&&t.credentialToken))){await di();try{const e=await Je.getCredential(t.params.url,{error:ui("request:server",o,t.params),prompt:"no-prompt"!==l,signal:t.controller.signal,token:t.credentialToken});return t.credential=e,t.credentialToken=e.token,t.useSSL=t.useSSL||e.ssl,!1}catch(e){if("no-prompt"===l)return t.credential=void 0,t.credentialToken=void 0,!1;o=e}}if(o)throw o;return!0}function bi(t,e,i=!1){const n=e.controller.signal,o=new Image;return o.crossOrigin=e.withCredentials?"use-credentials":"anonymous",o.alt="",o.fetchPriority=ni.priority,o.src=t,function(t,e,i=!1,n){return new Promise(((o,r)=>{if(Wt(n))return void r(ti());let s=()=>{c(),r(new Error(`Unable to load ${e}`))},a=()=>{const e=t;c(),o(e)},l=()=>{if(!t)return;const e=t;c(),e.src="",r(ti())};const c=()=>{Dt("esri-image-decode")||(t.removeEventListener("error",s),t.removeEventListener("load",a)),s=null,a=null,t=null,_(n)&&n.removeEventListener("abort",l),l=null,i&&URL.revokeObjectURL(e)};_(n)&&n.addEventListener("abort",l),Dt("esri-image-decode")?t.decode().then(a,s):(t.addEventListener("error",s),t.addEventListener("load",a))}))}(o,t,i,n)}async function wi(t){if(_(ki.fetchBundleAsset))return ki.fetchBundleAsset(t);const e=await ei(t,{responseType:"text"});return JSON.parse(e.data)}ei._abortableFetch=null,ei._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"];class vi{constructor({base:t="",pattern:e,location:i=new URL(window.location.href)}){let n;n="string"==typeof i?t=>new URL(t,new URL(i,window.location.href)).href:i instanceof URL?t=>new URL(t,i).href:i,this.pattern="string"==typeof e?new RegExp(`^${e}`):e,this.getAssetUrl=n,t=t?t.endsWith("/")?t:t+"/":"",this.matcher=new RegExp(`^${t}(?:(.*)/)?(.*)$`)}fetchMessageBundle(t,e){return async function(t,e,i,n){const o=e.exec(i);if(!o)throw new $t("esri-intl:invalid-bundle",`Bundle id "${i}" is not compatible with the pattern "${e}"`);const r=o[1]?`${o[1]}/`:"",s=o[2],a=function(t){if(!Qt.test(t))return null;const e=Qt.exec(t);if(null===e)return null;const[,i,n]=e,o=i+(n?"-"+n.toUpperCase():"");return Zt(o)?o:Zt(i)?i:null}(n),l=`${r}${s}.json`,c=a?`${r}${s}_${a}.json`:l;let h;try{h=await wi(t(c))}catch(e){if(c===l)throw new $t("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:e});try{h=await wi(t(l))}catch(t){throw new $t("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:t})}}return h}(this.getAssetUrl,this.matcher,t,e)}}const ki={},xi=_t.getLogger("esri.assets");function Si(t){if(!Pt.assetsPath)throw xi.errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new $t("assets:path-not-set","config.assetsPath is not set");return Re(Pt.assetsPath,t)}!function(t){te.includes(t)||(function(t){for(const e of ee.keys())ne(t.pattern,e)&&ee.delete(e)}(t),te.unshift(t))}(new vi({pattern:"esri/",location:Si}));const Ti=Object.freeze({__proto__:null,default:[{descriptionPDF:{labelWidthDisplay:"2-5/8",labelHeightDisplay:"1",labelsPerPageDisplay:"30",averyPartNumber:"*60"},labelSpec:{type:"AVERY",pageProperties:{pageType:"ANSI A",leftMargin:.1875,rightMargin:.1875,topMargin:.5,bottomMargin:.5},numLabelsAcross:3,numLabelsDown:10,labelWidth:2.625,labelHeight:1,horizGapIn:.125,vertGapIn:0,labelPadding:.1,fontSizePx:11,maxNumLabelLines:4}},{descriptionPDF:{labelWidthDisplay:"4",labelHeightDisplay:"1",labelsPerPageDisplay:"20",averyPartNumber:"*61"},labelSpec:{type:"AVERY",pageProperties:{pageType:"ANSI A",leftMargin:.15625,rightMargin:.15625,topMargin:.47637821,bottomMargin:.5},numLabelsAcross:2,numLabelsDown:10,labelWidth:4,labelHeight:1.0025,horizGapIn:.1875,vertGapIn:0,labelPadding:.1,fontSizePx:11,maxNumLabelLines:4}},{descriptionPDF:{labelWidthDisplay:"4",labelHeightDisplay:"1-1/3",labelsPerPageDisplay:"14",averyPartNumber:"*62"},labelSpec:{type:"AVERY",pageProperties:{pageType:"ANSI A",leftMargin:.15625,rightMargin:.15625,topMargin:.81889808,bottomMargin:.83464612},numLabelsAcross:2,numLabelsDown:7,labelWidth:4,labelHeight:1.3352,horizGapIn:.1875,vertGapIn:0,labelPadding:.1,fontSizePx:11,maxNumLabelLines:6}},{descriptionPDF:{labelWidthDisplay:"4",labelHeightDisplay:"2",labelsPerPageDisplay:"10",averyPartNumber:"*63"},labelSpec:{type:"AVERY",pageProperties:{pageType:"ANSI A",leftMargin:.15625,rightMargin:.15625,topMargin:.5,bottomMargin:.5},numLabelsAcross:2,numLabelsDown:5,labelWidth:4,labelHeight:2,horizGapIn:.1875,vertGapIn:0,labelPadding:.1,fontSizePx:12,maxNumLabelLines:10}},{descriptionPDF:{labelWidthDisplay:"4",labelHeightDisplay:"3-1/3",labelsPerPageDisplay:"6",averyPartNumber:"*64"},labelSpec:{type:"AVERY",pageProperties:{pageType:"ANSI A",leftMargin:.15625,rightMargin:.15625,topMargin:.4724412,bottomMargin:.50000027},numLabelsAcross:2,numLabelsDown:3,labelWidth:4,labelHeight:3.342,horizGapIn:.1875,vertGapIn:0,labelPadding:.1,fontSizePx:14,maxNumLabelLines:12}},{descriptionPDF:{labelWidthDisplay:"1-3/4",labelHeightDisplay:"1/2",labelsPerPageDisplay:"80",averyPartNumber:"*67"},labelSpec:{type:"AVERY",pageProperties:{pageType:"ANSI A",leftMargin:.307086375,rightMargin:.307086375,topMargin:.4724412,bottomMargin:.49606326},numLabelsAcross:4,numLabelsDown:20,labelWidth:1.75,labelHeight:.50155,horizGapIn:.29527575,vertGapIn:0,labelPadding:.1,fontSizePx:8,maxNumLabelLines:3}},{descriptionPDF:{labelWidthDisplay:"1-3/4",labelHeightDisplay:"2/3",labelsPerPageDisplay:"60",averyPartNumber:"*95"},labelSpec:{type:"AVERY",pageProperties:{pageType:"ANSI A",leftMargin:.28936983,rightMargin:.28936983,topMargin:.53937037,bottomMargin:.5511814},numLabelsAcross:4,numLabelsDown:15,labelWidth:1.75,labelHeight:.6605,horizGapIn:.30708678,vertGapIn:0,labelPadding:.1,fontSizePx:8,maxNumLabelLines:4}}]});const Di=class{constructor(e){t(this,e),this.disabled=!1,this.enabledSizeValues=[],this.layerView=void 0,this._translations=void 0}async downloadPDF(t,e){!function(t,e,i){console.log("_downloadPDFFile",t,e,i)}(await this._prepareLabels(t,e,!0),this._labelInfoElement.selectedOption.value,`notify-${Date.now().toString()}`)}async downloadCSV(t,e){
/** @license
 * Copyright 2022 Esri
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
return function(t){const e=t.map((t=>Object.values(t).map((t=>`"${t}"`)).join(",")+"\r\n"));!function(t,e){const i=document.createElement("a");void 0!==i.download&&(i.href=URL.createObjectURL(new Blob(t,{type:"text/csv;charset=utf-8;"})),i.download=`${e}.csv`||"export.csv",i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i))}
/** @license
 * Copyright 2022 Esri
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,`notify-${Date.now().toString()}`)}(await this._prepareLabels(t,e,!0))}async _prepareLabels(t,e,i){const n=(await g(t,this.layerView.layer)).features.map((t=>t.attributes)),o=this._convertPopupToLabelSpec(this.layerView.layer.popupTemplate.content[0].text);let r=n.map((t=>{const e=[];return o.forEach((i=>{const n=It(i,t).trim();n.length>0&&e.push(n)})),e})).filter((t=>t.length>0));if(console.log(r),e){console.log("remove duplicates before "+r.length.toString());const t=r.map((t=>JSON.stringify(t))),e=new Set(t);r=Array.from(e,(t=>JSON.parse(t))),console.log("remove duplicates after "+r.length.toString()),console.log(r)}if(i){const t=o.map((t=>t.replace(/\{/g,"").replace(/\}/g,"")));r.unshift(t)}return Promise.resolve(r)}async componentWillLoad(){await this._getTranslations()}render(){return e(i,null,e("calcite-select",{disabled:this.disabled,label:"",ref:t=>{this._labelInfoElement=t}},this._renderItems()))}_convertPopupToLabelSpec(t){let e=(t=t.replace(/<br\s*\/?>/gi,"|")).replace(/<[\s.]*[^<>]*\/?>/gi,"").split("|");return e=e.map((t=>t.trim())).filter((t=>t.length>0)),e}_getLabelSizeText(t){const e=`${t.descriptionPDF.labelWidthDisplay} x ${t.descriptionPDF.labelHeightDisplay}`;return this._translations.pdfLabel.replace("{{n}}",t.descriptionPDF.labelsPerPageDisplay).replace("{{labelSize}}",e)}async _getTranslations(){const t=await x(this.el);this._translations=t[0]}_renderItems(){const t=(Ti.default||Ti).sort(((t,e)=>{const i=parseInt(t.descriptionPDF.labelsPerPageDisplay,10),n=parseInt(e.descriptionPDF.labelsPerPageDisplay,10);return i<n?-1:i>n?1:0}));return t.map((t=>e("calcite-option",{value:t},this._getLabelSizeText(t))))}get el(){return n(this)}};Di.style=":host{display:block}";const Pi=class{constructor(e){t(this,e),this.selectionSetsChanged=o(this,"selectionSetsChanged",7),this._addEnabled=!0,this.addresseeLayer=void 0,this.enabledLayerIds=[],this.mapView=void 0,this.selectionSets=[],this.GraphicsLayer=void 0,this.SketchViewModel=void 0,this._translations=void 0}refineSelectionIdsChange(t){var e,i;const n=(null===(e=t.detail)||void 0===e?void 0:e.addIds)||[],o=(null===(i=t.detail)||void 0===i?void 0:i.removeIds)||[];this._updateSelectionSets(o),this._updateRefineSelectionSet(n,o)}async componentWillLoad(){await this._getTranslations()}render(){return e(i,null,e("div",{class:"padding-1"},e("div",null,e("calcite-radio-group",{class:"w-100",onCalciteRadioGroupChange:t=>this._modeChanged(t)},e("calcite-radio-group-item",{checked:this._addEnabled,class:"w-50",onClick:()=>this._setSelectionMode(b.ADD),value:b.ADD},this._translations.add),e("calcite-radio-group-item",{checked:!this._addEnabled,class:"w-50",onClick:()=>this._setSelectionMode(b.REMOVE),value:b.REMOVE},this._translations.remove)),e("refine-selection-tools",{border:!0,enabledLayerIds:this.enabledLayerIds,ids:S(this.selectionSets),layerViews:[this.addresseeLayer],mapView:this.mapView,mode:this._addEnabled?b.ADD:b.REMOVE,ref:t=>{this._refineTools=t},useLayerPicker:!1})),e("br",null),e("calcite-list",{class:"list-border"},this._getRefineSelectionSetList())))}_modeChanged(t){this._addEnabled=t.detail===b.ADD}_setSelectionMode(t){this._refineTools.mode=t}_getRefineSelectionSetList(){const t=T(this.selectionSets),i=this._getRefineSelectionSet(this.selectionSets),n=(null==i?void 0:i.refineIds.removeIds.length)||0;return[e("calcite-list-item",{label:this._translations.featuresAdded.replace("{{n}}",((null==i?void 0:i.refineIds.addIds.length)||0).toString())}),e("calcite-list-item",{label:this._translations.featuresRemoved.replace("{{n}}",n.toString())}),e("calcite-list-item",{label:this._translations.totalSelected.replace("{{n}}",t.toString())})]}_getRefineSelectionSet(t){let e;return t.some((t=>{if(t.workflowType===y.REFINE)return e=t,!0})),e}_updateSelectionSets(t){t.length>0&&(this.selectionSets=this.selectionSets.reduce(((e,i)=>(i.selectedIds=i.selectedIds.filter((e=>t.indexOf(e)<0)),i.selectedIds.length>0&&e.push(i),e)),[]),this.selectionSetsChanged.emit(this.selectionSets))}_updateRefineSelectionSet(t,e){const i=this._getRefineSelectionSet(this.selectionSets);this.selectionSets=i?this._updateRefineIds(i,t,e):this._addRefineSelectionSet(t,e),this.selectionSetsChanged.emit(this.selectionSets)}_updateRefineIds(t,e,i){t.refineIds.addIds=t.refineIds.addIds.filter((t=>i.indexOf(t)<0)),t.refineIds.removeIds=t.refineIds.removeIds.filter((t=>e.indexOf(t)<0));const n=[...new Set(t.refineIds.addIds.concat(e))],o=[...new Set(t.refineIds.removeIds.concat(i))];return t.refineIds={addIds:n.filter((t=>o.indexOf(t)<0)),removeIds:o.filter((t=>n.indexOf(t)<0))},t.selectedIds=t.refineIds.addIds.length>0?[...new Set(t.selectedIds.concat(t.refineIds.addIds))]:t.selectedIds.filter((e=>t.refineIds.removeIds.indexOf(e)<0)),this.selectionSets.map((e=>e.workflowType===y.REFINE?t:e))}_addRefineSelectionSet(t,e){return[...this.selectionSets,{buffer:void 0,distance:0,download:!0,geometries:[],id:Date.now(),label:"Refine",layerView:this.addresseeLayer,refineSelectLayers:[],searchResult:void 0,selectedIds:t,unit:"feet",workflowType:y.REFINE,refineIds:{addIds:t,removeIds:e}}]}async _getTranslations(){const t=await x(this.el);this._translations=t[0]}_testAccess(t,e){switch(t){case"_modeChanged":return this._modeChanged(e);case"_setSelectionMode":return this._setSelectionMode(e)}return null}get el(){return n(this)}};Pi.style=":host{display:block}";export{L as $,Yt as A,It as B,H as C,O as D,Vt as E,Je as F,q as G,ge as H,xe as I,Kt as J,qt as K,Wt as L,Ee as M,B as N,Se as O,De as P,Ce as Q,Qe as R,Pt as S,$e as T,ei as U,_e as V,J as W,Be as X,Ke as Y,Fe as Z,P as _,_t as a,M as a0,Di as a1,Pi as a2,j as b,U as c,$ as d,I as e,Ct as f,z as g,Dt as h,C as i,W as j,Ut as k,Gt as l,Si as m,Jt as n,K as o,Ht as p,rt as q,_ as r,$t as s,E as t,ie as u,Ot as v,V as w,R as x,G as y,jt as z}