/*!
 * Copyright 2022 Esri
 * Licensed under the Apache License, Version 2.0
 * http://www.apache.org/licenses/LICENSE-2.0
 */
import{f as t,a as s,t as i}from"./p-83166522.js";import{g as n}from"./p-e947d3b0.js";import{S as e}from"./p-ae1fd76b.js";import{d as o}from"./p-4e32bf8c.js";import{h as r,H as a}from"./p-c023e6a1.js";import{C as l,S as c}from"./p-b978636e.js";
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.0-beta.97
 */function h(){this.setUpItems(),this.setUpFilter(),this.deselectRemovedItems()}const u=["ArrowUp","ArrowDown"];function f(){this.setUpItems(),this.setUpFilter(),this.emitCalciteListChange=o(j.bind(this),0)}function d(){var t;null===(t=this.mutationObserver)||void 0===t||t.observe(this.el,{childList:!0,subtree:!0})}function m(){var t;null===(t=this.mutationObserver)||void 0===t||t.disconnect()}function p(s){const{selectedValues:i}=this,{item:n,value:e,selected:o,shiftPressed:r}=s.detail;o?(this.multiple&&r&&this.selectSiblings(n),this.multiple||this.deselectSiblingItems(n),i.set(e,n)):(i.delete(e),this.multiple&&r&&this.selectSiblings(n,!0)),this.multiple||(C(n,o),o&&t(n)),this.lastSelectedItem=n,this.emitCalciteListChange()}function b(t){const s=t.detail.oldValue,i=this.selectedValues;if(i.has(s)){const n=i.get(s);i.delete(s),i.set(t.detail.newValue,n)}t.stopPropagation()}function v(t){const{el:s,items:i,multiple:n,selectedValues:e}=this;n||s.contains(t.relatedTarget)||A(i).forEach((s=>{C(s,0===e.size?s.contains(t.target)||t.target===s:s.selected)}))}function g(s){const{key:i,target:n}=s;if(!function(t){return!!u.find((s=>s===t))}(i))return;const{items:e,multiple:o,selectionFollowsFocus:r}=this,{length:a}=e,l=e.indexOf(n);if(!a||-1===l)return;s.preventDefault();const c=e[w(this,n,"ArrowUp"===i?"up":"down")];e.forEach((t=>C(t,t===c))),!o&&r&&(c.selected=!0),t(c)}function w(t,s,i){const{items:e}=t,{length:o}=e,r=e.indexOf(s),a="up"===i?-1:1;let l=1,c=n(r+a*l++,o);const h=c;for(;e[c].disabled&&(c=n(r+a*l++,o),c!==h););return c}function F(t,s){const{items:i}=t;return i.indexOf(s)}function A(t){return t.filter((t=>!t.disabled))}function j(){this.calciteListChange.emit(this.selectedValues)}function y(t){if(t.defaultPrevented)return;const s=t.target,i=this.selectedValues;"CALCITE-PICK-LIST-GROUP"===s.parentElement.tagName&&s.slot===e.parentItem?(s.parentElement.remove(),Array.from(s.parentElement.children).forEach((t=>i.delete(t.value)))):(s.remove(),i.delete(s.value)),this.emitCalciteListChange()}function C(t,s){t.disabled||(s?t.removeAttribute("tabindex"):t.setAttribute("tabindex","-1"))}async function E(s){var i;if(this.filterEnabled&&"filter"===s)return void await t(this.filterEl);const{items:n,multiple:e,selectionFollowsFocus:o}=this;if(0===n.length)return;if(e)return null===(i=A(n)[0])||void 0===i?void 0:i.setFocus();const r=A(n),a=r.find((t=>t.selected))||r[0];return o&&a&&(a.selected=!0),a.setFocus()}function x(t){this.items=Array.from(this.el.querySelectorAll(t));let s=!1;const{items:i}=this;i.forEach((t=>{t.icon=this.getIconType(),this.multiple||(t.disableDeselect=!0,C(t,!1)),t.selected&&(s=!0,C(t,!0),this.selectedValues.set(t.value,t))}));const[n]=i;s||!n||n.disabled||C(n,!0)}function I(){const t=this.selectedValues,s=this.items.map((({value:t})=>t));t.forEach((t=>{s.includes(t.value)||this.selectedValues.delete(t.value)}))}function L(t){this.items.forEach((s=>{s.value!==t.value&&(s.toggleSelected(!1),this.selectedValues.has(s.value)&&this.selectedValues.delete(s.value))}))}function P(t,s=!1){if(!this.lastSelectedItem)return;const{items:i}=this,n=i.findIndex((t=>t.value===this.lastSelectedItem.value)),e=i.findIndex((s=>s.value===t.value));i.slice(Math.min(n,e),Math.max(n,e)).forEach((t=>{t.toggleSelected(!s),s?this.selectedValues.delete(t.value):this.selectedValues.set(t.value,t)}))}let S;function k(t){const{filteredItems:i}=t.currentTarget,n=i.map((t=>t.value));let e=!1;S||(S=new Set);const o=this.items.filter((t=>{const s=t.parentElement;s.matches("calcite-pick-list-group")&&S.add(s);const i=n.includes(t.value);return t.hidden=!i,e||(e=i&&t.selected),i}));S.forEach((t=>{const i=o.some((s=>t.contains(s)));if(t.hidden=!i,!i)return;const n=s(t,"parent-item");n&&(n.hidden=!1,o.includes(n)&&Array.from(t.children).forEach((t=>t.hidden=!1)))})),S.clear(),o.length>0&&!e&&!this.multiple&&C(o[0],!0)}function U(){return this.items.map((t=>({label:t.label,description:t.description,metadata:t.metadata,value:t.value})))}
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.0-beta.97
 */const M=({props:{disabled:t,loading:s,filterEnabled:n,dataForFilter:e,handleFilter:o,filterPlaceholder:h,setFilterEl:u,dragEnabled:f,storeAssistiveEl:d},...m})=>{const p=r("slot",null);return r(a,{"aria-busy":i(s),role:"menu",...m},r("section",null,f?r("span",{"aria-live":"assertive",class:"assistive-text",ref:d}):null,r("header",{class:{[l.sticky]:!0}},n?r("calcite-filter",{"aria-label":h,disabled:s||t,items:e,onCalciteFilterChange:o,placeholder:h,ref:u}):null,r("slot",{name:c.menuActions})),s?r("calcite-scrim",{loading:s}):null,p))};export{M as L,L as a,d as b,m as c,I as d,p as e,b as f,U as g,k as h,f as i,v as j,g as k,x as l,h as m,E as n,F as o,w as p,y as r,P as s}