{"version":3,"file":"solution-spatial-ref.js","sourceRoot":"","sources":["../../../src/components/solution-spatial-ref/solution-spatial-ref.tsx"],"names":[],"mappings":"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","sourcesContent":["/** @license\r\n * Copyright 2022 Esri\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *    http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { Component, Element, Event, EventEmitter, h, Host, Method, Prop, State, Watch, VNode } from '@stencil/core';\r\nimport '@esri/calcite-components';\r\nimport { wkids } from './spatialreferences';\r\nimport state from \"../../utils/solution-store\";\r\nimport { nodeListToArray } from '../../utils/common';\r\nimport { ISpatialRefRepresentation, IWkidDescription } from '../../utils/interfaces';\r\nimport SolutionSpatialRef_T9n from '../../assets/t9n/solution-spatial-ref/resources.json';\r\nimport { getLocaleComponentStrings } from '../../utils/locale';\r\n\r\n@Component({\r\n  tag: 'solution-spatial-ref',\r\n  styleUrl: 'solution-spatial-ref.scss',\r\n  shadow: false\r\n})\r\nexport class SolutionSpatialRef {\r\n\r\n  //--------------------------------------------------------------------------\r\n  //\r\n  //  Host element access\r\n  //\r\n  //--------------------------------------------------------------------------\r\n\r\n  @Element() el: HTMLSolutionSpatialRefElement;\r\n\r\n  //--------------------------------------------------------------------------\r\n  //\r\n  //  Properties (public)\r\n  //\r\n  //--------------------------------------------------------------------------\r\n\r\n  /**\r\n  * The wkid that will be used as the default when no user selection has been made.\r\n  */\r\n  @Prop({ mutable: true, reflect: true }) defaultWkid = 102100;\r\n\r\n  /**\r\n  * When true, all but the main switch are disabled to prevent interaction.\r\n  */\r\n  @Prop({ mutable: true, reflect: true }) locked = true;\r\n\r\n  /**\r\n   * Contains the public value for this component, which is a wkid or a wkt.\r\n   */\r\n  @Prop({ mutable: true, reflect: true }) value: string = this.defaultWkid.toString();\r\n\r\n  @Watch(\"value\")\r\n  valueChanged(newValue: string): void {\r\n    this.spatialRef = this._createSpatialRefDisplay(newValue);\r\n    this._updateStore();\r\n    const searchBox = document.getElementById(\"calcite-sr-search\") as HTMLCalciteInputElement;\r\n    if (searchBox) {\r\n      searchBox.value = this._srSearchText = \"\";\r\n    }\r\n    this._clearSelection();\r\n  }\r\n\r\n  /**\r\n  * List of service names the spatial reference should apply to\r\n  */\r\n  @Prop({ mutable: true, reflect: true }) services: string[] = [];\r\n\r\n  /**\r\n  * Indicates if the control has been enabled.\r\n  * The first time Spatial Reference has been enabled it should enable all feature services.\r\n  */\r\n  @State() loaded = false;\r\n\r\n  //--------------------------------------------------------------------------\r\n  //\r\n  //  Lifecycle\r\n  //\r\n  //--------------------------------------------------------------------------\r\n\r\n  constructor() {\r\n    this.spatialRef = this._createSpatialRefDisplay(this.value);\r\n    this.locked = typeof this.value === \"undefined\";\r\n  }\r\n\r\n  /**\r\n   * StencilJS: Called once just after the component is first connected to the DOM.\r\n   */\r\n  componentWillLoad(): Promise<void> {\r\n    return this._getTranslations();\r\n  }\r\n\r\n  /**\r\n   * Renders the component.\r\n   */\r\n  render(): VNode {\r\n    return (\r\n      <Host>\r\n        <div class=\"spatial-ref-desc\">\r\n          <calcite-label>{this._translations.paramDescription}</calcite-label>\r\n        </div>\r\n        <label class=\"switch-label\">\r\n          <calcite-switch\r\n            checked={!this.locked}\r\n            class=\"spatial-ref-switch\"\r\n            onCalciteSwitchChange={(event) => this._updateLocked(event)}\r\n            scale=\"m\"\r\n          />\r\n          {this._translations.specifyParam}\r\n        </label>\r\n        <div class=\"spatial-ref-switch-title\" id=\"spatialRefDefn\">\r\n          <calcite-label>\r\n            {this._translations.spatialReferenceInfo}\r\n            <label class=\"spatial-ref-default\">\r\n              <calcite-input\r\n                disabled={this.locked}\r\n                id=\"calcite-sr-search\"\r\n                onCalciteInputInput={(evt) => this._searchSpatialReferences(evt)}\r\n                onKeyDown={(evt) => this._inputKeyDown(evt)}\r\n                placeholder={this._translations.spatialReferencePlaceholder}\r\n              />\r\n            </label>\r\n          </calcite-label>\r\n          <div class={this.locked ? 'disabled-div' : ''}>\r\n            <calcite-tree id=\"calcite-sr-tree\" slot=\"children\">\r\n              {this._getTreeContent()}\r\n            </calcite-tree>\r\n          </div>\r\n          {this._getFeatureServices(this.services)}\r\n        </div>\r\n      </Host>\r\n    );\r\n  }\r\n\r\n  //--------------------------------------------------------------------------\r\n  //\r\n  //  Properties (protected)\r\n  //\r\n  //--------------------------------------------------------------------------\r\n\r\n  /**\r\n   * Internal representation of component's value for display purposes.\r\n   */\r\n  @State() protected spatialRef: ISpatialRefRepresentation;\r\n\r\n  /**\r\n   * Current text that is being used to filter the list of spatial references.\r\n   */\r\n  @State() protected _srSearchText: string;\r\n\r\n  /**\r\n   * Contains the translations for this component.\r\n   * All UI strings should be defined here.\r\n   */\r\n  @State() protected _translations: typeof SolutionSpatialRef_T9n;\r\n\r\n  //--------------------------------------------------------------------------\r\n  //\r\n  //  Event Listeners\r\n  //\r\n  //--------------------------------------------------------------------------\r\n\r\n  //--------------------------------------------------------------------------\r\n  //\r\n  //  Events\r\n  //\r\n  //--------------------------------------------------------------------------\r\n\r\n  @Event() featureServiceSpatialReferenceChange: EventEmitter<{ name: string, enabled: boolean }>;\r\n\r\n  //--------------------------------------------------------------------------\r\n  //\r\n  //  Public Methods (async)\r\n  //\r\n  //--------------------------------------------------------------------------\r\n\r\n  /**\r\n   * Returns the spatial reference description of the supplied value.\r\n   * (Exposes protected method `_createSpatialRefDisplay` for testing.)\r\n   *\r\n   * @param value WKID or WKT or null for default\r\n   * @returns If component is using a WKID, description using WKID; otherwise, the WKT; defaults to 102100\r\n   */\r\n  @Method()\r\n  async createSpatialRefDisplay(value: string): Promise<ISpatialRefRepresentation> {\r\n    return this._createSpatialRefDisplay(value);\r\n  }\r\n\r\n  /**\r\n   * Returns the current spatial reference description.\r\n   * (Exposes protected variable `spatialRef` for testing.)\r\n   */\r\n  @Method()\r\n  async getSpatialRef(): Promise<ISpatialRefRepresentation> {\r\n    return this.spatialRef;\r\n  }\r\n\r\n  /**\r\n   * Converts a WKID into a spatial reference description.\r\n   * (Exposes protected method `_wkidToDisplay` for testing.)\r\n   *\r\n   * @param wkid WKID to look up\r\n   * @returns Description, or \"WKID &lt;wkid&gt;\" if a description doesn't exist for the WKID\r\n   */\r\n  @Method()\r\n  async wkidToDisplay(wkid: number): Promise<string> {\r\n    return this._wkidToDisplay(wkid);\r\n  }\r\n\r\n  //--------------------------------------------------------------------------\r\n  //\r\n  //  Private Methods\r\n  //\r\n  //--------------------------------------------------------------------------\r\n\r\n  /**\r\n   * Returns the spatial reference description of the supplied value.\r\n   *\r\n   * @param value WKID or WKT or null for default\r\n   * @returns If component is using a WKID, description using WKID; otherwise, the WKT; defaults to 102100\r\n   */\r\n  protected _createSpatialRefDisplay(value: string): ISpatialRefRepresentation {\r\n    let spatialRef: ISpatialRefRepresentation;\r\n\r\n    if (!value) {\r\n      spatialRef = {\r\n        display: this._wkidToDisplay(this.defaultWkid),\r\n        usingWkid: true,\r\n        wkid: this.defaultWkid,\r\n        wkt: \"\"\r\n      }\r\n    } else {\r\n      const wkid = Number.parseInt(value);\r\n      spatialRef = isNaN(wkid) ? {\r\n        display: value,\r\n        usingWkid: false,\r\n        wkid: 0,\r\n        wkt: value\r\n      } : {\r\n        display: this._wkidToDisplay(wkid),\r\n        usingWkid: true,\r\n        wkid: wkid,\r\n        wkt: \"\"\r\n      };\r\n    }\r\n\r\n    return spatialRef;\r\n  }\r\n\r\n  /**\r\n   * Toggles the ability to set the default spatial reference.\r\n   */\r\n  protected _updateLocked(event: any): void {\r\n    this.locked = !event.detail.switched;\r\n    this._updateStore();\r\n    if (!this.loaded) {\r\n      // when this is switched on when loading we have reloaded a solution that\r\n      // has a custom wkid param and we should honor the settings they already have in the templates\r\n      if (event.detail.switched) {\r\n        // By default enable all Feature Services on first load\r\n        this._setFeatureServiceDefaults(this.services);\r\n      }\r\n      this.loaded = true;\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Enable spatial reference variable for all feature services.\r\n   *\r\n   * @param services list of service names\r\n   */\r\n  protected _setFeatureServiceDefaults(\r\n    services: string[]\r\n  ): void {\r\n    // switch all spatial-ref-item-switch\r\n    const fsNodes = nodeListToArray(this.el.getElementsByClassName(\"spatial-ref-item-switch\"));\r\n    fsNodes.forEach((node: any) => node.checked = true);\r\n    services.forEach(name => this._updateEnabledServices({ detail: { switched: true } }, name));\r\n  }\r\n\r\n  /**\r\n   * Stores the wkid as the components value.\r\n   */\r\n  protected _setSpatialRef(wkid: string): void {\r\n    if (this.value !== wkid) {\r\n      this.value = wkid;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Converts a WKID into a spatial reference description.\r\n   *\r\n   * @param wkid WKID to look up\r\n   * @returns Description, or \"WKID &lt;wkid&gt;\" if a description doesn't exist for the WKID\r\n   */\r\n  protected _wkidToDisplay(wkid: number): string {\r\n    const description: IWkidDescription = wkids[wkid];\r\n    return description ? description.label + \" (\" + wkid.toString() + \")\" : \"WKID \" + wkid.toString();\r\n  }\r\n\r\n  /**\r\n   * Create a switch control for each of the services\r\n   *\r\n   * @param services List of feature services\r\n   * @returns a node to control each feature service\r\n   */\r\n  protected _getFeatureServices(services: string[]): VNode {\r\n    // verify they are in state\r\n    const spatialReferenceInfo = state.getStoreInfo(\"spatialReferenceInfo\");\r\n    const _services = services.filter(s => {\r\n      return Object.keys(spatialReferenceInfo.services).some(stateService => stateService === s)\r\n    });\r\n    return _services && _services.length > 0 ? (\r\n      <div>\r\n        <label class=\"spatial-ref-item-title\">{this._translations.featureServicesHeading}</label>\r\n        {_services.map(name => (\r\n          <label class=\"switch-label\">\r\n            <calcite-switch\r\n              checked={spatialReferenceInfo.services[name]}\r\n              class=\"spatial-ref-item-switch\"\r\n              disabled={this.locked}\r\n              onCalciteSwitchChange={(event) => this._updateEnabledServices(event, name)}\r\n              scale=\"m\"\r\n            />{name}\r\n          </label>\r\n        ))}\r\n      </div>\r\n    ) : (null);\r\n  }\r\n\r\n  /**\r\n   * Updates the enabled and spatialReference prop in spatialReferenceInfo.\r\n   */\r\n  protected _updateStore(): void {\r\n    const spatialReferenceInfo = state.getStoreInfo(\"spatialReferenceInfo\");\r\n    spatialReferenceInfo.enabled = !this.locked;\r\n    spatialReferenceInfo.spatialReference = this.spatialRef.wkid;\r\n    state.setStoreInfo(\"spatialReferenceInfo\", spatialReferenceInfo);\r\n  }\r\n\r\n  /**\r\n   * Updates the enabled/disabled state of the service in spatialReferenceInfo.\r\n   */\r\n  protected _updateEnabledServices(event: any, name: string): void {\r\n    const spatialReferenceInfo = state.getStoreInfo(\"spatialReferenceInfo\");\r\n    spatialReferenceInfo.services[name] = event.detail.switched;\r\n    state.setStoreInfo(\"spatialReferenceInfo\", spatialReferenceInfo);\r\n\r\n    this.featureServiceSpatialReferenceChange.emit({\r\n      name,\r\n      enabled: event.detail.switched\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Select the first child on Enter key click\r\n   * OR\r\n   * Clear any selection while user is entering values and use the default wkid\r\n   *\r\n   * @param event The keyboard event\r\n   */\r\n  protected _inputKeyDown(\r\n    event: KeyboardEvent\r\n  ): void {\r\n    if (event.key === \"Enter\") {\r\n      this._selectFirstChild(true);\r\n    } else {\r\n      if (this._srSearchText?.length > 1) {\r\n        this._clearSelection();\r\n        this._setSpatialRef(this.defaultWkid.toString());\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear any selected items in the elements tree.\r\n   *\r\n   */\r\n  protected _clearSelection(): void {\r\n    const selectedItems = nodeListToArray(\r\n      this.el.querySelectorAll(\"calcite-tree-item[selected]\")\r\n    );\r\n    selectedItems.forEach((treeItem: HTMLCalciteTreeItemElement) => {\r\n      treeItem.selected = false;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Select the first child from the tree.\r\n   *\r\n   * @param autoFocus Boolean to indicate if focus should also be shifted to the first child.\r\n   *\r\n   */\r\n  protected _selectFirstChild(\r\n    autoFocus: boolean\r\n  ): void {\r\n    const wkidContainer = document.getElementById(\"solution-wkid-container\");\r\n    if (wkidContainer && wkidContainer.firstChild) {\r\n      const firstChild = wkidContainer.firstChild as HTMLCalciteTreeItemElement;\r\n      firstChild.selected = true;\r\n      this._setSpatialRef(firstChild.id);\r\n      if (autoFocus) {\r\n        firstChild.focus();\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set the search text State and cause render.\r\n   *\r\n   * @param event the event to get the value from\r\n   *\r\n   */\r\n  protected _searchSpatialReferences(\r\n    event: CustomEvent\r\n  ): void {\r\n    this._srSearchText = event.detail.value;\r\n  }\r\n\r\n  /**\r\n   * Get the tree items for the current spatial reference search\r\n   *\r\n   */\r\n  protected _getTreeContent(): VNode {\r\n    const id = \"solution-wkid-container\";\r\n    const containerClass = \"spatial-ref-container\";\r\n    if (this._srSearchText && this._srSearchText !== \"\" && this._srSearchText.length > 1) {\r\n      const regEx = new RegExp(`${this._srSearchText}`, 'gi');\r\n      const matches = Object.keys(wkids).filter(wkid => {\r\n        return regEx.test(wkid.toString()) || regEx.test(wkids[wkid].label);\r\n      });\r\n      return matches.length > 0 ? (\r\n        <div class={containerClass} id={id}>\r\n          {matches.map((wkid) => this._getTreeItem(wkid, false))}\r\n        </div>\r\n      ) : (null);\r\n    } else {\r\n      return (\r\n        <div class={containerClass} id={id}>\r\n          {this._getTreeItem(this.value.toString(), true)}\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get the individual spatial reference tree item\r\n   *\r\n   * @param wkid The wkid for the spatial reference that will be displayed.\r\n   * @param selected Should the item be selected by default.\r\n   *\r\n   */\r\n  protected _getTreeItem(\r\n    wkid: string,\r\n    selected: boolean\r\n  ): VNode {\r\n    return (\r\n      <calcite-tree-item\r\n        aria-selected={selected}\r\n        id={wkid}\r\n        onClick={() => this._setSpatialRef(wkid)}\r\n        selected={selected}\r\n      >\r\n        <div>{`${wkids[wkid].label} (${wkid})`}</div>\r\n      </calcite-tree-item>\r\n    )\r\n  }\r\n\r\n  /**\r\n   * Fetches the component's translations\r\n   *\r\n   * @protected\r\n   */\r\n  protected async _getTranslations(): Promise<void> {\r\n    const translations = await getLocaleComponentStrings(this.el);\r\n    this._translations = translations[0] as typeof SolutionSpatialRef_T9n;\r\n  }\r\n}\r\n"]}